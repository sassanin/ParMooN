/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// =======================================================================
// @(#)QuadFormulaTetra.C        1.2 05/04/99
//
// Class:      TQuadFormulaTria
// Superclass: TQuadFormula3D
//
// Purpose:    quadrature formula for a 3D integral on unit tetrahedron
// Author:     Gunar Matthies
//
// History:    30.08.1997 start implementation
// 
// =======================================================================

#include <QuadFormulaTetra.h>

TQuadFormulaTetra::TQuadFormulaTetra() : TQuadFormula3D()
{
}

TQuadFormulaTetra::TQuadFormulaTetra(int n_points, double* weights, 
                     double* xi, double* eta, double* zeta, int acc)
  : TQuadFormula3D(n_points, weights, xi, eta, zeta, acc)
{
}

void TQuadFormulaTetra::BaryCenter()
{
  if(Weights!=NULL) return;
  double w[1]={0.16666666666666666666666667};
  double x[1]={0.25};
  double e[1]={0.25};
  double z[1]={0.25};

  InitObject(1,w,x,e,z, 1);
}

void TQuadFormulaTetra::Vertex()
{
  if(Weights!=NULL) return;
  double w[4]={0.04166666666666666666666667, 0.04166666666666666666666667,
               0.04166666666666666666666667, 0.04166666666666666666666667};
  double x[4]={0.0, 1.0, 0.0, 0.0};
  double e[4]={0.0, 0.0, 1.0, 0.0};
  double z[4]={0.0, 0.0, 0.0, 1.0};

  InitObject(4,w,x,e,z, 1);
}

void TQuadFormulaTetra::P2Exact()
{
  if(Weights!=NULL) return;
  double w[4]={0.04166666666666666666666667, 0.04166666666666666666666667,
               0.04166666666666666666666667, 0.04166666666666666666666667};
  
  double x[4] = { 0.138196601125010515179541316563,
                  0.138196601125010515179541316563,
                  0.138196601125010515179541316563,
                  0.585410196624968454461376050311 };

  double e[4] = { 0.138196601125010515179541316563,
                  0.138196601125010515179541316563,
                  0.585410196624968454461376050311,
                  0.138196601125010515179541316563 };

  double z[4] = { 0.138196601125010515179541316563,
                  0.585410196624968454461376050311,
                  0.138196601125010515179541316563,
                  0.138196601125010515179541316563 };

  InitObject(4,w,x,e,z, 2);
}

void TQuadFormulaTetra::P4Exact()
{
  if(Weights!=NULL) return;
  double w[11] = { -.0131555555555555555555555555556,
                    .00762222222222222222222222222222,
                    .00762222222222222222222222222222,
                    .00762222222222222222222222222222,
                    .00762222222222222222222222222222,
                    .0248888888888888888888888888889,
                    .0248888888888888888888888888889,
                    .0248888888888888888888888888889,
                    .0248888888888888888888888888889,
                    .0248888888888888888888888888889,
                    .0248888888888888888888888888889 };

  double x[11] = { .25,
                   .0714285714285714285714285714286,
                   .785714285714285714285714285714,
                   .0714285714285714285714285714286,
                   .0714285714285714285714285714286,
                   .399403576166799204996102147462,
                   .399403576166799204996102147462,
                   .100596423833200795003897852538,
                   .100596423833200795003897852538,
                   .100596423833200795003897852538,
                   .399403576166799204996102147462 };

  double e[11] = { .25,
                   .0714285714285714285714285714286,
                   .0714285714285714285714285714286,
                   .785714285714285714285714285714,
                   .0714285714285714285714285714286,
                   .399403576166799204996102147462,
                   .100596423833200795003897852538,
                   .399403576166799204996102147462,
                   .100596423833200795003897852538,
                   .399403576166799204996102147462,
                   .100596423833200795003897852538 };
  double z[11] = { .25,
                   .0714285714285714285714285714286,
                   .0714285714285714285714285714286,
                   .0714285714285714285714285714286,
                   .785714285714285714285714285714,
                   .100596423833200795003897852538,
                   .399403576166799204996102147462,
                   .399403576166799204996102147462,
                   .399403576166799204996102147462,
                   .100596423833200795003897852538,
                   .100596423833200795003897852538 };

  InitObject(11,w,x,e,z, 4);
}

void TQuadFormulaTetra::P5Exact()
{
  if(Weights!=NULL) return;
  double x[15] = { 0.333333333333333333333333333333333,
                   0.333333333333333333333333333333333,
                   0,
                   0.333333333333333333333333333333333,
                   0.25,
                   0.909090909090909090909090909090909e-1,
                   0.909090909090909090909090909090909e-1,
                   0.727272727272727272727272727272727,
                   0.909090909090909090909090909090909e-1,
                   0.665501535736642982398804642263025e-1,
                   0.433449846426335701760119535773697,
                   0.433449846426335701760119535773697,
                   0.665501535736642982398804642263025e-1,
                   0.665501535736642982398804642263025e-1,
                   0.433449846426335701760119535773697 };

  double e[15] = { 0.333333333333333333333333333333333,
                   0,
                   0.333333333333333333333333333333333,
                   0.333333333333333333333333333333333,
                   0.25,
                   0.909090909090909090909090909090909e-1,
                   0.727272727272727272727272727272727,
                   0.909090909090909090909090909090909e-1,
                   0.909090909090909090909090909090909e-1,
                   0.433449846426335701760119535773697,
                   0.665501535736642982398804642263025e-1,
                   0.433449846426335701760119535773697,
                   0.665501535736642982398804642263025e-1,
                   0.433449846426335701760119535773697,
                   0.665501535736642982398804642263025e-1 };

  double z[15] = { 0,
                   0.333333333333333333333333333333333,
                   0.333333333333333333333333333333333,
                   0.333333333333333333333333333333333,
                   0.25,
                   0.727272727272727272727272727272727,
                   0.90909090909090909090909090909091e-1,
                   0.909090909090909090909090909090911e-1,
                   0.909090909090909090909090909090911e-1,
                   0.433449846426335701760119535773699,
                   0.433449846426335701760119535773699,
                   0.66550153573664298239880464226304e-1,
                   0.433449846426335701760119535773699,
                   0.66550153573664298239880464226304e-1,
                   0.665501535736642982398804642263035e-1 };

  double w[15] = { 0.602678571428571428571428571428571e-2,
                   0.602678571428571428571428571428571e-2,
                   0.602678571428571428571428571428571e-2,
                   0.602678571428571428571428571428571e-2,
                   0.302836780970891758063769725577305e-1,
                   0.116452490860289694108936091443380e-1,
                   0.116452490860289694108936091443380e-1,
                   0.116452490860289694108936091443380e-1,
                   0.116452490860289694108936091443380e-1,
                   0.109491415613864593456430191124068e-1,
                   0.109491415613864593456430191124068e-1,
                   0.109491415613864593456430191124068e-1,
                   0.109491415613864593456430191124068e-1,
                   0.109491415613864593456430191124068e-1,
                   0.109491415613864593456430191124068e-1 };

  InitObject(15,w,x,e,z, 5);
}

void TQuadFormulaTetra::P8Exact()
{
  if(Weights!=NULL) return;
  double x[43] = { 0.25,
                   0.206829931610673204083980900024961,
                   0.206829931610673204083980900024961,
                   0.379510205167980387748057299925117,
                   0.206829931610673204083980900024961,
                   0.821035883105467230906058078714215e-1,
                   0.821035883105467230906058078714215e-1,
                   0.753689235068359830728182576385735,
                   0.821035883105467230906058078714215e-1,
                   0.578195050519799725317663886414270e-2,
                   0.578195050519799725317663886414270e-2,
                   0.982654148484406008240470083407572,
                   0.578195050519799725317663886414270e-2,
                   0.50532740018894224425624528557907e-1,
                   0.449467259981105775574375471442092,
                   0.50532740018894224425624528557907e-1,
                   0.449467259981105775574375471442092,
                   0.50532740018894224425624528557907e-1,
                   0.449467259981105775574375471442092,
                   0.229066536116811139600408854554753,
                   0.356395827885340437169173969506114e-1,
                   0.229066536116811139600408854554753,
                   0.356395827885340437169173969506114e-1,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.356395827885340437169173969506114e-1,
                   0.366077495531974236787738546327104e-1,
                   0.190486041934633455699433285315099,
                   0.366077495531974236787738546327104e-1,
                   0.366077495531974236787738546327104e-1,
                   0.366077495531974236787738546327104e-1,
                   0.190486041934633455699433285315099,
                   0.736298458958971696943019005419480,
                   0.736298458958971696943019005419480,
                   0.736298458958971696943019005419480,
                   0.366077495531974236787738546327104e-1,
                   0.366077495531974236787738546327104e-1,
                   0.190486041934633455699433285315099 };

  double e[43] = { 0.25,
                   0.206829931610673204083980900024961,
                   0.379510205167980387748057299925117,
                   0.206829931610673204083980900024961,
                   0.206829931610673204083980900024961,
                   0.821035883105467230906058078714215e-1,
                   0.753689235068359830728182576385735,
                   0.821035883105467230906058078714215e-1,
                   0.821035883105467230906058078714215e-1,
                   0.578195050519799725317663886414270e-2,
                   0.982654148484406008240470083407572,
                   0.578195050519799725317663886414270e-2,
                   0.578195050519799725317663886414270e-2,
                   0.449467259981105775574375471442092,
                   0.50532740018894224425624528557907e-1,
                   0.50532740018894224425624528557907e-1,
                   0.449467259981105775574375471442092,
                   0.449467259981105775574375471442092,
                   0.50532740018894224425624528557907e-1,
                   0.356395827885340437169173969506114e-1,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.229066536116811139600408854554753,
                   0.356395827885340437169173969506114e-1,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.356395827885340437169173969506114e-1,
                   0.229066536116811139600408854554753,
                   0.190486041934633455699433285315099,
                   0.366077495531974236787738546327104e-1,
                   0.366077495531974236787738546327104e-1,
                   0.736298458958971696943019005419480,
                   0.736298458958971696943019005419480,
                   0.736298458958971696943019005419480,
                   0.366077495531974236787738546327104e-1,
                   0.190486041934633455699433285315099,
                   0.366077495531974236787738546327104e-1,
                   0.190486041934633455699433285315099,
                   0.366077495531974236787738546327104e-1,
                   0.366077495531974236787738546327104e-1 };

  double z[43] = { 0.25,
                   0.379510205167980387748057299925117,
                   0.206829931610673204083980900024961,
                   0.206829931610673204083980900024961,
                   0.206829931610673204083980900024961,
                   0.753689235068359830728182576385737,
                   0.82103588310546723090605807871423e-1,
                   0.821035883105467230906058078714225e-1,
                   0.821035883105467230906058078714225e-1,
                   0.982654148484406008240470083407571,
                   0.5781950505197997253176638864142e-2,
                   0.578195050519799725317663886414230e-2,
                   0.578195050519799725317663886414260e-2,
                   0.449467259981105775574375471442094,
                   0.449467259981105775574375471442094,
                   0.449467259981105775574375471442094,
                   0.50532740018894224425624528557909e-1,
                   0.50532740018894224425624528557909e-1,
                   0.50532740018894224425624528557909e-1,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.506227344977843677082264893939883,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.35639582788534043716917396950611e-1,
                   0.35639582788534043716917396950611e-1,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.35639582788534043716917396950611e-1,
                   0.229066536116811139600408854554753,
                   0.229066536116811139600408854554753,
                   0.736298458958971696943019005419481,
                   0.736298458958971696943019005419481,
                   0.736298458958971696943019005419481,
                   0.190486041934633455699433285315100,
                   0.36607749553197423678773854632711e-1,
                   0.36607749553197423678773854632711e-1,
                   0.190486041934633455699433285315100,
                   0.36607749553197423678773854632711e-1,
                   0.366077495531974236787738546327106e-1,
                   0.36607749553197423678773854632711e-1,
                   0.190486041934633455699433285315100,
                   0.366077495531974236787738546327106e-1 };

  double w[43] = { -0.205001886586399158405865177642941e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2 };

  InitObject(43,w,x,e,z, 8);
}
