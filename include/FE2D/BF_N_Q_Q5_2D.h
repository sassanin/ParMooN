/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// Q5 element, nonconforming, 2D
// ***********************************************************************

// base function values
static void N_Q_Q5_2D_Funct(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54;
  double t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80;
  double t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93;
  double t94, t95, t96, t97, t98, t99, t100, t101, t102, t103, t104, t105;
  double t106, t107, t108, t109, t110, t111, t112, t113, t114, t115, t116;
  double t117, t118, t119, t120, t121, t122, t123, t124, t125, t126, t127;
  double t128, t129, t130, t131, t132, t133, t134, t135, t136, t137, t138;
  double t139, t140, t165, t166, t167, t172;

  t1 = xi*xi;
  t2 = eta*eta;
  t3 = t1*t2;
  t4 = 297.0/128.0*t3;
  t5 = t1*t1;
  t6 = t1-t2;
  t7 = t5*t6;
  t8 = 2541.0/1024.0*t7;
  t9 = t2*t2;
  t10 = t9*t6;
  t11 = 4851.0/1024.0*t10;
  t12 = 297.0/128.0*t1;
  t13 = 123.0/128.0*t2;
  t14 = t2*eta;
  t15 = 35.0/8.0*t14;
  t16 = 1155.0/256.0*t5;
  t17 = 1365.0/256.0*t9;
  t18 = t9*eta;
  t19 = 63.0/16.0*t18;
  t20 = t3*t6;
  t21 = 231.0/64.0*t20;
  t22 = 15.0/16.0*eta;
  t23 = 3.0/16.0+t4-t8-t11-t12+t13+t15+t16-t17-t19-t21-t22;
  t24 = 15.0/16.0*xi;
  t25 = 4851.0/1024.0*t7;
  t26 = 2541.0/1024.0*t10;
  t27 = 123.0/128.0*t1;
  t28 = 297.0/128.0*t2;
  t29 = t1*xi;
  t30 = 35.0/8.0*t29;
  t31 = 1365.0/256.0*t5;
  t32 = 1155.0/256.0*t9;
  t33 = t5*xi;
  t34 = 63.0/16.0*t33;
  t35 = 3.0/16.0+t24+t4+t25+t26+t27-t28-t30-t31+t32+t34+t21;
  t36 = 3.0/16.0+t4-t8-t11-t12+t13-t15+t16-t17+t19-t21+t22;
  t37 = 3.0/16.0-t24+t4+t25+t26+t27-t28+t30-t31+t32-t34+t21;
  t38 = 563.0/1360.0*xi;
  t39 = xi*eta;
  t40 = 237.0/352.0*t39;
  t41 = xi*t2;
  t42 = 2163.0/2720.0*t41;
  t43 = t29*eta;
  t44 = 945.0/352.0*t43;
  t45 = xi*t14;
  t46 = 595.0/352.0*t45;
  t47 = t29*t2;
  t48 = 693.0/136.0*t47;
  t49 = xi*t9;
  t50 = 2121.0/544.0*t49;
  t51 = 693.0/544.0*t29;
  t52 = 2079.0/2720.0*t33;
  t53 = t43*t6;
  t54 = 3969.0/2816.0*t53;
  t55 = t49*t6;
  t56 = 3003.0/680.0*t55;
  t57 = t47*t6;
  t58 = 6237.0/2720.0*t57;
  t59 = t45*t6;
  t60 = 7119.0/2816.0*t59;
  t61 = t38+t40-t42-t44+t46+t48-t50-t51+t52+t54-t56-t58+t60;
  t62 = t1*eta;
  t63 = 2163.0/2720.0*t62;
  t64 = 595.0/352.0*t43;
  t65 = 945.0/352.0*t45;
  t66 = t5*eta;
  t67 = 2121.0/544.0*t66;
  t68 = t1*t14;
  t69 = 693.0/136.0*t68;
  t70 = 693.0/544.0*t14;
  t71 = 2079.0/2720.0*t18;
  t72 = 7119.0/2816.0*t53;
  t73 = t68*t6;
  t74 = 6237.0/2720.0*t73;
  t75 = t66*t6;
  t76 = 3003.0/680.0*t75;
  t77 = 3969.0/2816.0*t59;
  t78 = 563.0/1360.0*eta;
  t79 = -t40-t63-t64+t65-t67+t69-t70+t71+t72+t74+t76+t77+t78;
  t80 = -t38+t40+t42-t44+t46-t48+t50+t51-t52+t54+t56+t58+t60;
  t81 = -t40+t63-t64+t65+t67-t69+t70-t71+t72-t74-t76+t77-t78;
  t82 = 5247.0/2720.0*t62;
  t83 = 9.0/16.0*t3;
  t84 = 1323.0/272.0*t66;
  t85 = 651.0/272.0*t68;
  t86 = 231.0/64.0*t7;
  t87 = 231.0/64.0*t10;
  t88 = 99.0/32.0*t1;
  t89 = 87.0/32.0*t2;
  t90 = 623.0/544.0*t14;
  t91 = 105.0/16.0*t5;
  t92 = 105.0/16.0*t9;
  t93 = 1827.0/1360.0*t18;
  t94 = 5481.0/1360.0*t73;
  t95 = 6237.0/2720.0*t75;
  t96 = 21.0/4.0*t20;
  t97 = 3.0/1360.0*eta;
  t98 = 1.0/16.0+t82+t83-t84+t85-t86-t87-t88+t89-t90+t91-t92+t93+t94+t95-t96+t97;
  t99 = 3.0/1360.0*xi;
  t100 = 5247.0/2720.0*t41;
  t101 = 651.0/272.0*t47;
  t102 = 1323.0/272.0*t49;
  t103 = 87.0/32.0*t1;
  t104 = 99.0/32.0*t2;
  t105 = 623.0/544.0*t29;
  t106 = 1827.0/1360.0*t33;
  t107 = 6237.0/2720.0*t55;
  t108 = 5481.0/1360.0*t57;
  t109 = -t99+1.0/16.0-t100+t83-t101+t102+t86+t87+t103-t104+t105-t91+t92-t106+t107+t108+t96;
  t110 = 1.0/16.0-t82+t83+t84-t85-t86-t87-t88+t89+t90+t91-t92-t93-t94-t95-t96-t97;
  t111 = t99+1.0/16.0+t100+t83+t101-t102+t86+t87+t103-t104-t105-t91+t92+t106-t107-t108+t96;
  t112 = 513.0/1360.0*xi;
  t113 = 27.0/352.0*t39;
  t114 = 2187.0/2720.0*t41;
  t115 = 1035.0/352.0*t43;
  t116 = 1161.0/272.0*t47;
  t117 = 963.0/544.0*t29;
  t118 = t112+t113+t114-t115+t65+t116-t102-t117+t106+t72-t107-t108+t77;
  t119 = 2187.0/2720.0*t62;
  t120 = 1035.0/352.0*t45;
  t121 = 1161.0/272.0*t68;
  t122 = 963.0/544.0*t14;
  t123 = 513.0/1360.0*eta;
  t124 = -t113+t119-t44+t120-t84+t121-t122+t93+t54+t94+t95+t60+t123;
  t125 = -t112+t113-t114-t115+t65-t116+t102+t117-t106+t72+t107+t108+t77;
  t126 = -t113-t119-t44+t120+t84-t121+t122-t93+t54-t94-t95+t60-t123;
  t127 = 2937.0/2720.0*t62;
  t128 = 3311.0/544.0*t66;
  t129 = 363.0/128.0*t1;
  t130 = 1925.0/256.0*t5;
  t131 = 77.0/340.0*eta;
  t132 = t127-t4-t128+t69-t25-t26-t129+t28-t70+t130-t32+t71+t74+t76-t21+t131;
  t133 = 77.0/340.0*xi;
  t134 = 2937.0/2720.0*t41;
  t135 = 3311.0/544.0*t49;
  t136 = 363.0/128.0*t2;
  t137 = 1925.0/256.0*t9;
  t138 = -t133-t134-t4-t48+t135+t8+t11+t12-t136+t51-t16+t137-t52+t56+t58+t21;
  t139 = -t127-t4+t128-t69-t25-t26-t129+t28+t70+t130-t32-t71-t74-t76-t21-t131;
  t140 = t133+t134-t4+t48-t135+t8+t11+t12-t136-t51-t16+t137+t52-t56-t58+t21;
  t165 = 369.0/64.0*t3;
  t166 = 1155.0/512.0*t7;
  t167 = 1155.0/512.0*t10;
  t172 = 105.0/32.0*t20;

  values[0] = t23;
  values[1] = t35;
  values[2] = t36;
  values[3] = t37;
  values[4] = t61;
  values[5] = t79;
  values[6] = t80;
  values[7] = t81;
  values[8] = t98;
  values[9] = t109;
  values[10] = t110;
  values[11] = t111;
  values[12] = t118;
  values[13] = t124;
  values[14] = t125;
  values[15] = t126;
  values[16] = t132;
  values[17] = t138;
  values[18] = t139;
  values[19] = t140;
  values[20] = -297.0/32.0*t3-1155.0/256.0*t7+1155.0/256.0*t10+t103+t89+105.0/64.0*t5+105.0/64.0*t9+1.0/4.0;
  values[21] = -579.0/340.0*xi+2163.0/1360.0*t41-693.0/68.0*t47+2121.0/272.0*t49+3073.0/272.0*t29-12789.0/1360.0*t33+3003.0/340.0*t55+6237.0/1360.0*t57;
  values[22] = 2163.0/1360.0*t62+2121.0/272.0*t66-693.0/68.0*t68+3073.0/272.0*t14-12789.0/1360.0*t18-6237.0/1360.0*t73-3003.0/340.0*t75-579.0/340.0*eta;
  values[23] = -1.0-t165-t166+t167+369.0/64.0*t1-51.0/64.0*t2-315.0/128.0*t5+525.0/128.0*t9+t172;
  values[24] = 325.0/88.0*t39-175.0/88.0*t43-175.0/88.0*t45-1575.0/704.0*t53+1575.0/704.0*t59;
  values[25] = -1.0-t165-t166+t167-51.0/64.0*t1+369.0/64.0*t2+525.0/128.0*t5-315.0/128.0*t9-t172;
  values[26] = -351.0/85.0*xi-2187.0/1360.0*t41-1161.0/136.0*t47+1323.0/136.0*t49+4023.0/272.0*t29-3591.0/340.0*t33+6237.0/1360.0*t55+5481.0/680.0*t57;
  values[27] = 945.0/136.0*t62-525.0/272.0*t66-735.0/136.0*t68+35.0/136.0*t14+315.0/272.0*t18+945.0/272.0*t73-1155.0/272.0*t75-45.0/34.0*eta;
  values[28] = -45.0/34.0*xi+945.0/136.0*t41-735.0/136.0*t47-525.0/272.0*t49+35.0/136.0*t29+315.0/272.0*t33+1155.0/272.0*t55-945.0/272.0*t57;
  values[29] = -2187.0/1360.0*t62+1323.0/136.0*t66-1161.0/136.0*t68+4023.0/272.0*t14-3591.0/340.0*t18-5481.0/680.0*t73-6237.0/1360.0*t75-351.0/85.0*eta;
}

static void N_Q_Q5_2D_DeriveXi(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54;
  double t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80;
  double t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93;
  double t94, t95, t96, t97, t98, t99, t100, t101, t102, t103, t104, t105;
  double t106, t107, t108, t109, t110, t111, t112, t113, t114, t115, t116;
  double t117, t118, t119, t120, t121, t122, t123, t124, t125, t126, t127;
  double t128, t129, t130, t131, t132, t157, t158, t159, t160, t163, t164;

  t1 = eta*eta;
  t2 = xi*t1;
  t3 = 297.0/64.0*t2;
  t4 = xi*xi;
  t5 = t4*xi;
  t6 = t4-t1;
  t7 = t5*t6;
  t8 = 2541.0/256.0*t7;
  t9 = t4*t4;
  t10 = t9*xi;
  t11 = 2541.0/512.0*t10;
  t12 = t1*t1;
  t13 = xi*t12;
  t14 = 4851.0/512.0*t13;
  t15 = 297.0/64.0*xi;
  t16 = 1155.0/64.0*t5;
  t17 = t2*t6;
  t18 = 231.0/32.0*t17;
  t19 = t5*t1;
  t20 = 231.0/32.0*t19;
  t21 = t3-t8-t11-t14-t15+t16-t18-t20;
  t22 = 4851.0/256.0*t7;
  t23 = 4851.0/512.0*t10;
  t24 = 2541.0/512.0*t13;
  t25 = 123.0/64.0*xi;
  t26 = 105.0/8.0*t4;
  t27 = 1365.0/64.0*t5;
  t28 = 315.0/16.0*t9;
  t29 = 15.0/16.0+t3+t22+t23+t24+t25-t26-t27+t28+t18+t20;
  t30 = -15.0/16.0+t3+t22+t23+t24+t25+t26-t27-t28+t18+t20;
  t31 = 237.0/352.0*eta;
  t32 = 2163.0/2720.0*t1;
  t33 = t4*eta;
  t34 = 2835.0/352.0*t33;
  t35 = t1*eta;
  t36 = 595.0/352.0*t35;
  t37 = t4*t1;
  t38 = 2079.0/136.0*t37;
  t39 = 2121.0/544.0*t12;
  t40 = 2079.0/544.0*t4;
  t41 = 2079.0/544.0*t9;
  t42 = t33*t6;
  t43 = 11907.0/2816.0*t42;
  t44 = t9*eta;
  t45 = 3969.0/1408.0*t44;
  t46 = t12*t6;
  t47 = 3003.0/680.0*t46;
  t48 = t4*t12;
  t49 = 3003.0/340.0*t48;
  t50 = t37*t6;
  t51 = 18711.0/2720.0*t50;
  t52 = t9*t1;
  t53 = 6237.0/1360.0*t52;
  t54 = t35*t6;
  t55 = 7119.0/2816.0*t54;
  t56 = t4*t35;
  t57 = 7119.0/1408.0*t56;
  t58 = 563.0/1360.0+t31-t32-t34+t36+t38-t39-t40+t41+t43+t45-t47-t49-t51-t53+t55+t57;
  t59 = xi*eta;
  t60 = 2163.0/1360.0*t59;
  t61 = 1785.0/352.0*t33;
  t62 = 945.0/352.0*t35;
  t63 = t5*eta;
  t64 = 2121.0/136.0*t63;
  t65 = xi*t35;
  t66 = 693.0/68.0*t65;
  t67 = 21357.0/2816.0*t42;
  t68 = 7119.0/1408.0*t44;
  t69 = t65*t6;
  t70 = 6237.0/1360.0*t69;
  t71 = t5*t35;
  t72 = 6237.0/1360.0*t71;
  t73 = t63*t6;
  t74 = 3003.0/170.0*t73;
  t75 = t10*eta;
  t76 = 3003.0/340.0*t75;
  t77 = 3969.0/2816.0*t54;
  t78 = 3969.0/1408.0*t56;
  t79 = -t31-t60-t61+t62-t64+t66+t67+t68+t70+t72+t74+t76+t77+t78;
  t80 = -563.0/1360.0+t31+t32-t34+t36-t38+t39+t40-t41+t43+t45+t47+t49+t51+t53+t55+t57;
  t81 = -t31+t60-t61+t62+t64-t66+t67+t68-t70-t72-t74-t76+t77+t78;
  t82 = 5247.0/1360.0*t59;
  t83 = 9.0/8.0*t2;
  t84 = 1323.0/68.0*t63;
  t85 = 651.0/136.0*t65;
  t86 = 231.0/16.0*t7;
  t87 = 231.0/32.0*t10;
  t88 = 231.0/32.0*t13;
  t89 = 99.0/16.0*xi;
  t90 = 105.0/4.0*t5;
  t91 = 5481.0/680.0*t69;
  t92 = 5481.0/680.0*t71;
  t93 = 6237.0/680.0*t73;
  t94 = 6237.0/1360.0*t75;
  t95 = 21.0/2.0*t17;
  t96 = 21.0/2.0*t19;
  t97 = t82+t83-t84+t85-t86-t87-t88-t89+t90+t91+t92+t93+t94-t95-t96;
  t98 = 5247.0/2720.0*t1;
  t99 = 1953.0/272.0*t37;
  t100 = 1323.0/272.0*t12;
  t101 = 87.0/16.0*xi;
  t102 = 1869.0/544.0*t4;
  t103 = 1827.0/272.0*t9;
  t104 = 6237.0/2720.0*t46;
  t105 = 6237.0/1360.0*t48;
  t106 = 16443.0/1360.0*t50;
  t107 = 5481.0/680.0*t52;
  t108 = -3.0/1360.0-t98+t83-t99+t100+t86+t87+t88+t101+t102-t90-t103+t104+t105+t106+t107+t95+t96;
  t109 = -t82+t83+t84-t85-t86-t87-t88-t89+t90-t91-t92-t93-t94-t95-t96;
  t110 = 3.0/1360.0+t98+t83+t99-t100+t86+t87+t88+t101-t102-t90+t103-t104-t105-t106-t107+t95+t96;
  t111 = 27.0/352.0*eta;
  t112 = 2187.0/2720.0*t1;
  t113 = 3105.0/352.0*t33;
  t114 = 3483.0/272.0*t37;
  t115 = 2889.0/544.0*t4;
  t116 = 513.0/1360.0+t111+t112-t113+t62+t114-t100-t115+t103+t67+t68-t104-t105-t106-t107+t77+t78;
  t117 = 2187.0/1360.0*t59;
  t118 = 1035.0/352.0*t35;
  t119 = 1161.0/136.0*t65;
  t120 = -t111+t117-t34+t118-t84+t119+t43+t45+t91+t92+t93+t94+t55+t57;
  t121 = -513.0/1360.0+t111-t112-t113+t62-t114+t100+t115-t103+t67+t68+t104+t105+t106+t107+t77+t78;
  t122 = -t111-t117-t34+t118+t84-t119+t43+t45-t91-t92-t93-t94+t55+t57;
  t123 = 2937.0/1360.0*t59;
  t124 = 3311.0/136.0*t63;
  t125 = 363.0/64.0*xi;
  t126 = 1925.0/64.0*t5;
  t127 = t123-t3-t124+t66-t22-t23-t24-t125+t126+t70+t72+t74+t76-t18-t20;
  t128 = 2937.0/2720.0*t1;
  t129 = 3311.0/544.0*t12;
  t130 = -77.0/340.0-t128-t3-t38+t129+t8+t11+t14+t15+t40-t16-t41+t47+t49+t51+t53+t18+t20;
  t131 = -t123-t3+t124-t66-t22-t23-t24-t125+t126-t70-t72-t74-t76-t18-t20;
  t132 = 77.0/340.0+t128-t3+t38-t129+t8+t11+t14+t15-t40-t16+t41-t47-t49-t51-t53+t18+t20;
  t157 = 369.0/32.0*t2;
  t158 = 1155.0/128.0*t7;
  t159 = 1155.0/256.0*t10;
  t160 = 1155.0/256.0*t13;
  t163 = 105.0/16.0*t17;
  t164 = 105.0/16.0*t19;

  values[0] = t21;
  values[1] = t29;
  values[2] = t21;
  values[3] = t30;
  values[4] = t58;
  values[5] = t79;
  values[6] = t80;
  values[7] = t81;
  values[8] = t97;
  values[9] = t108;
  values[10] = t109;
  values[11] = t110;
  values[12] = t116;
  values[13] = t120;
  values[14] = t121;
  values[15] = t122;
  values[16] = t127;
  values[17] = t130;
  values[18] = t131;
  values[19] = t132;
  values[20] = -297.0/16.0*t2-1155.0/64.0*t7-1155.0/128.0*t10+1155.0/128.0*t13+t101+105.0/16.0*t5;
  values[21] = -579.0/340.0+2163.0/1360.0*t1-2079.0/68.0*t37+2121.0/272.0*t12+9219.0/272.0*t4-12789.0/272.0*t9+3003.0/340.0*t46+3003.0/170.0*t48+18711.0/1360.0*t50+6237.0/680.0*t52;
  values[22] = 2163.0/680.0*t59+2121.0/68.0*t63-693.0/34.0*t65-6237.0/680.0*t69-6237.0/680.0*t71-3003.0/85.0*t73-3003.0/170.0*t75;
  values[23] = -t157-t158-t159+t160+369.0/32.0*xi-315.0/32.0*t5+t163+t164;
  values[24] = 325.0/88.0*eta-525.0/88.0*t33-175.0/88.0*t35-4725.0/704.0*t42-1575.0/352.0*t44+1575.0/704.0*t54+1575.0/352.0*t56;
  values[25] = -t157-t158-t159+t160-51.0/32.0*xi+525.0/32.0*t5-t163-t164;
  values[26] = -351.0/85.0-2187.0/1360.0*t1-3483.0/136.0*t37+1323.0/136.0*t12+12069.0/272.0*t4-3591.0/68.0*t9+6237.0/1360.0*t46+6237.0/680.0*t48+16443.0/680.0*t50+5481.0/340.0*t52;
  values[27] = 945.0/68.0*t59-525.0/68.0*t63-735.0/68.0*t65+945.0/136.0*t69+945.0/136.0*t71-1155.0/68.0*t73-1155.0/136.0*t75;
  values[28] = -45.0/34.0+945.0/136.0*t1-2205.0/136.0*t37-525.0/272.0*t12+105.0/136.0*t4+1575.0/272.0*t9+1155.0/272.0*t46+1155.0/136.0*t48-2835.0/272.0*t50-945.0/136.0*t52;
  values[29] = -2187.0/680.0*t59+1323.0/34.0*t63-1161.0/68.0*t65-5481.0/340.0*t69-5481.0/340.0*t71-6237.0/340.0*t73-6237.0/680.0*t75;
}

static void N_Q_Q5_2D_DeriveEta(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54;
  double t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80;
  double t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93;
  double t94, t95, t96, t97, t98, t99, t100, t101, t102, t103, t104, t105;
  double t106, t107, t108, t109, t110, t111, t112, t113, t114, t115, t116;
  double t117, t118, t119, t120, t121, t122, t123, t124, t125, t126, t127;
  double t128, t129, t130, t131, t132, t157, t158, t159, t160, t163, t164;

  t1 = xi*xi;
  t2 = t1*eta;
  t3 = 297.0/64.0*t2;
  t4 = t1*t1;
  t5 = t4*eta;
  t6 = 2541.0/512.0*t5;
  t7 = eta*eta;
  t8 = t7*eta;
  t9 = t1-t7;
  t10 = t8*t9;
  t11 = 4851.0/256.0*t10;
  t12 = t7*t7;
  t13 = t12*eta;
  t14 = 4851.0/512.0*t13;
  t15 = 123.0/64.0*eta;
  t16 = 105.0/8.0*t7;
  t17 = 1365.0/64.0*t8;
  t18 = 315.0/16.0*t12;
  t19 = t2*t9;
  t20 = 231.0/32.0*t19;
  t21 = t1*t8;
  t22 = 231.0/32.0*t21;
  t23 = t3+t6-t11+t14+t15+t16-t17-t18-t20+t22-15.0/16.0;
  t24 = 4851.0/512.0*t5;
  t25 = 2541.0/256.0*t10;
  t26 = 2541.0/512.0*t13;
  t27 = 297.0/64.0*eta;
  t28 = 1155.0/64.0*t8;
  t29 = t3-t24+t25-t26-t27+t28+t20-t22;
  t30 = t3+t6-t11+t14+t15-t16-t17+t18-t20+t22+15.0/16.0;
  t31 = 237.0/352.0*xi;
  t32 = xi*eta;
  t33 = 2163.0/1360.0*t32;
  t34 = t1*xi;
  t35 = 945.0/352.0*t34;
  t36 = xi*t7;
  t37 = 1785.0/352.0*t36;
  t38 = t34*eta;
  t39 = 693.0/68.0*t38;
  t40 = xi*t8;
  t41 = 2121.0/136.0*t40;
  t42 = t34*t9;
  t43 = 3969.0/2816.0*t42;
  t44 = t34*t7;
  t45 = 3969.0/1408.0*t44;
  t46 = t40*t9;
  t47 = 3003.0/170.0*t46;
  t48 = xi*t13;
  t49 = 3003.0/340.0*t48;
  t50 = t38*t9;
  t51 = 6237.0/1360.0*t50;
  t52 = t34*t8;
  t53 = 6237.0/1360.0*t52;
  t54 = t36*t9;
  t55 = 21357.0/2816.0*t54;
  t56 = xi*t12;
  t57 = 7119.0/1408.0*t56;
  t58 = t31-t33-t35+t37+t39-t41+t43-t45-t47+t49-t51+t53+t55-t57;
  t59 = 2163.0/2720.0*t1;
  t60 = 595.0/352.0*t34;
  t61 = 2835.0/352.0*t36;
  t62 = 2121.0/544.0*t4;
  t63 = t1*t7;
  t64 = 2079.0/136.0*t63;
  t65 = 2079.0/544.0*t7;
  t66 = 2079.0/544.0*t12;
  t67 = 7119.0/2816.0*t42;
  t68 = 7119.0/1408.0*t44;
  t69 = t63*t9;
  t70 = 18711.0/2720.0*t69;
  t71 = t1*t12;
  t72 = 6237.0/1360.0*t71;
  t73 = t4*t9;
  t74 = 3003.0/680.0*t73;
  t75 = t4*t7;
  t76 = 3003.0/340.0*t75;
  t77 = 11907.0/2816.0*t54;
  t78 = 3969.0/1408.0*t56;
  t79 = -t31-t59-t60+t61-t62+t64-t65+t66+t67-t68+t70-t72+t74-t76+t77-t78+563.0/1360.0;
  t80 = t31+t33-t35+t37-t39+t41+t43-t45+t47-t49+t51-t53+t55-t57;
  t81 = -t31+t59-t60+t61+t62-t64+t65-t66+t67-t68-t70+t72-t74+t76+t77-t78-563.0/1360.0;
  t82 = 5247.0/2720.0*t1;
  t83 = 9.0/8.0*t2;
  t84 = 1323.0/272.0*t4;
  t85 = 1953.0/272.0*t63;
  t86 = 231.0/32.0*t5;
  t87 = 231.0/16.0*t10;
  t88 = 231.0/32.0*t13;
  t89 = 87.0/16.0*eta;
  t90 = 1869.0/544.0*t7;
  t91 = 105.0/4.0*t8;
  t92 = 1827.0/272.0*t12;
  t93 = 16443.0/1360.0*t69;
  t94 = 5481.0/680.0*t71;
  t95 = 6237.0/2720.0*t73;
  t96 = 6237.0/1360.0*t75;
  t97 = 21.0/2.0*t19;
  t98 = 21.0/2.0*t21;
  t99 = t82+t83-t84+t85+t86-t87+t88+t89-t90-t91+t92+t93-t94+t95-t96-t97+t98+3.0/1360.0;
  t100 = 5247.0/1360.0*t32;
  t101 = 651.0/136.0*t38;
  t102 = 1323.0/68.0*t40;
  t103 = 99.0/16.0*eta;
  t104 = 6237.0/680.0*t46;
  t105 = 6237.0/1360.0*t48;
  t106 = 5481.0/680.0*t50;
  t107 = 5481.0/680.0*t52;
  t108 = -t100+t83-t101+t102-t86+t87-t88-t103+t91+t104-t105+t106-t107+t97-t98;
  t109 = -t82+t83+t84-t85+t86-t87+t88+t89+t90-t91-t92-t93+t94-t95+t96-t97+t98-3.0/1360.0;
  t110 = t100+t83+t101-t102-t86+t87-t88-t103+t91-t104+t105-t106+t107+t97-t98;
  t111 = 27.0/352.0*xi;
  t112 = 2187.0/1360.0*t32;
  t113 = 1035.0/352.0*t34;
  t114 = 1161.0/136.0*t38;
  t115 = t111+t112-t113+t61+t114-t102+t67-t68-t104+t105-t106+t107+t77-t78;
  t116 = 2187.0/2720.0*t1;
  t117 = 3105.0/352.0*t36;
  t118 = 3483.0/272.0*t63;
  t119 = 2889.0/544.0*t7;
  t120 = -t111+t116-t35+t117-t84+t118-t119+t92+t43-t45+t93-t94+t95-t96+t55-t57+513.0/1360.0;
  t121 = t111-t112-t113+t61-t114+t102+t67-t68+t104-t105+t106-t107+t77-t78;
  t122 = -t111-t116-t35+t117+t84-t118+t119-t92+t43-t45-t93+t94-t95+t96+t55-t57-513.0/1360.0;
  t123 = 2937.0/2720.0*t1;
  t124 = 3311.0/544.0*t4;
  t125 = t123-t3-t124+t64+t24-t25+t26+t27-t65-t28+t66+t70-t72+t74-t76-t20+t22+77.0/340.0;
  t126 = 2937.0/1360.0*t32;
  t127 = 3311.0/136.0*t40;
  t128 = 363.0/64.0*eta;
  t129 = 1925.0/64.0*t8;
  t130 = -t126-t3-t39+t127-t6+t11-t14-t128+t129+t47-t49+t51-t53+t20-t22;
  t131 = -t123-t3+t124-t64+t24-t25+t26+t27+t65-t28-t66-t70+t72-t74+t76-t20+t22-77.0/340.0;
  t132 = t126-t3+t39-t127-t6+t11-t14-t128+t129-t47+t49-t51+t53+t20-t22;
  t157 = 369.0/32.0*t2;
  t158 = 1155.0/256.0*t5;
  t159 = 1155.0/128.0*t10;
  t160 = 1155.0/256.0*t13;
  t163 = 105.0/16.0*t19;
  t164 = 105.0/16.0*t21;

  values[0] = t23;
  values[1] = t29;
  values[2] = t30;
  values[3] = t29;
  values[4] = t58;
  values[5] = t79;
  values[6] = t80;
  values[7] = t81;
  values[8] = t99;
  values[9] = t108;
  values[10] = t109;
  values[11] = t110;
  values[12] = t115;
  values[13] = t120;
  values[14] = t121;
  values[15] = t122;
  values[16] = t125;
  values[17] = t130;
  values[18] = t131;
  values[19] = t132;
  values[20] = -297.0/16.0*t2+1155.0/128.0*t5+1155.0/64.0*t10-1155.0/128.0*t13+t89+105.0/16.0*t8;
  values[21] = 2163.0/680.0*t32-693.0/34.0*t38+2121.0/68.0*t40+3003.0/85.0*t46-3003.0/170.0*t48+6237.0/680.0*t50-6237.0/680.0*t52;
  values[22] = 2163.0/1360.0*t1+2121.0/272.0*t4-2079.0/68.0*t63+9219.0/272.0*t7-12789.0/272.0*t12-18711.0/1360.0*t69+6237.0/680.0*t71-3003.0/340.0*t73+3003.0/170.0*t75-579.0/340.0;
  values[23] = -t157+t158+t159-t160-51.0/32.0*eta+525.0/32.0*t8+t163-t164;
  values[24] = 325.0/88.0*xi-175.0/88.0*t34-525.0/88.0*t36-1575.0/704.0*t42+1575.0/352.0*t44+4725.0/704.0*t54-1575.0/352.0*t56;
  values[25] = -t157+t158+t159-t160+369.0/32.0*eta-315.0/32.0*t8-t163+t164;
  values[26] = -2187.0/680.0*t32-1161.0/68.0*t38+1323.0/34.0*t40+6237.0/340.0*t46-6237.0/680.0*t48+5481.0/340.0*t50-5481.0/340.0*t52;
  values[27] = 945.0/136.0*t1-525.0/272.0*t4-2205.0/136.0*t63+105.0/136.0*t7+1575.0/272.0*t12+2835.0/272.0*t69-945.0/136.0*t71-1155.0/272.0*t73+1155.0/136.0*t75-45.0/34.0;
  values[28] = 945.0/68.0*t32-735.0/68.0*t38-525.0/68.0*t40+1155.0/68.0*t46-1155.0/136.0*t48-945.0/136.0*t50+945.0/136.0*t52;
  values[29] = -2187.0/1360.0*t1+1323.0/136.0*t4-3483.0/136.0*t63+12069.0/272.0*t7-3591.0/68.0*t12-16443.0/680.0*t69+5481.0/340.0*t71-6237.0/1360.0*t73+6237.0/680.0*t75-351.0/85.0;
}

static void N_Q_Q5_2D_DeriveXiXi(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41, t42, t43;
  double t44, t46, t47, t48, t49, t50, t51, t52, t53, t54, t55, t56, t57;
  double t58, t59, t60, t61, t62, t64, t65, t66, t67, t68, t69, t70, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79, t80, t81, t82, t83, t84;
  double t85, t86, t87, t88, t89, t90, t91, t93, t94, t95, t97, t98, t99;
  double t100, t101, t102, t103, t104, t126, t127, t128, t129, t131, t132;

  t1 = eta*eta;
  t2 = 297.0/64.0*t1;
  t3 = xi*xi;
  t4 = t3-t1;
  t5 = t3*t4;
  t6 = 7623.0/256.0*t5;
  t7 = t3*t3;
  t8 = 22869.0/512.0*t7;
  t9 = t1*t1;
  t10 = 4851.0/512.0*t9;
  t11 = 3465.0/64.0*t3;
  t12 = t1*t4;
  t13 = 231.0/32.0*t12;
  t14 = t3*t1;
  t15 = 1155.0/32.0*t14;
  t16 = t2-t6-t8-t10-297.0/64.0+t11-t13-t15;
  t17 = 14553.0/256.0*t5;
  t18 = 43659.0/512.0*t7;
  t19 = 2541.0/512.0*t9;
  t20 = 105.0/4.0*xi;
  t21 = 4095.0/64.0*t3;
  t22 = t3*xi;
  t23 = 315.0/4.0*t22;
  t26 = xi*eta;
  t27 = 2835.0/176.0*t26;
  t28 = xi*t1;
  t29 = 2079.0/68.0*t28;
  t30 = 2079.0/272.0*xi;
  t31 = 2079.0/136.0*t22;
  t32 = t26*t4;
  t33 = 11907.0/1408.0*t32;
  t34 = t22*eta;
  t35 = 27783.0/1408.0*t34;
  t36 = xi*t9;
  t37 = 9009.0/340.0*t36;
  t38 = t28*t4;
  t39 = 18711.0/1360.0*t38;
  t40 = t22*t1;
  t41 = 43659.0/1360.0*t40;
  t42 = t1*eta;
  t43 = xi*t42;
  t44 = 21357.0/1408.0*t43;
  t46 = 2163.0/1360.0*eta;
  t47 = 1785.0/176.0*t26;
  t48 = t3*eta;
  t49 = 6363.0/136.0*t48;
  t50 = 693.0/68.0*t42;
  t51 = 21357.0/1408.0*t32;
  t52 = 49833.0/1408.0*t34;
  t53 = t42*t4;
  t54 = 6237.0/1360.0*t53;
  t55 = t3*t42;
  t56 = 6237.0/272.0*t55;
  t57 = t48*t4;
  t58 = 9009.0/170.0*t57;
  t59 = t7*eta;
  t60 = 27027.0/340.0*t59;
  t61 = 11907.0/1408.0*t43;
  t62 = -t46-t47-t49+t50+t51+t52+t54+t56+t58+t60+t61;
  t64 = t46-t47+t49-t50+t51+t52-t54-t56-t58-t60+t61;
  t65 = 5247.0/1360.0*eta;
  t66 = 9.0/8.0*t1;
  t67 = 3969.0/68.0*t48;
  t68 = 651.0/136.0*t42;
  t69 = 693.0/16.0*t5;
  t70 = 2079.0/32.0*t7;
  t71 = 231.0/32.0*t9;
  t72 = 315.0/4.0*t3;
  t73 = 5481.0/680.0*t53;
  t74 = 5481.0/136.0*t55;
  t75 = 18711.0/680.0*t57;
  t76 = 56133.0/1360.0*t59;
  t77 = 21.0/2.0*t12;
  t78 = 105.0/2.0*t14;
  t79 = t65+t66-t67+t68-t69-t70-t71-99.0/16.0+t72+t73+t74+t75+t76-t77-t78;
  t80 = 1953.0/136.0*t28;
  t81 = 1869.0/272.0*xi;
  t82 = 1827.0/68.0*t22;
  t83 = 18711.0/1360.0*t36;
  t84 = 16443.0/680.0*t38;
  t85 = 38367.0/680.0*t40;
  t86 = t66-t80+t69+t70+t71+87.0/16.0+t81-t72-t82+t83+t84+t85+t77+t78;
  t87 = -t65+t66+t67-t68-t69-t70-t71-99.0/16.0+t72-t73-t74-t75-t76-t77-t78;
  t88 = t66+t80+t69+t70+t71+87.0/16.0-t81-t72+t82-t83-t84-t85+t77+t78;
  t89 = 3105.0/176.0*t26;
  t90 = 3483.0/136.0*t28;
  t91 = 2889.0/272.0*xi;
  t93 = 2187.0/1360.0*eta;
  t94 = 1161.0/136.0*t42;
  t95 = t93-t27-t67+t94+t33+t35+t73+t74+t75+t76+t44;
  t97 = -t93-t27+t67-t94+t33+t35-t73-t74-t75-t76+t44;
  t98 = 2937.0/1360.0*eta;
  t99 = 9933.0/136.0*t48;
  t100 = 5775.0/64.0*t3;
  t101 = t98-t2-t99+t50-t17-t18-t19-363.0/64.0+t100+t54+t56+t58+t60-t13-t15;
  t102 = -t2-t29+t6+t8+t10+297.0/64.0+t30-t11-t31+t37+t39+t41+t13+t15;
  t103 = -t98-t2+t99-t50-t17-t18-t19-363.0/64.0+t100-t54-t56-t58-t60-t13-t15;
  t104 = -t2+t29+t6+t8+t10+297.0/64.0-t30-t11+t31-t37-t39-t41+t13+t15;
  t126 = 369.0/32.0*t1;
  t127 = 3465.0/128.0*t5;
  t128 = 10395.0/256.0*t7;
  t129 = 1155.0/256.0*t9;
  t131 = 105.0/16.0*t12;
  t132 = 525.0/16.0*t14;

  values[0] = t16;
  values[1] = t2+t17+t18+t19+123.0/64.0-t20-t21+t23+t13+t15;
  values[2] = t16;
  values[3] = t2+t17+t18+t19+123.0/64.0+t20-t21-t23+t13+t15;
  values[4] = -t27+t29-t30+t31+t33+t35-t37-t39-t41+t44;
  values[5] = t62;
  values[6] = -t27-t29+t30-t31+t33+t35+t37+t39+t41+t44;
  values[7] = t64;
  values[8] = t79;
  values[9] = t86;
  values[10] = t87;
  values[11] = t88;
  values[12] = -t89+t90-t91+t82+t51+t52-t83-t84-t85+t61;
  values[13] = t95;
  values[14] = -t89-t90+t91-t82+t51+t52+t83+t84+t85+t61;
  values[15] = t97;
  values[16] = t101;
  values[17] = t102;
  values[18] = t103;
  values[19] = t104;
  values[20] = -297.0/16.0*t1-3465.0/64.0*t5-10395.0/128.0*t7+1155.0/128.0*t9+87.0/16.0+315.0/16.0*t3;
  values[21] = -2079.0/34.0*t28+9219.0/136.0*xi-12789.0/68.0*t22+9009.0/170.0*t36+18711.0/680.0*t38+43659.0/680.0*t40;
  values[22] = 2163.0/680.0*eta+6363.0/68.0*t48-693.0/34.0*t42-6237.0/680.0*t53-6237.0/136.0*t55-9009.0/85.0*t57-27027.0/170.0*t59;
  values[23] = -t126-t127-t128+t129+369.0/32.0-945.0/32.0*t3+t131+t132;
  values[24] = -525.0/44.0*t26-4725.0/352.0*t32-11025.0/352.0*t34+4725.0/352.0*t43;
  values[25] = -t126-t127-t128+t129-51.0/32.0+1575.0/32.0*t3-t131-t132;
  values[26] = -3483.0/68.0*t28+12069.0/136.0*xi-3591.0/17.0*t22+18711.0/680.0*t36+16443.0/340.0*t38+38367.0/340.0*t40;
  values[27] = 945.0/68.0*eta-1575.0/68.0*t48-735.0/68.0*t42+945.0/136.0*t53+4725.0/136.0*t55-3465.0/68.0*t57-10395.0/136.0*t59;
  values[28] = -2205.0/68.0*t28+105.0/68.0*xi+1575.0/68.0*t22+3465.0/136.0*t36-2835.0/136.0*t38-6615.0/136.0*t40;
  values[29] = -2187.0/680.0*eta+3969.0/34.0*t48-1161.0/68.0*t42-5481.0/340.0*t53-5481.0/68.0*t55-18711.0/340.0*t57-56133.0/680.0*t59;
}

static void N_Q_Q5_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28;
  double t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41;
  double t42, t43, t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54;
  double t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67;
  double t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80;
  double t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93;
  double t94, t95, t96, t97, t98, t99, t100, t101, t102, t103, t104, t105;
  double t106, t107, t108, t109, t132, t135;

  t1 = xi*eta;
  t2 = 297.0/32.0*t1;
  t3 = xi*xi;
  t4 = t3*xi;
  t5 = t4*eta;
  t6 = 693.0/128.0*t5;
  t7 = eta*eta;
  t8 = t7*eta;
  t9 = xi*t8;
  t10 = 3003.0/128.0*t9;
  t11 = t3-t7;
  t12 = t1*t11;
  t13 = 231.0/16.0*t12;
  t14 = t2+t6-t10-t13;
  t15 = 3003.0/128.0*t5;
  t16 = 693.0/128.0*t9;
  t17 = t2-t15+t16+t13;
  t18 = 2163.0/1360.0*eta;
  t19 = 2835.0/352.0*t3;
  t20 = 1785.0/352.0*t7;
  t21 = t3*eta;
  t22 = 2079.0/68.0*t21;
  t23 = 2121.0/136.0*t8;
  t24 = t3*t11;
  t25 = 11907.0/2816.0*t24;
  t26 = t3*t7;
  t27 = 4725.0/704.0*t26;
  t28 = t3*t3;
  t29 = 3969.0/1408.0*t28;
  t30 = t8*t11;
  t31 = 3003.0/170.0*t30;
  t32 = t7*t7;
  t33 = t32*eta;
  t34 = 3003.0/340.0*t33;
  t35 = t3*t8;
  t36 = 29337.0/1360.0*t35;
  t37 = t21*t11;
  t38 = 18711.0/1360.0*t37;
  t39 = t28*eta;
  t40 = 6237.0/680.0*t39;
  t41 = t7*t11;
  t42 = 21357.0/2816.0*t41;
  t43 = 7119.0/1408.0*t32;
  t44 = 237.0/352.0-t18-t19+t20+t22-t23+t25+t27+t29-t31+t34-t36-t38-t40+t42-t43;
  t45 = 2163.0/1360.0*xi;
  t46 = 1785.0/352.0*t3;
  t47 = 2835.0/352.0*t7;
  t48 = 2121.0/136.0*t4;
  t49 = xi*t7;
  t50 = 2079.0/68.0*t49;
  t51 = 21357.0/2816.0*t24;
  t52 = 7119.0/1408.0*t28;
  t53 = t49*t11;
  t54 = 18711.0/1360.0*t53;
  t55 = xi*t32;
  t56 = 6237.0/680.0*t55;
  t57 = t4*t7;
  t58 = 29337.0/1360.0*t57;
  t59 = t4*t11;
  t60 = 3003.0/170.0*t59;
  t61 = t28*xi;
  t62 = 3003.0/340.0*t61;
  t63 = 11907.0/2816.0*t41;
  t64 = 3969.0/1408.0*t32;
  t65 = -237.0/352.0-t45-t46+t47-t48+t50+t51-t27+t52+t54-t56-t58+t60+t62+t63-t64;
  t66 = 237.0/352.0+t18-t19+t20-t22+t23+t25+t27+t29+t31-t34+t36+t38+t40+t42-t43;
  t67 = -237.0/352.0+t45-t46+t47+t48-t50+t51-t27+t52-t54+t56+t58-t60-t62+t63-t64;
  t68 = 5247.0/1360.0*xi;
  t69 = 9.0/4.0*t1;
  t70 = 1323.0/68.0*t4;
  t71 = 1953.0/136.0*t49;
  t72 = 63.0/8.0*t5;
  t73 = 63.0/8.0*t9;
  t74 = 16443.0/680.0*t53;
  t75 = 5481.0/340.0*t55;
  t76 = 3969.0/680.0*t57;
  t77 = 6237.0/680.0*t59;
  t78 = 6237.0/1360.0*t61;
  t79 = 21.0*t12;
  t80 = t68+t69-t70+t71+t72-t73+t74-t75+t76+t77+t78-t79;
  t81 = 5247.0/1360.0*eta;
  t82 = 1953.0/136.0*t21;
  t83 = 1323.0/68.0*t8;
  t84 = 6237.0/680.0*t30;
  t85 = 6237.0/1360.0*t33;
  t86 = 3969.0/680.0*t35;
  t87 = 16443.0/680.0*t37;
  t88 = 5481.0/340.0*t39;
  t89 = -t81+t69-t82+t83-t72+t73+t84-t85-t86+t87+t88+t79;
  t90 = -t68+t69+t70-t71+t72-t73-t74+t75-t76-t77-t78-t79;
  t91 = t81+t69+t82-t83-t72+t73-t84+t85+t86-t87-t88+t79;
  t92 = 2187.0/1360.0*eta;
  t93 = 3105.0/352.0*t3;
  t94 = 3483.0/136.0*t21;
  t95 = 27.0/352.0+t92-t93+t47+t94-t83+t51-t27+t52-t84+t85+t86-t87-t88+t63-t64;
  t96 = 2187.0/1360.0*xi;
  t97 = 3105.0/352.0*t7;
  t98 = 3483.0/136.0*t49;
  t99 = -27.0/352.0+t96-t19+t97-t70+t98+t25+t27+t29+t74-t75+t76+t77+t78+t42-t43;
  t100 = 27.0/352.0-t92-t93+t47-t94+t83+t51-t27+t52+t84-t85-t86+t87+t88+t63-t64;
  t101 = -27.0/352.0-t96-t19+t97+t70-t98+t25+t27+t29-t74+t75-t76-t77-t78+t42-t43;
  t102 = 2937.0/1360.0*xi;
  t103 = 3311.0/136.0*t4;
  t104 = t102-t2-t103+t50+t15-t16+t54-t56-t58+t60+t62-t13;
  t105 = 2937.0/1360.0*eta;
  t106 = 3311.0/136.0*t8;
  t107 = -t105-t2-t22+t106-t6+t10+t31-t34+t36+t38+t40+t13;
  t108 = -t102-t2+t103-t50+t15-t16-t54+t56+t58-t60-t62-t13;
  t109 = t105-t2+t22-t106-t6+t10-t31+t34-t36-t38-t40+t13;
  t132 = 369.0/16.0*t1;
  t135 = 105.0/8.0*t12;

  values[0] = t14;
  values[1] = t17;
  values[2] = t14;
  values[3] = t17;
  values[4] = t44;
  values[5] = t65;
  values[6] = t66;
  values[7] = t67;
  values[8] = t80;
  values[9] = t89;
  values[10] = t90;
  values[11] = t91;
  values[12] = t95;
  values[13] = t99;
  values[14] = t100;
  values[15] = t101;
  values[16] = t104;
  values[17] = t107;
  values[18] = t108;
  values[19] = t109;
  values[20] = -297.0/8.0*t1+1155.0/32.0*t5+1155.0/32.0*t9;
  values[21] = 2163.0/680.0*eta-2079.0/34.0*t21+2121.0/68.0*t8+3003.0/85.0*t30-3003.0/170.0*t33+29337.0/680.0*t35+18711.0/680.0*t37+6237.0/340.0*t39;
  values[22] = 2163.0/680.0*xi+2121.0/68.0*t4-2079.0/34.0*t49-18711.0/680.0*t53+6237.0/340.0*t55+29337.0/680.0*t57-3003.0/85.0*t59-3003.0/170.0*t61;
  values[23] = -t132+1995.0/64.0*t5+315.0/64.0*t9+t135;
  values[24] = 325.0/88.0-525.0/88.0*t3-525.0/88.0*t7-4725.0/704.0*t24+4725.0/176.0*t26-1575.0/352.0*t28+4725.0/704.0*t41-1575.0/352.0*t32;
  values[25] = -t132+315.0/64.0*t5+1995.0/64.0*t9-t135;
  values[26] = -2187.0/680.0*eta-3483.0/68.0*t21+1323.0/34.0*t8+6237.0/340.0*t30-6237.0/680.0*t33-3969.0/340.0*t35+16443.0/340.0*t37+5481.0/170.0*t39;
  values[27] = 945.0/68.0*xi-525.0/68.0*t4-2205.0/68.0*t49+2835.0/136.0*t53-945.0/68.0*t55+7455.0/136.0*t57-1155.0/68.0*t59-1155.0/136.0*t61;
  values[28] = 945.0/68.0*eta-2205.0/68.0*t21-525.0/68.0*t8+1155.0/68.0*t30-1155.0/136.0*t33+7455.0/136.0*t35-2835.0/136.0*t37-945.0/68.0*t39;
  values[29] = -2187.0/680.0*xi+1323.0/34.0*t4-3483.0/68.0*t49-16443.0/340.0*t53+5481.0/170.0*t55-3969.0/340.0*t57-6237.0/340.0*t59-6237.0/680.0*t61;
}

static void N_Q_Q5_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15;
  double t16, t17, t18, t20, t21, t22, t23, t24, t26, t27, t28, t29, t30;
  double t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41, t42, t43;
  double t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54, t55, t56;
  double t57, t58, t59, t60, t61, t63, t65, t66, t67, t68, t69, t70, t71;
  double t72, t73, t74, t75, t76, t77, t78, t79, t80, t81, t82, t83, t84;
  double t85, t86, t87, t88, t89, t90, t91, t92, t93, t94, t96, t98, t99;
  double t100, t101, t102, t103, t104, t126, t127, t128, t129, t131, t132;

  t1 = xi*xi;
  t2 = 297.0/64.0*t1;
  t3 = t1*t1;
  t4 = 2541.0/512.0*t3;
  t5 = eta*eta;
  t6 = t1-t5;
  t7 = t5*t6;
  t8 = 14553.0/256.0*t7;
  t9 = t5*t5;
  t10 = 43659.0/512.0*t9;
  t11 = 105.0/4.0*eta;
  t12 = 4095.0/64.0*t5;
  t13 = t5*eta;
  t14 = 315.0/4.0*t13;
  t15 = t1*t6;
  t16 = 231.0/32.0*t15;
  t17 = t1*t5;
  t18 = 1155.0/32.0*t17;
  t20 = 4851.0/512.0*t3;
  t21 = 7623.0/256.0*t7;
  t22 = 22869.0/512.0*t9;
  t23 = 3465.0/64.0*t5;
  t24 = t2-t20+t21-t22-297.0/64.0+t23+t16-t18;
  t26 = 2163.0/1360.0*xi;
  t27 = xi*eta;
  t28 = 1785.0/176.0*t27;
  t29 = t1*xi;
  t30 = 693.0/68.0*t29;
  t31 = xi*t5;
  t32 = 6363.0/136.0*t31;
  t33 = t29*eta;
  t34 = 11907.0/1408.0*t33;
  t35 = t31*t6;
  t36 = 9009.0/170.0*t35;
  t37 = xi*t9;
  t38 = 27027.0/340.0*t37;
  t39 = t29*t6;
  t40 = 6237.0/1360.0*t39;
  t41 = t29*t5;
  t42 = 6237.0/272.0*t41;
  t43 = t27*t6;
  t44 = 21357.0/1408.0*t43;
  t45 = xi*t13;
  t46 = 49833.0/1408.0*t45;
  t47 = -t26+t28+t30-t32-t34-t36+t38-t40+t42+t44-t46;
  t48 = 2835.0/176.0*t27;
  t49 = t1*eta;
  t50 = 2079.0/68.0*t49;
  t51 = 2079.0/272.0*eta;
  t52 = 2079.0/136.0*t13;
  t53 = 21357.0/1408.0*t33;
  t54 = t49*t6;
  t55 = 18711.0/1360.0*t54;
  t56 = t1*t13;
  t57 = 43659.0/1360.0*t56;
  t58 = t3*eta;
  t59 = 9009.0/340.0*t58;
  t60 = 11907.0/1408.0*t43;
  t61 = 27783.0/1408.0*t45;
  t63 = t26+t28-t30+t32-t34+t36-t38+t40-t42+t44-t46;
  t65 = 9.0/8.0*t1;
  t66 = 1953.0/136.0*t49;
  t67 = 231.0/32.0*t3;
  t68 = 693.0/16.0*t7;
  t69 = 2079.0/32.0*t9;
  t70 = 1869.0/272.0*eta;
  t71 = 315.0/4.0*t5;
  t72 = 1827.0/68.0*t13;
  t73 = 16443.0/680.0*t54;
  t74 = 38367.0/680.0*t56;
  t75 = 18711.0/1360.0*t58;
  t76 = 21.0/2.0*t15;
  t77 = 105.0/2.0*t17;
  t78 = t65+t66+t67-t68+t69+87.0/16.0-t70-t71+t72+t73-t74-t75-t76+t77;
  t79 = 5247.0/1360.0*xi;
  t80 = 651.0/136.0*t29;
  t81 = 3969.0/68.0*t31;
  t82 = 18711.0/680.0*t35;
  t83 = 56133.0/1360.0*t37;
  t84 = 5481.0/680.0*t39;
  t85 = 5481.0/136.0*t41;
  t86 = -t79+t65-t80+t81-t67+t68-t69-99.0/16.0+t71+t82-t83+t84-t85+t76-t77;
  t87 = t65-t66+t67-t68+t69+87.0/16.0+t70-t71-t72-t73+t74+t75-t76+t77;
  t88 = t79+t65+t80-t81-t67+t68-t69-99.0/16.0+t71-t82+t83-t84+t85+t76-t77;
  t89 = 2187.0/1360.0*xi;
  t90 = 1161.0/136.0*t29;
  t91 = t89+t48+t90-t81-t53-t82+t83-t84+t85+t60-t61;
  t92 = 3105.0/176.0*t27;
  t93 = 3483.0/136.0*t49;
  t94 = 2889.0/272.0*eta;
  t96 = -t89+t48-t90+t81-t53+t82-t83+t84-t85+t60-t61;
  t98 = -t2+t50+t20-t21+t22+297.0/64.0-t51-t23+t52+t55-t57-t59-t16+t18;
  t99 = 2937.0/1360.0*xi;
  t100 = 9933.0/136.0*t31;
  t101 = 5775.0/64.0*t5;
  t102 = -t99-t2-t30+t100-t4+t8-t10-363.0/64.0+t101+t36-t38+t40-t42+t16-t18;
  t103 = -t2-t50+t20-t21+t22+297.0/64.0+t51-t23-t52-t55+t57+t59-t16+t18;
  t104 = t99-t2+t30-t100-t4+t8-t10-363.0/64.0+t101-t36+t38-t40+t42+t16-t18;
  t126 = 369.0/32.0*t1;
  t127 = 1155.0/256.0*t3;
  t128 = 3465.0/128.0*t7;
  t129 = 10395.0/256.0*t9;
  t131 = 105.0/16.0*t15;
  t132 = 525.0/16.0*t17;

  values[0] = t2+t4-t8+t10+123.0/64.0+t11-t12-t14-t16+t18;
  values[1] = t24;
  values[2] = t2+t4-t8+t10+123.0/64.0-t11-t12+t14-t16+t18;
  values[3] = t24;
  values[4] = t47;
  values[5] = t48+t50-t51+t52-t53+t55-t57-t59+t60-t61;
  values[6] = t63;
  values[7] = t48-t50+t51-t52-t53-t55+t57+t59+t60-t61;
  values[8] = t78;
  values[9] = t86;
  values[10] = t87;
  values[11] = t88;
  values[12] = t91;
  values[13] = t92+t93-t94+t72-t34+t73-t74-t75+t44-t46;
  values[14] = t96;
  values[15] = t92-t93+t94-t72-t34-t73+t74+t75+t44-t46;
  values[16] = t98;
  values[17] = t102;
  values[18] = t103;
  values[19] = t104;
  values[20] = -297.0/16.0*t1+1155.0/128.0*t3+3465.0/64.0*t7-10395.0/128.0*t9+87.0/16.0+315.0/16.0*t5;
  values[21] = 2163.0/680.0*xi-693.0/34.0*t29+6363.0/68.0*t31+9009.0/85.0*t35-27027.0/170.0*t37+6237.0/680.0*t39-6237.0/136.0*t41;
  values[22] = -2079.0/34.0*t49+9219.0/136.0*eta-12789.0/68.0*t13-18711.0/680.0*t54+43659.0/680.0*t56+9009.0/170.0*t58;
  values[23] = -t126+t127+t128-t129-51.0/32.0+1575.0/32.0*t5+t131-t132;
  values[24] = -525.0/44.0*t27+4725.0/352.0*t33+4725.0/352.0*t43-11025.0/352.0*t45;
  values[25] = -t126+t127+t128-t129+369.0/32.0-945.0/32.0*t5-t131+t132;
  values[26] = -2187.0/680.0*xi-1161.0/68.0*t29+3969.0/34.0*t31+18711.0/340.0*t35-56133.0/680.0*t37+5481.0/340.0*t39-5481.0/68.0*t41;
  values[27] = -2205.0/68.0*t49+105.0/68.0*eta+1575.0/68.0*t13+2835.0/136.0*t54-6615.0/136.0*t56+3465.0/136.0*t58;
  values[28] = 945.0/68.0*xi-735.0/68.0*t29-1575.0/68.0*t31+3465.0/68.0*t35-10395.0/136.0*t37-945.0/136.0*t39+4725.0/136.0*t41;
  values[29] = -3483.0/68.0*t49+12069.0/136.0*eta-3591.0/17.0*t13-16443.0/340.0*t54+38367.0/340.0*t56+18711.0/680.0*t58;
}

static int N_Q_Q5_2D_ChangeJ0[2] = { 4, 12 };
static int N_Q_Q5_2D_ChangeJ1[2] = { 5, 13 };
static int N_Q_Q5_2D_ChangeJ2[2] = { 6, 14 };
static int N_Q_Q5_2D_ChangeJ3[2] = { 7, 15 };

static int *N_Q_Q5_2D_Change[4] = { N_Q_Q5_2D_ChangeJ0, N_Q_Q5_2D_ChangeJ1,
                                    N_Q_Q5_2D_ChangeJ2, N_Q_Q5_2D_ChangeJ3 };
// ***********************************************************************

TBaseFunct2D *BF_N_Q_Q5_2D_Obj = new TBaseFunct2D
        (30, BF_N_Q_Q5_2D, BFUnitSquare, 
         N_Q_Q5_2D_Funct, N_Q_Q5_2D_DeriveXi,
         N_Q_Q5_2D_DeriveEta, N_Q_Q5_2D_DeriveXiXi,
         N_Q_Q5_2D_DeriveXiEta, N_Q_Q5_2D_DeriveEtaEta, 6, 5,
         2, N_Q_Q5_2D_Change);
