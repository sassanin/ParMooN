/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// P4 element, nonconforming, 2D
// ***********************************************************************

// base function values
static void N_T_P4_2D_Funct(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t9, t10, t11, t12, t14, t15, t16;
  double t18, t20, t21, t22, t24, t26, t28, t33, t41, t47, t49, t51, t55;
  double t56, t58, t59, t60, t73, t75, t89, t93, t101, t104, t105, t106;
  double t121, t122, t135, t139, t147, t151, t152, t153, t166, t168, t182;
  double t197, t198, t199, t203, t211, t214, t215, t228, t232, t240, t243;
  double t244, t245, t260, t261, t274;

  t1 = 20.0*eta;
  t2 = eta*eta;
  t3 = 90.0*t2;
  t4 = t2*eta;
  t5 = 140.0*t4;
  t6 = t2*t2;
  t7 = 70.0*t6;
  t9 = 20.0*xi;
  t10 = xi*xi;
  t11 = 90.0*t10;
  t12 = xi*eta;
  t14 = t10*xi;
  t15 = 140.0*t14;
  t16 = t10*eta;
  t18 = xi*t2;
  t20 = t10*t10;
  t21 = 70.0*t20;
  t22 = t14*eta;
  t24 = t10*t2;
  t26 = xi*t4;
  t28 = 1.0-t9-t1+t11+180.0*t12+t3-t15-420.0*t16-420.0*t18-t5+t21+280.0*t22+420.0*t24+280.0*t26+t7;
  t33 = 228.0/11.0*t12;
  t41 = 588.0/11.0*t24;
  t47 = (1.0-2.0*xi-eta)*(xi-eta);
  t49 = 2.0*eta-1.0+xi;
  t51 = t47*t49*t10;
  t55 = t47*t49*xi*eta;
  t56 = 126.0/11.0*t55;
  t58 = t47*t49*t2;
  t59 = 630.0/11.0*t58;
  t60 = -10.0/11.0-8.0/11.0*xi+250.0/11.0*eta+210.0/11.0*t10-t33-1500.0/11.0*t2-434.0/11.0*t14-1050.0/11.0*t16+2226.0/11.0*t18+2870.0/11.0*t4+252.0/11.0*t20+1022.0/11.0*t22+t41-3150.0/11.0*t26-1610.0/11.0*t6+126.0/11.0*t51+t56+t59;
  t73 = 630.0/11.0*t51;
  t75 = -50.0/11.0*xi+50.0/11.0*eta+600.0/11.0*t10-600.0/11.0*t2-1470.0/11.0*t14-1806.0/11.0*t16+1806.0/11.0*t18+1470.0/11.0*t4+910.0/11.0*t20+2758.0/11.0*t22-2758.0/11.0*t26-910.0/11.0*t6+t73+1134.0/11.0*t55+t59;
  t89 = 10.0/11.0-250.0/11.0*xi+8.0/11.0*eta+1500.0/11.0*t10+t33-210.0/11.0*t2-2870.0/11.0*t14-2226.0/11.0*t16+1050.0/11.0*t18+434.0/11.0*t4+1610.0/11.0*t20+3150.0/11.0*t22-t41-1022.0/11.0*t26-252.0/11.0*t6+t73+t56+126.0/11.0*t58;
  t93 = 492.0/11.0*t12;
  t101 = 336.0/11.0*t24;
  t104 = 1008.0/11.0*t55;
  t105 = 504.0/11.0*t58;
  t106 = 39.0/55.0-2.0/11.0*xi-196.0/11.0*eta-222.0/11.0*t10+t93+1182.0/11.0*t2+448.0/11.0*t14+966.0/11.0*t16-3066.0/11.0*t18-2268.0/11.0*t4-224.0/11.0*t20-1456.0/11.0*t22+t101+3584.0/11.0*t26+1274.0/11.0*t6-t104-t105;
  t121 = 504.0/11.0*t51;
  t122 = -1.0/55.0+4.0*xi+4.0*eta-498.0/11.0*t10-60.0/11.0*t12-498.0/11.0*t2+1204.0/11.0*t14+714.0/11.0*t16+714.0/11.0*t18+1204.0/11.0*t4-742.0/11.0*t20-1512.0/11.0*t22+252.0/11.0*t24-1512.0/11.0*t26-742.0/11.0*t6-t121+t105;
  t135 = 39.0/55.0-196.0/11.0*xi-2.0/11.0*eta+1182.0/11.0*t10+t93-222.0/11.0*t2-2268.0/11.0*t14-3066.0/11.0*t16+966.0/11.0*t18+448.0/11.0*t4+1274.0/11.0*t20+3584.0/11.0*t22+t101-1456.0/11.0*t26-224.0/11.0*t6+t121+t104;
  t139 = 3456.0/77.0*t12;
  t147 = 1332.0/11.0*t24;
  t151 = 846.0/11.0*t55;
  t152 = 270.0/11.0*t58;
  t153 = -30.0/77.0-486.0/77.0*xi+750.0/77.0*eta+1080.0/11.0*t10-t139-4500.0/77.0*t2-2694.0/11.0*t14-1440.0/11.0*t16+2736.0/11.0*t18+1230.0/11.0*t4+1692.0/11.0*t20+3342.0/11.0*t22-t147-2670.0/11.0*t26-690.0/11.0*t6+846.0/11.0*t51+t151+t152;
  t166 = 270.0/11.0*t51;
  t168 = -150.0/77.0*xi+150.0/77.0*eta+1800.0/77.0*t10-1800.0/77.0*t2-630.0/11.0*t14-576.0/11.0*t16+576.0/11.0*t18+630.0/11.0*t4+390.0/11.0*t20+918.0/11.0*t22-918.0/11.0*t26-390.0/11.0*t6+t166-306.0/11.0*t55+t152;
  t182 = 30.0/77.0-750.0/77.0*xi+486.0/77.0*eta+4500.0/77.0*t10+t139-1080.0/11.0*t2-1230.0/11.0*t14-2736.0/11.0*t16+1440.0/11.0*t18+2694.0/11.0*t4+690.0/11.0*t20+2670.0/11.0*t22+t147-3342.0/11.0*t26-1692.0/11.0*t6+t166+t151+846.0/11.0*t58;
  t197 = 2520.0/11.0*t51;
  t198 = 2520.0/11.0*t58;
  t199 = -56.0/11.0+120.0*xi+120.0*eta-7440.0/11.0*t10-5250.0/11.0*t12-7440.0/11.0*t2+13720.0/11.0*t14+12810.0/11.0*t16+12810.0/11.0*t18+13720.0/11.0*t4-7560.0/11.0*t20-13720.0/11.0*t22-3360.0/11.0*t24-13720.0/11.0*t26-7560.0/11.0*t6-t197+t198;
  t203 = 2490.0/11.0*t12;
  t211 = 7560.0/11.0*t24;
  t214 = 5040.0/11.0*t55;
  t215 = -16.0/11.0+120.0/11.0*xi+320.0/11.0*eta+960.0/11.0*t10-t203-1440.0/11.0*t2-3640.0/11.0*t14-1470.0/11.0*t16+9450.0/11.0*t18+2240.0/11.0*t4+2520.0/11.0*t20+8680.0/11.0*t22-t211-7280.0/11.0*t26-1120.0/11.0*t6+t197+t214;
  t228 = -16.0/11.0+320.0/11.0*xi+120.0/11.0*eta-1440.0/11.0*t10-t203+960.0/11.0*t2+2240.0/11.0*t14+9450.0/11.0*t16-1470.0/11.0*t18-3640.0/11.0*t4-1120.0/11.0*t20-7280.0/11.0*t22-t211+8680.0/11.0*t26+2520.0/11.0*t6-t214-t198;
  t232 = 5670.0/11.0*t12;
  t240 = 7140.0/11.0*t24;
  t243 = 7560.0/11.0*t55;
  t244 = 3780.0/11.0*t58;
  t245 = 42.0/11.0-840.0/11.0*xi-1140.0/11.0*eta+3780.0/11.0*t10+t232+7380.0/11.0*t2-5880.0/11.0*t14-3150.0/11.0*t16-24150.0/11.0*t18-14700.0/11.0*t4+2940.0/11.0*t20-1680.0/11.0*t22+t240+26880.0/11.0*t26+8400.0/11.0*t6-t243-t244;
  t260 = 3780.0/11.0*t51;
  t261 = -18.0/11.0+60.0*xi+60.0*eta-5220.0/11.0*t10-3090.0/11.0*t12-5220.0/11.0*t2+11340.0/11.0*t14+11130.0/11.0*t16+11130.0/11.0*t18+11340.0/11.0*t4-6720.0/11.0*t20-15960.0/11.0*t22-420.0/11.0*t24-15960.0/11.0*t26-6720.0/11.0*t6-t260+t244;
  t274 = 42.0/11.0-1140.0/11.0*xi-840.0/11.0*eta+7380.0/11.0*t10+t232+3780.0/11.0*t2-14700.0/11.0*t14-24150.0/11.0*t16-3150.0/11.0*t18-5880.0/11.0*t4+8400.0/11.0*t20+26880.0/11.0*t22+t240-1680.0/11.0*t26+2940.0/11.0*t6+t260+t243;

  values[0] = 1.0-t1+t3-t5+t7;
  values[1] = t28;
  values[2] = 1.0-t9+t11-t15+t21;
  values[3] = t60;
  values[4] = t75;
  values[5] = t89;
  values[6] = t106;
  values[7] = t122;
  values[8] = t135;
  values[9] = t153;
  values[10] = t168;
  values[11] = t182;
  values[12] = t199;
  values[13] = t215;
  values[14] = t228;
  values[15] = t245;
  values[16] = t261;
  values[17] = t274;
}

// values of the derivatives in xi direction
static void N_T_P4_2D_DeriveXi(double xi, double eta, double *values)
{
  double t1, t3, t4, t5, t7, t9, t10, t11, t13, t15, t20, t26, t29, t31;
  double t32, t33, t36, t37, t38, t40, t41, t44, t46, t47, t48, t49, t50;
  double t51, t53, t54, t55, t56, t57, t58, t59, t60, t61, t70, t71, t72;
  double t73, t78, t90, t93, t99, t101, t102, t103, t104, t105, t106, t107;
  double t108, t118, t119, t120, t121, t122, t130, t132, t138, t145, t146;
  double t147, t148, t149, t150, t151, t152, t161, t162, t163, t164, t169;
  double t181, t192, t193, t194, t195, t196, t197, t198, t199, t201, t207;
  double t209, t210, t211, t212, t213, t221, t223, t229, t231, t232, t233;
  double t234, t235, t236, t237, t238, t248, t249, t250, t251, t252, t260;

  t1 = 180.0*xi;
  t3 = xi*xi;
  t4 = 420.0*t3;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t10 = 280.0*t9;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t20 = 228.0/11.0*eta;
  t26 = 1176.0/11.0*t13;
  t29 = xi-eta;
  t31 = 2.0*eta-1.0+xi;
  t32 = t29*t31;
  t33 = t32*t3;
  t36 = 1.0-2.0*xi-eta;
  t37 = t36*t31;
  t38 = t37*t3;
  t40 = t36*t29;
  t41 = t40*t3;
  t44 = t40*t31*xi;
  t46 = t32*t5;
  t47 = 252.0/11.0*t46;
  t48 = t37*t5;
  t49 = 126.0/11.0*t48;
  t50 = t40*t5;
  t51 = 126.0/11.0*t50;
  t53 = t40*t31*eta;
  t54 = 126.0/11.0*t53;
  t55 = t32*t7;
  t56 = 1260.0/11.0*t55;
  t57 = t37*t7;
  t58 = 630.0/11.0*t57;
  t59 = t40*t7;
  t60 = 630.0/11.0*t59;
  t61 = -252.0/11.0*t33+126.0/11.0*t38+126.0/11.0*t41+252.0/11.0*t44-t47+t49+t51+t54-t56+t58+t60;
  t70 = 1260.0/11.0*t33;
  t71 = 630.0/11.0*t38;
  t72 = 630.0/11.0*t41;
  t73 = 1260.0/11.0*t44;
  t78 = -50.0/11.0+1200.0/11.0*xi-4410.0/11.0*t3-3612.0/11.0*t5+1806.0/11.0*t7+3640.0/11.0*t9+8274.0/11.0*t11-2758.0/11.0*t15-t70+t71+t72+t73-2268.0/11.0*t46+1134.0/11.0*t48+1134.0/11.0*t50+1134.0/11.0*t53-t56+t58+t60;
  t90 = -t70+t71+t72+t73-t47+t49+t51+t54-252.0/11.0*t55+126.0/11.0*t57+126.0/11.0*t59;
  t93 = 492.0/11.0*eta;
  t99 = 672.0/11.0*t13;
  t101 = 2016.0/11.0*t46;
  t102 = 1008.0/11.0*t48;
  t103 = 1008.0/11.0*t50;
  t104 = 1008.0/11.0*t53;
  t105 = 1008.0/11.0*t55;
  t106 = 504.0/11.0*t57;
  t107 = 504.0/11.0*t59;
  t108 = -2.0/11.0-444.0/11.0*xi+t93+1344.0/11.0*t3+1932.0/11.0*t5-3066.0/11.0*t7-896.0/11.0*t9-4368.0/11.0*t11+t99+3584.0/11.0*t15+t101-t102-t103-t104+t105-t106-t107;
  t118 = 1008.0/11.0*t33;
  t119 = 504.0/11.0*t38;
  t120 = 504.0/11.0*t41;
  t121 = 1008.0/11.0*t44;
  t122 = 4.0-996.0/11.0*xi-60.0/11.0*eta+3612.0/11.0*t3+1428.0/11.0*t5+714.0/11.0*t7-2968.0/11.0*t9-4536.0/11.0*t11+504.0/11.0*t13-1512.0/11.0*t15+t118-t119-t120-t121-t105+t106+t107;
  t130 = -196.0/11.0+2364.0/11.0*xi+t93-6804.0/11.0*t3-6132.0/11.0*t5+966.0/11.0*t7+5096.0/11.0*t9+10752.0/11.0*t11+t99-1456.0/11.0*t15-t118+t119+t120+t121-t101+t102+t103+t104;
  t132 = 3456.0/77.0*eta;
  t138 = 2664.0/11.0*t13;
  t145 = 1692.0/11.0*t46;
  t146 = 846.0/11.0*t48;
  t147 = 846.0/11.0*t50;
  t148 = 846.0/11.0*t53;
  t149 = 540.0/11.0*t55;
  t150 = 270.0/11.0*t57;
  t151 = 270.0/11.0*t59;
  t152 = -1692.0/11.0*t33+846.0/11.0*t38+846.0/11.0*t41+1692.0/11.0*t44-t145+t146+t147+t148-t149+t150+t151;
  t161 = 540.0/11.0*t33;
  t162 = 270.0/11.0*t38;
  t163 = 270.0/11.0*t41;
  t164 = 540.0/11.0*t44;
  t169 = -150.0/77.0+3600.0/77.0*xi-1890.0/11.0*t3-1152.0/11.0*t5+576.0/11.0*t7+1560.0/11.0*t9+2754.0/11.0*t11-918.0/11.0*t15-t161+t162+t163+t164+612.0/11.0*t46-306.0/11.0*t48-306.0/11.0*t50-306.0/11.0*t53-t149+t150+t151;
  t181 = -t161+t162+t163+t164-t145+t146+t147+t148-1692.0/11.0*t55+846.0/11.0*t57+846.0/11.0*t59;
  t192 = 5040.0/11.0*t33;
  t193 = 2520.0/11.0*t38;
  t194 = 2520.0/11.0*t41;
  t195 = 5040.0/11.0*t44;
  t196 = 5040.0/11.0*t55;
  t197 = 2520.0/11.0*t57;
  t198 = 2520.0/11.0*t59;
  t199 = 120.0-14880.0/11.0*xi-5250.0/11.0*eta+41160.0/11.0*t3+25620.0/11.0*t5+12810.0/11.0*t7-30240.0/11.0*t9-41160.0/11.0*t11-6720.0/11.0*t13-13720.0/11.0*t15+t192-t193-t194-t195-t196+t197+t198;
  t201 = 2490.0/11.0*eta;
  t207 = 15120.0/11.0*t13;
  t209 = 10080.0/11.0*t46;
  t210 = 5040.0/11.0*t48;
  t211 = 5040.0/11.0*t50;
  t212 = 5040.0/11.0*t53;
  t213 = 120.0/11.0+1920.0/11.0*xi-t201-10920.0/11.0*t3-2940.0/11.0*t5+9450.0/11.0*t7+10080.0/11.0*t9+26040.0/11.0*t11-t207-7280.0/11.0*t15-t192+t193+t194+t195-t209+t210+t211+t212;
  t221 = 320.0/11.0-2880.0/11.0*xi-t201+6720.0/11.0*t3+18900.0/11.0*t5-1470.0/11.0*t7-4480.0/11.0*t9-21840.0/11.0*t11-t207+8680.0/11.0*t15+t209-t210-t211-t212+t196-t197-t198;
  t223 = 5670.0/11.0*eta;
  t229 = 14280.0/11.0*t13;
  t231 = 15120.0/11.0*t46;
  t232 = 7560.0/11.0*t48;
  t233 = 7560.0/11.0*t50;
  t234 = 7560.0/11.0*t53;
  t235 = 7560.0/11.0*t55;
  t236 = 3780.0/11.0*t57;
  t237 = 3780.0/11.0*t59;
  t238 = -840.0/11.0+7560.0/11.0*xi+t223-17640.0/11.0*t3-6300.0/11.0*t5-24150.0/11.0*t7+11760.0/11.0*t9-5040.0/11.0*t11+t229+26880.0/11.0*t15+t231-t232-t233-t234+t235-t236-t237;
  t248 = 7560.0/11.0*t33;
  t249 = 3780.0/11.0*t38;
  t250 = 3780.0/11.0*t41;
  t251 = 7560.0/11.0*t44;
  t252 = 60.0-10440.0/11.0*xi-3090.0/11.0*eta+34020.0/11.0*t3+22260.0/11.0*t5+11130.0/11.0*t7-26880.0/11.0*t9-47880.0/11.0*t11-840.0/11.0*t13-15960.0/11.0*t15+t248-t249-t250-t251-t235+t236+t237;
  t260 = -1140.0/11.0+14760.0/11.0*xi+t223-44100.0/11.0*t3-48300.0/11.0*t5-3150.0/11.0*t7+33600.0/11.0*t9+80640.0/11.0*t11+t229-1680.0/11.0*t15-t248+t249+t250+t251-t231+t232+t233+t234;

  values[0] = 0.0;
  values[1] = -20.0+t1+180.0*eta-t4-840.0*t5-420.0*t7+t10+840.0*t11+840.0*t13+280.0*t15;
  values[2] = -20.0+t1-t4+t10;
  values[3] = -8.0/11.0+420.0/11.0*xi-t20-1302.0/11.0*t3-2100.0/11.0*t5+2226.0/11.0*t7+1008.0/11.0*t9+3066.0/11.0*t11+t26-3150.0/11.0*t15+t61;
  values[4] = t78;
  values[5] = -250.0/11.0+3000.0/11.0*xi+t20-8610.0/11.0*t3-4452.0/11.0*t5+1050.0/11.0*t7+6440.0/11.0*t9+9450.0/11.0*t11-t26-1022.0/11.0*t15+t90;
  values[6] = t108;
  values[7] = t122;
  values[8] = t130;
  values[9] = -486.0/77.0+2160.0/11.0*xi-t132-8082.0/11.0*t3-2880.0/11.0*t5+2736.0/11.0*t7+6768.0/11.0*t9+10026.0/11.0*t11-t138-2670.0/11.0*t15+t152;
  values[10] = t169;
  values[11] = -750.0/77.0+9000.0/77.0*xi+t132-3690.0/11.0*t3-5472.0/11.0*t5+1440.0/11.0*t7+2760.0/11.0*t9+8010.0/11.0*t11+t138-3342.0/11.0*t15+t181;
  values[12] = t199;
  values[13] = t213;
  values[14] = t221;
  values[15] = t238;
  values[16] = t252;
  values[17] = t260;
}

// values of the derivatives in eta direction
static void N_T_P4_2D_DeriveEta(double xi, double eta, double *values)
{
  double t1, t2, t3, t4, t5, t8, t10, t12, t14, t16, t19, t25, t29, t31;
  double t32, t33, t36, t37, t38, t40, t41, t43, t44, t45, t46, t47, t48;
  double t50, t51, t52, t53, t54, t55, t56, t57, t59, t60, t61, t70, t71;
  double t72, t77, t90, t92, t98, t101, t102, t103, t104, t105, t106, t107;
  double t108, t109, t119, t120, t121, t122, t130, t131, t137, t144, t145;
  double t146, t147, t148, t149, t150, t151, t152, t161, t162, t163, t168;
  double t181, t192, t193, t194, t195, t196, t197, t198, t199, t200, t206;
  double t209, t210, t211, t212, t213, t221, t222, t228, t231, t232, t233;
  double t234, t235, t236, t237, t238, t239, t249, t250, t251, t252, t260;

  t1 = 180.0*eta;
  t2 = eta*eta;
  t3 = 420.0*t2;
  t4 = t2*eta;
  t5 = 280.0*t4;
  t8 = xi*xi;
  t10 = xi*eta;
  t12 = t8*xi;
  t14 = t8*eta;
  t16 = xi*t2;
  t19 = 228.0/11.0*xi;
  t25 = 1176.0/11.0*t14;
  t29 = xi-eta;
  t31 = 2.0*eta-1.0+xi;
  t32 = t29*t31;
  t33 = t32*t8;
  t36 = 1.0-2.0*xi-eta;
  t37 = t36*t31;
  t38 = t37*t8;
  t40 = t36*t29;
  t41 = t40*t8;
  t43 = t32*t10;
  t44 = 126.0/11.0*t43;
  t45 = t37*t10;
  t46 = 126.0/11.0*t45;
  t47 = t40*t10;
  t48 = 252.0/11.0*t47;
  t50 = t40*t31*xi;
  t51 = 126.0/11.0*t50;
  t52 = t32*t2;
  t53 = 630.0/11.0*t52;
  t54 = t37*t2;
  t55 = 630.0/11.0*t54;
  t56 = t40*t2;
  t57 = 1260.0/11.0*t56;
  t59 = t40*t31*eta;
  t60 = 1260.0/11.0*t59;
  t61 = -126.0/11.0*t33-126.0/11.0*t38+252.0/11.0*t41-t44-t46+t48+t51-t53-t55+t57+t60;
  t70 = 630.0/11.0*t33;
  t71 = 630.0/11.0*t38;
  t72 = 1260.0/11.0*t41;
  t77 = 50.0/11.0-1200.0/11.0*eta-1806.0/11.0*t8+3612.0/11.0*t10+4410.0/11.0*t2+2758.0/11.0*t12-8274.0/11.0*t16-3640.0/11.0*t4-t70-t71+t72-1134.0/11.0*t43-1134.0/11.0*t45+2268.0/11.0*t47+1134.0/11.0*t50-t53-t55+t57+t60;
  t90 = -t70-t71+t72-t44-t46+t48+t51-126.0/11.0*t52-126.0/11.0*t54+252.0/11.0*t56+252.0/11.0*t59;
  t92 = 492.0/11.0*xi;
  t98 = 672.0/11.0*t14;
  t101 = 1008.0/11.0*t43;
  t102 = 1008.0/11.0*t45;
  t103 = 2016.0/11.0*t47;
  t104 = 1008.0/11.0*t50;
  t105 = 504.0/11.0*t52;
  t106 = 504.0/11.0*t54;
  t107 = 1008.0/11.0*t56;
  t108 = 1008.0/11.0*t59;
  t109 = -196.0/11.0+t92+2364.0/11.0*eta+966.0/11.0*t8-6132.0/11.0*t10-6804.0/11.0*t2-1456.0/11.0*t12+t98+10752.0/11.0*t16+5096.0/11.0*t4+t101+t102-t103-t104+t105+t106-t107-t108;
  t119 = 504.0/11.0*t33;
  t120 = 504.0/11.0*t38;
  t121 = 1008.0/11.0*t41;
  t122 = 4.0-60.0/11.0*xi-996.0/11.0*eta+714.0/11.0*t8+1428.0/11.0*t10+3612.0/11.0*t2-1512.0/11.0*t12+504.0/11.0*t14-4536.0/11.0*t16-2968.0/11.0*t4+t119+t120-t121-t105-t106+t107+t108;
  t130 = -2.0/11.0+t92-444.0/11.0*eta-3066.0/11.0*t8+1932.0/11.0*t10+1344.0/11.0*t2+3584.0/11.0*t12+t98-4368.0/11.0*t16-896.0/11.0*t4-t119-t120+t121-t101-t102+t103+t104;
  t131 = 3456.0/77.0*xi;
  t137 = 2664.0/11.0*t14;
  t144 = 846.0/11.0*t43;
  t145 = 846.0/11.0*t45;
  t146 = 1692.0/11.0*t47;
  t147 = 846.0/11.0*t50;
  t148 = 270.0/11.0*t52;
  t149 = 270.0/11.0*t54;
  t150 = 540.0/11.0*t56;
  t151 = 540.0/11.0*t59;
  t152 = -846.0/11.0*t33-846.0/11.0*t38+1692.0/11.0*t41-t144-t145+t146+t147-t148-t149+t150+t151;
  t161 = 270.0/11.0*t33;
  t162 = 270.0/11.0*t38;
  t163 = 540.0/11.0*t41;
  t168 = 150.0/77.0-3600.0/77.0*eta-576.0/11.0*t8+1152.0/11.0*t10+1890.0/11.0*t2+918.0/11.0*t12-2754.0/11.0*t16-1560.0/11.0*t4-t161-t162+t163+306.0/11.0*t43+306.0/11.0*t45-612.0/11.0*t47-306.0/11.0*t50-t148-t149+t150+t151;
  t181 = -t161-t162+t163-t144-t145+t146+t147-846.0/11.0*t52-846.0/11.0*t54+1692.0/11.0*t56+1692.0/11.0*t59;
  t192 = 2520.0/11.0*t33;
  t193 = 2520.0/11.0*t38;
  t194 = 5040.0/11.0*t41;
  t195 = 2520.0/11.0*t52;
  t196 = 2520.0/11.0*t54;
  t197 = 5040.0/11.0*t56;
  t198 = 5040.0/11.0*t59;
  t199 = 120.0-5250.0/11.0*xi-14880.0/11.0*eta+12810.0/11.0*t8+25620.0/11.0*t10+41160.0/11.0*t2-13720.0/11.0*t12-6720.0/11.0*t14-41160.0/11.0*t16-30240.0/11.0*t4+t192+t193-t194-t195-t196+t197+t198;
  t200 = 2490.0/11.0*xi;
  t206 = 15120.0/11.0*t14;
  t209 = 5040.0/11.0*t43;
  t210 = 5040.0/11.0*t45;
  t211 = 10080.0/11.0*t47;
  t212 = 5040.0/11.0*t50;
  t213 = 320.0/11.0-t200-2880.0/11.0*eta-1470.0/11.0*t8+18900.0/11.0*t10+6720.0/11.0*t2+8680.0/11.0*t12-t206-21840.0/11.0*t16-4480.0/11.0*t4-t192-t193+t194-t209-t210+t211+t212;
  t221 = 120.0/11.0-t200+1920.0/11.0*eta+9450.0/11.0*t8-2940.0/11.0*t10-10920.0/11.0*t2-7280.0/11.0*t12-t206+26040.0/11.0*t16+10080.0/11.0*t4+t209+t210-t211-t212+t195+t196-t197-t198;
  t222 = 5670.0/11.0*xi;
  t228 = 14280.0/11.0*t14;
  t231 = 7560.0/11.0*t43;
  t232 = 7560.0/11.0*t45;
  t233 = 15120.0/11.0*t47;
  t234 = 7560.0/11.0*t50;
  t235 = 3780.0/11.0*t52;
  t236 = 3780.0/11.0*t54;
  t237 = 7560.0/11.0*t56;
  t238 = 7560.0/11.0*t59;
  t239 = -1140.0/11.0+t222+14760.0/11.0*eta-3150.0/11.0*t8-48300.0/11.0*t10-44100.0/11.0*t2-1680.0/11.0*t12+t228+80640.0/11.0*t16+33600.0/11.0*t4+t231+t232-t233-t234+t235+t236-t237-t238;
  t249 = 3780.0/11.0*t33;
  t250 = 3780.0/11.0*t38;
  t251 = 7560.0/11.0*t41;
  t252 = 60.0-3090.0/11.0*xi-10440.0/11.0*eta+11130.0/11.0*t8+22260.0/11.0*t10+34020.0/11.0*t2-15960.0/11.0*t12-840.0/11.0*t14-47880.0/11.0*t16-26880.0/11.0*t4+t249+t250-t251-t235-t236+t237+t238;
  t260 = -840.0/11.0+t222+7560.0/11.0*eta-24150.0/11.0*t8-6300.0/11.0*t10-17640.0/11.0*t2+26880.0/11.0*t12+t228-5040.0/11.0*t16+11760.0/11.0*t4-t249-t250+t251-t231-t232+t233+t234;

  values[0] = -20.0+t1-t3+t5;
  values[1] = -20.0+180.0*xi+t1-420.0*t8-840.0*t10-t3+280.0*t12+840.0*t14+840.0*t16+t5;
  values[2] = 0.0;
  values[3] = 250.0/11.0-t19-3000.0/11.0*eta-1050.0/11.0*t8+4452.0/11.0*t10+8610.0/11.0*t2+1022.0/11.0*t12+t25-9450.0/11.0*t16-6440.0/11.0*t4+t61;
  values[4] = t77;
  values[5] = 8.0/11.0+t19-420.0/11.0*eta-2226.0/11.0*t8+2100.0/11.0*t10+1302.0/11.0*t2+3150.0/11.0*t12-t25-3066.0/11.0*t16-1008.0/11.0*t4+t90;
  values[6] = t109;
  values[7] = t122;
  values[8] = t130;
  values[9] = 750.0/77.0-t131-9000.0/77.0*eta-1440.0/11.0*t8+5472.0/11.0*t10+3690.0/11.0*t2+3342.0/11.0*t12-t137-8010.0/11.0*t16-2760.0/11.0*t4+t152;
  values[10] = t168;
  values[11] = 486.0/77.0+t131-2160.0/11.0*eta-2736.0/11.0*t8+2880.0/11.0*t10+8082.0/11.0*t2+2670.0/11.0*t12+t137-10026.0/11.0*t16-6768.0/11.0*t4+t181;
  values[12] = t199;
  values[13] = t213;
  values[14] = t221;
  values[15] = t239;
  values[16] = t252;
  values[17] = t260;
}

// values of derivatives in xi-xi direction
static void N_T_P4_2D_DeriveXiXi(double xi, double eta, double *values)
{
  double t1, t3, t4, t5, t7, t13, t16, t18, t19, t20, t23, t24, t25, t27;
  double t28, t30, t33, t34, t35, t37, t38, t39, t40, t42, t43, t44, t45;
  double t46, t47, t48, t49, t50, t51, t52, t53, t54, t56, t58, t60, t66;
  double t67, t68, t69, t77, t78, t79, t80, t86, t90, t96, t97, t98, t99;
  double t100, t101, t102, t103, t104, t105, t106, t112, t113, t114, t115;
  double t116, t117, t118, t119, t124, t127, t134, t135, t136, t137, t138;
  double t139, t140, t141, t142, t143, t147, t153, t154, t155, t156, t164;
  double t165, t166, t167, t173, t177, t184, t185, t186, t187, t188, t189;
  double t190, t191, t192, t193, t194, t197, t200, t201, t202, t203, t204;
  double t205, t206, t211, t216, t217, t218, t219, t220, t221, t222, t223;
  double t224, t225, t226, t232, t233, t234, t235, t236, t237, t238, t239;
  double t244;

  t1 = 840.0*xi;
  t3 = xi*xi;
  t4 = 840.0*t3;
  t5 = xi*eta;
  t7 = eta*eta;
  t13 = 1176.0/11.0*t7;
  t16 = xi-eta;
  t18 = 2.0*eta-1.0+xi;
  t19 = t16*t18;
  t20 = t19*xi;
  t23 = 1.0-2.0*xi-eta;
  t24 = t23*t18;
  t25 = t24*xi;
  t27 = t23*t16;
  t28 = t27*xi;
  t30 = t27*t18;
  t33 = t18*xi*eta;
  t34 = 504.0/11.0*t33;
  t35 = 420.0/11.0-2604.0/11.0*xi-2100.0/11.0*eta+t13+6132.0/11.0*t5+3024.0/11.0*t3-1008.0/11.0*t20+504.0/11.0*t25+504.0/11.0*t28+252.0/11.0*t30-t34;
  t37 = t16*xi*eta;
  t38 = 504.0/11.0*t37;
  t39 = t19*eta;
  t40 = 504.0/11.0*t39;
  t42 = t23*xi*eta;
  t43 = 252.0/11.0*t42;
  t44 = t24*eta;
  t45 = 252.0/11.0*t44;
  t46 = t27*eta;
  t47 = 252.0/11.0*t46;
  t48 = t23*t7;
  t49 = 1260.0/11.0*t48;
  t50 = t16*t7;
  t51 = 2520.0/11.0*t50;
  t52 = t18*t7;
  t53 = 2520.0/11.0*t52;
  t54 = t23*t3;
  t56 = t16*t3;
  t58 = t18*t3;
  t60 = -t38-t40+t43+t45+t47+t49-t51-t53+252.0/11.0*t54-504.0/11.0*t56-504.0/11.0*t58;
  t66 = 5040.0/11.0*t20;
  t67 = 2520.0/11.0*t25;
  t68 = 2520.0/11.0*t28;
  t69 = 1260.0/11.0*t30;
  t77 = 1260.0/11.0*t54;
  t78 = 2520.0/11.0*t56;
  t79 = 2520.0/11.0*t58;
  t80 = -4536.0/11.0*t37-4536.0/11.0*t39+2268.0/11.0*t42+2268.0/11.0*t44+2268.0/11.0*t46+t49-t51-t53+t77-t78-t79;
  t86 = -17220.0/11.0*xi-4452.0/11.0*eta-t13+18900.0/11.0*t5+19320.0/11.0*t3-t66+t67+t68+t69-t34-t38;
  t90 = 3000.0/11.0-t40+t43+t45+t47+252.0/11.0*t48-504.0/11.0*t50-504.0/11.0*t52+t77-t78-t79;
  t96 = 672.0/11.0*t7;
  t97 = 4032.0/11.0*t33;
  t98 = 4032.0/11.0*t37;
  t99 = 4032.0/11.0*t39;
  t100 = 2016.0/11.0*t42;
  t101 = 2016.0/11.0*t44;
  t102 = 2016.0/11.0*t46;
  t103 = 2016.0/11.0*t52;
  t104 = 2016.0/11.0*t50;
  t105 = 1008.0/11.0*t48;
  t106 = -444.0/11.0+2688.0/11.0*xi+1932.0/11.0*eta-2688.0/11.0*t3-8736.0/11.0*t5+t96+t97+t98+t99-t100-t101-t102+t103+t104-t105;
  t112 = 4032.0/11.0*t20;
  t113 = 2016.0/11.0*t25;
  t114 = 2016.0/11.0*t28;
  t115 = 1008.0/11.0*t30;
  t116 = 1008.0/11.0*t54;
  t117 = 2016.0/11.0*t56;
  t118 = 2016.0/11.0*t58;
  t119 = 7224.0/11.0*xi+1428.0/11.0*eta+504.0/11.0*t7-9072.0/11.0*t5-8904.0/11.0*t3+t112-t113-t114-t115-996.0/11.0+t105-t104-t103-t116+t117+t118;
  t124 = -13608.0/11.0*xi-6132.0/11.0*eta+t96+21504.0/11.0*t5+15288.0/11.0*t3-t112+t113+t114+t115-t97-t98-t99+t100+t101+t102+2364.0/11.0+t116-t117-t118;
  t127 = 2664.0/11.0*t7;
  t134 = 3384.0/11.0*t33;
  t135 = 3384.0/11.0*t37;
  t136 = -16164.0/11.0*xi-2880.0/11.0*eta-t127+20052.0/11.0*t5+20304.0/11.0*t3-6768.0/11.0*t20+3384.0/11.0*t25+3384.0/11.0*t28+1692.0/11.0*t30-t134-t135;
  t137 = 3384.0/11.0*t39;
  t138 = 1692.0/11.0*t42;
  t139 = 1692.0/11.0*t44;
  t140 = 1692.0/11.0*t46;
  t141 = 540.0/11.0*t48;
  t142 = 1080.0/11.0*t50;
  t143 = 1080.0/11.0*t52;
  t147 = 2160.0/11.0-t137+t138+t139+t140+t141-t142-t143+1692.0/11.0*t54-3384.0/11.0*t56-3384.0/11.0*t58;
  t153 = 2160.0/11.0*t20;
  t154 = 1080.0/11.0*t25;
  t155 = 1080.0/11.0*t28;
  t156 = 540.0/11.0*t30;
  t164 = 540.0/11.0*t54;
  t165 = 1080.0/11.0*t56;
  t166 = 1080.0/11.0*t58;
  t167 = 3600.0/77.0+1224.0/11.0*t39-612.0/11.0*t42-612.0/11.0*t44-612.0/11.0*t46+t141-t142-t143+t164-t165-t166;
  t173 = -7380.0/11.0*xi-5472.0/11.0*eta+t127+16020.0/11.0*t5+8280.0/11.0*t3-t153+t154+t155+t156-t134-t135;
  t177 = 9000.0/77.0-t137+t138+t139+t140+1692.0/11.0*t48-3384.0/11.0*t50-3384.0/11.0*t52+t164-t165-t166;
  t184 = 20160.0/11.0*t20;
  t185 = 10080.0/11.0*t25;
  t186 = 10080.0/11.0*t28;
  t187 = 5040.0/11.0*t30;
  t188 = 5040.0/11.0*t48;
  t189 = 10080.0/11.0*t50;
  t190 = 10080.0/11.0*t52;
  t191 = 5040.0/11.0*t54;
  t192 = 10080.0/11.0*t56;
  t193 = 10080.0/11.0*t58;
  t194 = 82320.0/11.0*xi+25620.0/11.0*eta-6720.0/11.0*t7-82320.0/11.0*t5-90720.0/11.0*t3+t184-t185-t186-t187-14880.0/11.0+t188-t189-t190-t191+t192+t193
;
  t197 = 15120.0/11.0*t7;
  t200 = 20160.0/11.0*t33;
  t201 = 20160.0/11.0*t37;
  t202 = 20160.0/11.0*t39;
  t203 = 10080.0/11.0*t42;
  t204 = 10080.0/11.0*t44;
  t205 = 10080.0/11.0*t46;
  t206 = -21840.0/11.0*xi-2940.0/11.0*eta-t197+52080.0/11.0*t5+30240.0/11.0*t3-t184+t185+t186+t187-t200-t201-t202+t203+t204+t205+1920.0/11.0+t191-t192-t193;
  t211 = -2880.0/11.0+13440.0/11.0*xi+18900.0/11.0*eta-13440.0/11.0*t3-43680.0/11.0*t5-t197+t200+t201+t202-t203-t204-t205+t190+t189-t188;
  t216 = 14280.0/11.0*t7;
  t217 = 30240.0/11.0*t33;
  t218 = 30240.0/11.0*t37;
  t219 = 30240.0/11.0*t39;
  t220 = 15120.0/11.0*t42;
  t221 = 15120.0/11.0*t44;
  t222 = 15120.0/11.0*t46;
  t223 = 15120.0/11.0*t52;
  t224 = 15120.0/11.0*t50;
  t225 = 7560.0/11.0*t48;
  t226 = 7560.0/11.0-35280.0/11.0*xi-6300.0/11.0*eta+35280.0/11.0*t3-10080.0/11.0*t5+t216+t217+t218+t219-t220-t221-t222+t223+t224-t225;
  t232 = 30240.0/11.0*t20;
  t233 = 15120.0/11.0*t25;
  t234 = 15120.0/11.0*t28;
  t235 = 7560.0/11.0*t30;
  t236 = 7560.0/11.0*t54;
  t237 = 15120.0/11.0*t56;
  t238 = 15120.0/11.0*t58;
  t239 = 68040.0/11.0*xi+22260.0/11.0*eta-840.0/11.0*t7-95760.0/11.0*t5-80640.0/11.0*t3+t232-t233-t234-t235-10440.0/11.0+t225-t224-t223-t236+t237+t238;
  t244 = -88200.0/11.0*xi-48300.0/11.0*eta+t216+161280.0/11.0*t5+100800.0/11.0*t3-t232+t233+t234+t235-t217-t218-t219+t220+t221+t222+14760.0/11.0+t236-t237-t238;

  values[0] = 0.0;
  values[1] = 180.0-t1-840.0*eta+t4+1680.0*t5+840.0*t7;
  values[2] = 180.0-t1+t4;
  values[3] = t35+t60;
  values[4] = 1200.0/11.0-8820.0/11.0*xi-3612.0/11.0*eta+16548.0/11.0*t5+10920.0/11.0*t3-t66+t67+t68+t69-4536.0/11.0*t33+t80;
  values[5] = t86+t90;
  values[6] = t106;
  values[7] = t119;
  values[8] = t124;
  values[9] = t136+t147;
  values[10] = -3780.0/11.0*xi-1152.0/11.0*eta+5508.0/11.0*t5+4680.0/11.0*t3-t153+t154+t155+t156+1224.0/11.0*t33+1224.0/11.0*t37+t167;
  values[11] = t173+t177;
  values[12] = t194;
  values[13] = t206;
  values[14] = t211;
  values[15] = t226;
  values[16] = t239;
  values[17] = t244;
}

// values of derivatives in eta-eta direction
static void N_T_P4_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t3, t5, t7, t13, t15, t17, t18, t19, t22, t23, t24, t25, t26, t27;
  double t29, t30, t32, t33, t34, t36, t37, t38, t41, t42, t43, t45, t47;
  double t48, t49, t50, t51, t52, t53, t55, t57, t59, t72, t74, t75, t76;
  double t77, t85, t91, t96, t99, t101, t102, t103, t105, t107, t108, t109;
  double t110, t116, t117, t118, t122, t124, t133, t137, t140, t142, t143;
  double t144, t145, t147, t150, t151, t152, t156, t169, t171, t172, t173;
  double t174, t182, t188, t195, t196, t197, t199, t201, t202, t204, t205;
  double t207, t211, t213, t214, t215, t216, t217, t219, t221, t228, t229;
  double t230, t234, t236, t238, t239, t240, t242, t244, t245, t246, t247;
  double t253, t254, t255, t257, t259, t267;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t13 = 2352.0/11.0*t5;
  t15 = xi-eta;
  t17 = 2.0*eta-1.0+xi;
  t18 = t15*t17;
  t19 = t18*xi;
  t22 = 1.0-2.0*xi-eta;
  t23 = t22*t17;
  t24 = t23*xi;
  t25 = 126.0/11.0*t24;
  t26 = t22*t15;
  t27 = t26*xi;
  t29 = t26*t17;
  t30 = 126.0/11.0*t29;
  t32 = t17*xi*eta;
  t33 = 126.0/11.0*t32;
  t34 = -228.0/11.0-2100.0/11.0*xi+4452.0/11.0*eta-9450.0/11.0*t7+t13+3066.0/11.0*t3-504.0/11.0*t19-t25+630.0/11.0*t27+t30+t33;
  t36 = t15*xi*eta;
  t37 = 630.0/11.0*t36;
  t38 = t18*eta;
  t41 = t22*xi*eta;
  t42 = 126.0/11.0*t41;
  t43 = t23*eta;
  t45 = t26*eta;
  t47 = t22*t7;
  t48 = 630.0/11.0*t47;
  t49 = t15*t7;
  t50 = 3150.0/11.0*t49;
  t51 = t17*t7;
  t52 = 630.0/11.0*t51;
  t53 = t22*t3;
  t55 = t15*t3;
  t57 = t17*t3;
  t59 = -t37-2646.0/11.0*t38+t42+1134.0/11.0*t43+1512.0/11.0*t45+t48-t50+t52+126.0/11.0*t53-630.0/11.0*t55+126.0/11.0*t57;
  t72 = 126.0/11.0*t43;
  t74 = 630.0/11.0*t53;
  t75 = 3150.0/11.0*t55;
  t76 = 630.0/11.0*t57;
  t77 = -3612.0/11.0*xi+3612.0/11.0*eta-8274.0/11.0*t7+8274.0/11.0*t3-3528.0/11.0*t19-t25+3654.0/11.0*t27+1134.0/11.0*t29+1134.0/11.0*t32-5670.0/11.0*t36-3654.0/11.0*t38+1134.0/11.0*t41+t72+3528.0/11.0*t45+t48-t50+t52+t74-t75+t76;
  t85 = 228.0/11.0-4452.0/11.0*xi+2100.0/11.0*eta-3066.0/11.0*t7-t13+9450.0/11.0*t3-1512.0/11.0*t19-1134.0/11.0*t24+2646.0/11.0*t27+t30+t33;
  t91 = -t37-630.0/11.0*t38+t42+t72+504.0/11.0*t45+126.0/11.0*t47-630.0/11.0*t49+126.0/11.0*t51+t74-t75+t76;
  t96 = 1344.0/11.0*t5;
  t99 = 1008.0/11.0*t24;
  t101 = 1008.0/11.0*t29;
  t102 = 1008.0/11.0*t32;
  t103 = 5040.0/11.0*t36;
  t105 = 1008.0/11.0*t41;
  t107 = 504.0/11.0*t47;
  t108 = 2520.0/11.0*t49;
  t109 = 504.0/11.0*t51;
  t110 = 1932.0/11.0*xi-6132.0/11.0*eta+10752.0/11.0*t7+t96-4368.0/11.0*t3+492.0/11.0+2016.0/11.0*t19-t99-1008.0/11.0*t27-t101-t102+t103+3024.0/11.0*t38-t105-3024.0/11.0*t45-t107+t108-t109;
  t116 = 504.0/11.0*t57;
  t117 = 2520.0/11.0*t55;
  t118 = 504.0/11.0*t53;
  t122 = 1008.0/11.0*t43;
  t124 = -60.0/11.0+1428.0/11.0*xi+1428.0/11.0*eta-4536.0/11.0*t3+1008.0/11.0*t5-4536.0/11.0*t7-t116+t117-t118+1008.0/11.0*t19+t99-2016.0/11.0*t27+t109-t108-2016.0/11.0*t38+t107+t122+1008.0/11.0*t45;
  t133 = -6132.0/11.0*xi+1932.0/11.0*eta-4368.0/11.0*t7+t96+10752.0/11.0*t3+492.0/11.0-3024.0/11.0*t19+3024.0/11.0*t27+t101+t102-t103-1008.0/11.0*t38+t105-t122+2016.0/11.0*t45+t118-t117+t116;
  t137 = 5328.0/11.0*t5;
  t140 = 846.0/11.0*t24;
  t142 = 846.0/11.0*t29;
  t143 = 846.0/11.0*t32;
  t144 = -3456.0/77.0-2880.0/11.0*xi+5472.0/11.0*eta-8010.0/11.0*t7-t137+10026.0/11.0*t3-3384.0/11.0*t19-t140+4230.0/11.0*t27+t142+t143;
  t145 = 4230.0/11.0*t36;
  t147 = 846.0/11.0*t41;
  t150 = 270.0/11.0*t47;
  t151 = 1350.0/11.0*t49;
  t152 = 270.0/11.0*t51;
  t156 = -t145-1926.0/11.0*t38+t147-306.0/11.0*t43+2232.0/11.0*t45+t150-t151+t152+846.0/11.0*t53-4230.0/11.0*t55+846.0/11.0*t57;
  t169 = 846.0/11.0*t43;
  t171 = 270.0/11.0*t53;
  t172 = 1350.0/11.0*t55;
  t173 = 270.0/11.0*t57;
  t174 = -1152.0/11.0*xi+1152.0/11.0*eta-2754.0/11.0*t7+2754.0/11.0*t3+72.0/11.0*t19-t140+774.0/11.0*t27-306.0/11.0*t29-306.0/11.0*t32+1530.0/11.0*t36-774.0/11.0*t38-306.0/11.0*t41+t169-72.0/11.0*t45+t150-t151+t152+t171-t172+t173
;
  t182 = 3456.0/77.0-5472.0/11.0*xi+2880.0/11.0*eta-10026.0/11.0*t7+t137+8010.0/11.0*t3-2232.0/11.0*t19+306.0/11.0*t24+1926.0/11.0*t27+t142+t143;
  t188 = -t145-4230.0/11.0*t38+t147+t169+3384.0/11.0*t45+846.0/11.0*t47-4230.0/11.0*t49+846.0/11.0*t51+t171-t172+t173;
  t195 = 2520.0/11.0*t57;
  t196 = 12600.0/11.0*t55;
  t197 = 2520.0/11.0*t53;
  t199 = 5040.0/11.0*t24;
  t201 = 2520.0/11.0*t51;
  t202 = 12600.0/11.0*t49;
  t204 = 2520.0/11.0*t47;
  t205 = 5040.0/11.0*t43;
  t207 = -5250.0/11.0+25620.0/11.0*xi+25620.0/11.0*eta-41160.0/11.0*t3-13440.0/11.0*t5-41160.0/11.0*t7-t195+t196-t197+5040.0/11.0*t19+t199-10080.0/11.0*t27+t201-t202-10080.0/11.0*t38+t204+t205+5040.0/11.0*t45;
  t211 = 30240.0/11.0*t5;
  t213 = 15120.0/11.0*t19;
  t214 = 15120.0/11.0*t27;
  t215 = 5040.0/11.0*t29;
  t216 = 5040.0/11.0*t32;
  t217 = 25200.0/11.0*t36;
  t219 = 5040.0/11.0*t41;
  t221 = -2940.0/11.0*xi+18900.0/11.0*eta-21840.0/11.0*t7-t211+26040.0/11.0*t3-2490.0/11.0-t213+t214+t215+t216-t217-5040.0/11.0*t38+t219-t205+10080.0/11.0*t45+t197-t196+t195;
  t228 = 15120.0/11.0*t38;
  t229 = 15120.0/11.0*t45;
  t230 = 18900.0/11.0*xi-2940.0/11.0*eta+26040.0/11.0*t7-t211-21840.0/11.0*t3-2490.0/11.0+10080.0/11.0*t19-t199-5040.0/11.0*t27-t215-t216+t217+t228-t219-t229-t204+t202-t201;
  t234 = 28560.0/11.0*t5;
  t236 = 7560.0/11.0*t24;
  t238 = 7560.0/11.0*t29;
  t239 = 7560.0/11.0*t32;
  t240 = 37800.0/11.0*t36;
  t242 = 7560.0/11.0*t41;
  t244 = 3780.0/11.0*t47;
  t245 = 18900.0/11.0*t49;
  t246 = 3780.0/11.0*t51;
  t247 = -6300.0/11.0*xi-48300.0/11.0*eta+80640.0/11.0*t7+t234-5040.0/11.0*t3+5670.0/11.0+t213-t236-7560.0/11.0*t27-t238-t239+t240+22680.0/11.0*t38-t242-22680.0/11.0*t45-t244+t245-t246;
  t253 = 3780.0/11.0*t57;
  t254 = 18900.0/11.0*t55;
  t255 = 3780.0/11.0*t53;
  t257 = 7560.0/11.0*t43;
  t259 = -3090.0/11.0+22260.0/11.0*xi+22260.0/11.0*eta-47880.0/11.0*t3-1680.0/11.0*t5-47880.0/11.0*t7-t253+t254-t255+7560.0/11.0*t19+t236-t214+t246-t245-t228+t244+t257+7560.0/11.0*t45;
  t267 = -48300.0/11.0*xi-6300.0/11.0*eta-5040.0/11.0*t7+t234+80640.0/11.0*t3+5670.0/11.0-22680.0/11.0*t19+22680.0/11.0*t27+t238+t239-t240-7560.0/11.0*t38+t242-t257+t229+t255-t254+t253;

  values[0] = 0.0;
  values[1] = 180.0-840.0*xi-840.0*eta+840.0*t3+1680.0*t5+840.0*t7;
  values[2] = 0.0;
  values[3] = t34+t59;
  values[4] = t77;
  values[5] = t85+t91;
  values[6] = t110;
  values[7] = t124;
  values[8] = t133;
  values[9] = t144+t156;
  values[10] = t174;
  values[11] = t182+t188;
  values[12] = t207;
  values[13] = t221;
  values[14] = t230;
  values[15] = t247;
  values[16] = t259;
  values[17] = t267;
}

// values of derivatives in xi-eta direction
static void N_T_P4_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double t1, t2, t3, t6, t8, t15, t16, t18, t19, t20, t21, t23, t24, t25;
  double t26, t27, t28, t29, t30, t31, t33, t34, t36, t37, t38, t39, t40;
  double t42, t43, t44, t45, t46, t47, t48, t49, t50, t51, t52, t53, t54;
  double t56, t58, t60, t73, t74, t75, t76, t83, t90, t96, t97, t98, t99;
  double t100, t101, t102, t103, t104, t105, t106, t107, t108, t109, t110;
  double t116, t117, t118, t119, t124, t129, t130, t131, t132, t133, t134;
  double t135, t136, t137, t138, t139, t140, t141, t142, t143, t147, t160;
  double t161, t162, t163, t170, t177, t184, t185, t186, t187, t188, t189;
  double t190, t191, t192, t193, t194, t197, t200, t201, t202, t203, t204;
  double t205, t206, t211, t216, t217, t218, t219, t220, t221, t222, t223;
  double t224, t225, t226, t227, t228, t229, t230, t236, t237, t238, t239;
  double t244;

  t1 = 840.0*eta;
  t2 = eta*eta;
  t3 = 840.0*t2;
  t6 = xi*xi;
  t8 = xi*eta;
  t15 = 1176.0/11.0*t6;
  t16 = xi-eta;
  t18 = 2.0*eta-1.0+xi;
  t19 = t16*t18;
  t20 = t19*xi;
  t21 = 252.0/11.0*t20;
  t23 = 1.0-2.0*xi-eta;
  t24 = t23*t18;
  t25 = t24*xi;
  t26 = 252.0/11.0*t25;
  t27 = t23*t16;
  t28 = t27*xi;
  t29 = 504.0/11.0*t28;
  t30 = t27*t18;
  t31 = 1260.0/11.0*t30;
  t33 = t18*xi*eta;
  t34 = 252.0/11.0*t33;
  t36 = t16*xi*eta;
  t37 = 504.0/11.0*t36;
  t38 = 4452.0/11.0*xi+17220.0/11.0*eta-19320.0/11.0*t2-18900.0/11.0*t8+t15-t21-t26+t29+t31+t34-t37;
  t39 = t19*eta;
  t40 = 2520.0/11.0*t39;
  t42 = t23*xi*eta;
  t43 = 504.0/11.0*t42;
  t44 = t24*eta;
  t45 = 2520.0/11.0*t44;
  t46 = t27*eta;
  t47 = 5040.0/11.0*t46;
  t48 = t23*t2;
  t49 = 2520.0/11.0*t48;
  t50 = t16*t2;
  t51 = 2520.0/11.0*t50;
  t52 = t18*t2;
  t53 = 1260.0/11.0*t52;
  t54 = t23*t6;
  t56 = t16*t6;
  t58 = t18*t6;
  t60 = -3000.0/11.0-t40-t43-t45+t47-t49-t51+t53-504.0/11.0*t54-504.0/11.0*t56+252.0/11.0*t58;
  t73 = 2520.0/11.0*t54;
  t74 = 2520.0/11.0*t56;
  t75 = 1260.0/11.0*t58;
  t76 = -1200.0/11.0-t40-4536.0/11.0*t42-t45+t47-t49-t51+t53-t73-t74+t75;
  t83 = -420.0/11.0+2100.0/11.0*xi+2604.0/11.0*eta-3024.0/11.0*t2-6132.0/11.0*t8-t15-t21-t26+t29+252.0/11.0*t30+t34;
  t90 = -t37-504.0/11.0*t39-t43-504.0/11.0*t44+1008.0/11.0*t46-504.0/11.0*t48-504.0/11.0*t50+252.0/11.0*t52-t73-t74+t75;
  t96 = 672.0/11.0*t6;
  t97 = 2016.0/11.0*t20;
  t98 = 2016.0/11.0*t25;
  t99 = 4032.0/11.0*t28;
  t100 = 1008.0/11.0*t30;
  t101 = 2016.0/11.0*t33;
  t102 = 4032.0/11.0*t36;
  t103 = 2016.0/11.0*t39;
  t104 = 4032.0/11.0*t42;
  t105 = 2016.0/11.0*t44;
  t106 = 4032.0/11.0*t46;
  t107 = 2016.0/11.0*t48;
  t108 = 2016.0/11.0*t50;
  t109 = 1008.0/11.0*t52;
  t110 = -6132.0/11.0*xi-13608.0/11.0*eta+15288.0/11.0*t2+21504.0/11.0*t8+t96+t97+t98-t99-t100-t101+t102+t103+t104+t105-t106+2364.0/11.0+t107+t108-t109;
  t116 = 2016.0/11.0*t54;
  t117 = 2016.0/11.0*t56;
  t118 = 1008.0/11.0*t58;
  t119 = 1428.0/11.0*xi+7224.0/11.0*eta-8904.0/11.0*t2-9072.0/11.0*t8+504.0/11.0*t6+t100-t103-t105+t106-996.0/11.0-t107-t108+t109+t116+t117-t118;
  t124 = -444.0/11.0+1932.0/11.0*xi+2688.0/11.0*eta+t96-8736.0/11.0*t8-2688.0/11.0*t2+t118-t117-t116+t101-t102-t97-t104-t98+t99;
  t129 = 2664.0/11.0*t6;
  t130 = 1692.0/11.0*t20;
  t131 = 1692.0/11.0*t25;
  t132 = 3384.0/11.0*t28;
  t133 = 540.0/11.0*t30;
  t134 = 1692.0/11.0*t33;
  t135 = 3384.0/11.0*t36;
  t136 = 5472.0/11.0*xi+7380.0/11.0*eta-8280.0/11.0*t2-16020.0/11.0*t8-t129-t130-t131+t132+t133+t134-t135;
  t137 = 1080.0/11.0*t39;
  t138 = 3384.0/11.0*t42;
  t139 = 1080.0/11.0*t44;
  t140 = 2160.0/11.0*t46;
  t141 = 1080.0/11.0*t48;
  t142 = 1080.0/11.0*t50;
  t143 = 540.0/11.0*t52;
  t147 = -9000.0/77.0-t137-t138-t139+t140-t141-t142+t143-3384.0/11.0*t54-3384.0/11.0*t56+1692.0/11.0*t58;
  t160 = 1080.0/11.0*t54;
  t161 = 1080.0/11.0*t56;
  t162 = 540.0/11.0*t58;
  t163 = -3600.0/77.0-t137+1224.0/11.0*t42-t139+t140-t141-t142+t143-t160-t161+t162;
  t170 = -2160.0/11.0+2880.0/11.0*xi+16164.0/11.0*eta-20304.0/11.0*t2-20052.0/11.0*t8+t129-t130-t131+t132+1692.0/11.0*t30+t134;
  t177 = -t135-3384.0/11.0*t39-t138-3384.0/11.0*t44+6768.0/11.0*t46-3384.0/11.0*t48-3384.0/11.0*t50+1692.0/11.0*t52-t160-t161+t162;
  t184 = 5040.0/11.0*t30;
  t185 = 10080.0/11.0*t39;
  t186 = 10080.0/11.0*t44;
  t187 = 20160.0/11.0*t46;
  t188 = 10080.0/11.0*t48;
  t189 = 10080.0/11.0*t50;
  t190 = 5040.0/11.0*t52;
  t191 = 10080.0/11.0*t54;
  t192 = 10080.0/11.0*t56;
  t193 = 5040.0/11.0*t58;
  t194 = 25620.0/11.0*xi+82320.0/11.0*eta-90720.0/11.0*t2-82320.0/11.0*t8-6720.0/11.0*t6+t184-t185-t186+t187-14880.0/11.0-t188-t189+t190+t191+t192-t193;
  t197 = 15120.0/11.0*t6;
  t200 = 10080.0/11.0*t33;
  t201 = 20160.0/11.0*t36;
  t202 = 10080.0/11.0*t20;
  t203 = 20160.0/11.0*t42;
  t204 = 10080.0/11.0*t25;
  t205 = 20160.0/11.0*t28;
  t206 = -2880.0/11.0+18900.0/11.0*xi+13440.0/11.0*eta-t197-43680.0/11.0*t8-13440.0/11.0*t2+t193-t192-t191+t200-t201-t202-t203-t204+t205;
  t211 = -2940.0/11.0*xi-21840.0/11.0*eta+30240.0/11.0*t2+52080.0/11.0*t8-t197+t202+t204-t205-t184-t200+t201+t185+t203+t186-t187+1920.0/11.0+t188+t189-t190;
  t216 = 14280.0/11.0*t6;
  t217 = 15120.0/11.0*t20;
  t218 = 15120.0/11.0*t25;
  t219 = 30240.0/11.0*t28;
  t220 = 7560.0/11.0*t30;
  t221 = 15120.0/11.0*t33;
  t222 = 30240.0/11.0*t36;
  t223 = 15120.0/11.0*t39;
  t224 = 30240.0/11.0*t42;
  t225 = 15120.0/11.0*t44;
  t226 = 30240.0/11.0*t46;
  t227 = 15120.0/11.0*t48;
  t228 = 15120.0/11.0*t50;
  t229 = 7560.0/11.0*t52;
  t230 = -48300.0/11.0*xi-88200.0/11.0*eta+100800.0/11.0*t2+161280.0/11.0*t8+t216+t217+t218-t219-t220-t221+t222+t223+t224+t225-t226+14760.0/11.0+t227+t228-t229;
  t236 = 15120.0/11.0*t54;
  t237 = 15120.0/11.0*t56;
  t238 = 7560.0/11.0*t58;
  t239 = 22260.0/11.0*xi+68040.0/11.0*eta-80640.0/11.0*t2-95760.0/11.0*t8-840.0/11.0*t6+t220-t223-t225+t226-10440.0/11.0-t227-t228+t229+t236+t237-t238;
  t244 = 7560.0/11.0-6300.0/11.0*xi-35280.0/11.0*eta+t216-10080.0/11.0*t8+35280.0/11.0*t2+t238-t237-t236+t221-t222-t217-t224-t218+t219;

  values[0] = 180.0-t1+t3;
  values[1] = 180.0-840.0*xi-t1+840.0*t6+1680.0*t8+t3;
  values[2] = 0.0;
  values[3] = t38+t60;
  values[4] = 3612.0/11.0*xi+8820.0/11.0*eta-10920.0/11.0*t2-16548.0/11.0*t8-2268.0/11.0*t20-2268.0/11.0*t25+4536.0/11.0*t28+t31+2268.0/11.0*t33-4536.0/11.0*t36+t76;
  values[5] = t83+t90;
  values[6] = t110;
  values[7] = t119;
  values[8] = t124;
  values[9] = t136+t147;
  values[10] = 1152.0/11.0*xi+3780.0/11.0*eta-4680.0/11.0*t2-5508.0/11.0*t8+612.0/11.0*t20+612.0/11.0*t25-1224.0/11.0*t28+t133-612.0/11.0*t33+1224.0/11.0*t36+t163;
  values[11] = t170+t177;
  values[12] = t194;
  values[13] = t206;
  values[14] = t211;
  values[15] = t230;
  values[16] = t239;
  values[17] = t244;
}

static int N_T_P4_2D_ChangeJ0[2] = { 3,  9 };
static int N_T_P4_2D_ChangeJ1[2] = { 4, 10 };
static int N_T_P4_2D_ChangeJ2[2] = { 5, 11 };

static int *N_T_P4_2D_Change[3] = { N_T_P4_2D_ChangeJ0, N_T_P4_2D_ChangeJ1,
                                    N_T_P4_2D_ChangeJ2 };

// ***********************************************************************

TBaseFunct2D *BF_N_T_P4_2D_Obj = new TBaseFunct2D
        (18, BF_N_T_P4_2D, BFUnitTriangle, 
         N_T_P4_2D_Funct, N_T_P4_2D_DeriveXi,
         N_T_P4_2D_DeriveEta, N_T_P4_2D_DeriveXiXi,
         N_T_P4_2D_DeriveXiEta, N_T_P4_2D_DeriveEtaEta, 5, 4,
         2, N_T_P4_2D_Change);
