/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// p4 element, conforming with bubbles, 2D
// ***********************************************************************

// base function values
static void C_T_B4_2D_Funct(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t11, t13, t15, t17, t18, t19, t21, t23, t25, t26;
  double t27, t29, t30, t32, t35, t36, t37, t40, t44, t46, t48, t49, t50;
  double t51, t54, t60, t63, t64, t65, t68, t73, t75, t76, t77, t79, t84;
  double t86, t88, t89, t93, t95, t96, t104, t111, t120, t128, t129, t130;
  double t140, t148, t155, t157, t159, t163, t164, t166, t168, t172, t176;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t17 = t3*t3;
  t18 = 32.0/3.0*t17;
  t19 = t9*eta;
  t21 = t3*t7;
  t23 = xi*t15;
  t25 = t7*t7;
  t26 = 32.0/3.0*t25;
  t27 = 1.0-xi-eta;
  t29 = t27*t9*eta;
  t30 = 265.0/6.0*t29;
  t32 = t27*t3*t7;
  t35 = t27*xi*t15;
  t36 = 265.0/6.0*t35;
  t37 = 1.0-25.0/3.0*xi-25.0/3.0*eta+70.0/3.0*t3+3761.0/60.0*t5+70.0/3.0*t7-80.0/3.0*t9-4493.0/30.0*t11-4493.0/30.0*t13-80.0/3.0*t15+t18+1157.0/12.0*t19+343.0/2.0*t21+1157.0/12.0*t23+t26+t30+335.0/4.0*t32+t36;
  t40 = 696.0/5.0*t5;
  t44 = 128.0/3.0*t17;
  t46 = 1744.0/3.0*t21;
  t48 = 640.0/3.0*t29;
  t49 = 1040.0/3.0*t32;
  t50 = 440.0/3.0*t35;
  t51 = 16.0*xi-208.0/3.0*t3-t40+96.0*t9+7688.0/15.0*t11+5528.0/15.0*t13-t44-1136.0/3.0*t19-t46-736.0/3.0*t23-t48-t49-t50;
  t54 = 1382.0/15.0*t5;
  t60 = 492.0*t21;
  t63 = 320.0*t32;
  t64 = 110.0/3.0*t35;
  t65 = -12.0*xi+76.0*t3+t54-128.0*t9-7922.0/15.0*t11-2822.0/15.0*t13+64.0*t17+448.0*t19+t60+108.0*t23+320.0*t29+t63+t64;
  t68 = 568.0/15.0*t5;
  t73 = 208.0*t21;
  t75 = 80.0*t32;
  t76 = 40.0/3.0*t35;
  t77 = 16.0/3.0*xi-112.0/3.0*t3-t68+224.0/3.0*t9+3608.0/15.0*t11+968.0/15.0*t13-t44-656.0/3.0*t19-t73-32.0*t23-t48-t75-t76;
  t79 = 193.0/30.0*t5;
  t84 = 235.0/6.0*t21;
  t86 = 55.0/12.0*t32;
  t88 = -xi+22.0/3.0*t3+t79-16.0*t9-2461.0/60.0*t11-661.0/60.0*t13+t18+415.0/12.0*t19+t84+55.0/12.0*t23+t30+t86+55.0/12.0*t35;
  t89 = 128.0/15.0*t5;
  t93 = 256.0/3.0*t21;
  t95 = 440.0/3.0*t29;
  t96 = 160.0/3.0*t32;
  t104 = 110.0/3.0*t29;
  t111 = 40.0/3.0*t29;
  t120 = -eta+t79+22.0/3.0*t7-661.0/60.0*t11-2461.0/60.0*t13-16.0*t15+55.0/12.0*t19+t84+415.0/12.0*t23+t26+55.0/12.0*t29+t86+t36;
  t128 = 128.0/3.0*t25;
  t129 = 640.0/3.0*t35;
  t130 = 16.0/3.0*eta-t68-112.0/3.0*t7+968.0/15.0*t11+3608.0/15.0*t13+224.0/3.0*t15-32.0*t19-t73-656.0/3.0*t23-t128-t111-t75-t129;
  t140 = -12.0*eta+t54+76.0*t7-2822.0/15.0*t11-7922.0/15.0*t13-128.0*t15+108.0*t19+t60+448.0*t23+64.0*t25+t104+t63+320.0*t35;
  t148 = 16.0*eta-t40-208.0/3.0*t7+5528.0/15.0*t11+7688.0/15.0*t13+96.0*t15-736.0/3.0*t19-t46-1136.0/3.0*t23-t128-t95-t49-t129;
  t155 = 3125.0/6.0*t29;
  t157 = 3125.0/6.0*t35;
  t159 = 125.0*t5;
  t163 = 1875.0/2.0*t21;
  t164 = 625.0/4.0*t23;
  t166 = 3125.0/4.0*t32;
  t168 = 125.0/3.0*t5;
  t172 = 625.0/2.0*t21;
  t176 = 625.0/4.0*t19;

  values[0] = t37;
  values[1] = t51;
  values[2] = t65;
  values[3] = t77;
  values[4] = t88;
  values[5] = -t89+1088.0/15.0*t11+128.0/15.0*t13-48.0*t19-t93+16.0/3.0*t23-t95+t96-t76;
  values[6] = -16.0/5.0*t5+388.0/15.0*t11+388.0/15.0*t13-104.0/3.0*t19-16.0/3.0*t21-104.0/3.0*t23+t104-740.0/3.0*t32+t64;
  values[7] = -t89+128.0/15.0*t11+1088.0/15.0*t13+16.0/3.0*t19-t93-48.0*t23-t111+t96-t50;
  values[8] = t120;
  values[9] = t130;
  values[10] = t140;
  values[11] = t148;
  values[12] = 250.0*t5-5875.0/6.0*t11-5875.0/6.0*t13+4375.0/6.0*t19+4375.0/3.0*t21+4375.0/6.0*t23+t155+3125.0/3.0*t32+t157;
  values[13] = -t159+3625.0/4.0*t11+1125.0/4.0*t13-3125.0/4.0*t19-t163-t164-3125.0/4.0*t29-t166;
  values[14] = t168-2125.0/6.0*t11-125.0/3.0*t13+625.0/2.0*t19+t172+t155;
  values[15] = -t159+1125.0/4.0*t11+3625.0/4.0*t13-t176-t163-3125.0/4.0*t23-t166-3125.0/4.0*t35;
  values[16] = 125.0/4.0*t5-375.0/2.0*t11-375.0/2.0*t13+t176+t172+t164+t166;
  values[17] = t168-125.0/3.0*t11-2125.0/6.0*t13+t172+625.0/2.0*t23+t157;
}

// values of the derivatives in xi direction
static void C_T_B4_2D_DeriveXi(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t10, t11, t13, t15, t17, t18, t19, t21, t22, t23;
  double t26, t28, t29, t30, t31, t32, t34, t38, t40, t42, t43, t44, t45;
  double t46, t47, t48, t50, t56, t60, t61, t62, t63, t64, t66, t71, t73;
  double t74, t75, t76, t77, t79, t84, t86, t87, t90, t91, t95, t97, t98;
  double t99, t100, t101, t108, t109, t112, t117, t118, t119, t126, t131;
  double t132, t133, t140, t145, t152, t153, t156, t157, t158, t159, t163;
  double t164, t167, t168, t170, t174, t178;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t10 = 128.0/3.0*t9;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t17 = t9*eta;
  t18 = 265.0/6.0*t17;
  t19 = 1.0-xi-eta;
  t21 = t19*t3*eta;
  t22 = 265.0/2.0*t21;
  t23 = t3*t7;
  t26 = t19*xi*t7;
  t28 = xi*t15;
  t29 = 265.0/6.0*t28;
  t30 = t19*t15;
  t31 = 265.0/6.0*t30;
  t32 = -25.0/3.0+140.0/3.0*xi+3761.0/60.0*eta-80.0*t3-4493.0/15.0*t5-4493.0/30.0*t7+t10+1157.0/4.0*t11+343.0*t13+1157.0/12.0*t15-t18+t22-335.0/4.0*t23+335.0/2.0*t26-t29+t31;
  t34 = 696.0/5.0*eta;
  t38 = 512.0/3.0*t9;
  t40 = 3488.0/3.0*t13;
  t42 = 640.0/3.0*t17;
  t43 = 640.0*t21;
  t44 = 1040.0/3.0*t23;
  t45 = 2080.0/3.0*t26;
  t46 = 440.0/3.0*t28;
  t47 = 440.0/3.0*t30;
  t48 = 16.0-416.0/3.0*xi-t34+288.0*t3+15376.0/15.0*t5+5528.0/15.0*t7-t38-1136.0*t11-t40-736.0/3.0*t15+t42-t43+t44-t45+t46-t47;
  t50 = 1382.0/15.0*eta;
  t56 = 984.0*t13;
  t60 = 320.0*t23;
  t61 = 640.0*t26;
  t62 = 110.0/3.0*t28;
  t63 = 110.0/3.0*t30;
  t64 = -12.0+152.0*xi+t50-384.0*t3-15844.0/15.0*t5-2822.0/15.0*t7+256.0*t9+1344.0*t11+t56+108.0*t15-320.0*t17+960.0*t21-t60+t61-t62+t63;
  t66 = 568.0/15.0*eta;
  t71 = 416.0*t13;
  t73 = 80.0*t23;
  t74 = 160.0*t26;
  t75 = 40.0/3.0*t28;
  t76 = 40.0/3.0*t30;
  t77 = 16.0/3.0-224.0/3.0*xi-t66+224.0*t3+7216.0/15.0*t5+968.0/15.0*t7-t38-656.0*t11-t71-32.0*t15+t42-t43+t73-t74+t75-t76;
  t79 = 193.0/30.0*eta;
  t84 = 235.0/3.0*t13;
  t86 = 55.0/12.0*t23;
  t87 = 55.0/6.0*t26;
  t90 = -1.0+44.0/3.0*xi+t79-48.0*t3-2461.0/30.0*t5-661.0/60.0*t7+t10+415.0/4.0*t11+t84+55.0/12.0*t15-t18+t22-t86+t87-55.0/12.0*t28+55.0/12.0*t30;
  t91 = 128.0/15.0*eta;
  t95 = 512.0/3.0*t13;
  t97 = 440.0/3.0*t17;
  t98 = 440.0*t21;
  t99 = 160.0/3.0*t23;
  t100 = 320.0/3.0*t26;
  t101 = -t91+2176.0/15.0*t5+128.0/15.0*t7-144.0*t11-t95+16.0/3.0*t15+t97-t98-t99+t100+t75-t76;
  t108 = 110.0/3.0*t17;
  t109 = 110.0*t21;
  t112 = -16.0/5.0*eta+776.0/15.0*t5+388.0/15.0*t7-104.0*t11-32.0/3.0*t13-104.0/3.0*t15-t108+t109+740.0/3.0*t23-1480.0/3.0*t26-t62+t63;
  t117 = 40.0/3.0*t17;
  t118 = 40.0*t21;
  t119 = -t91+256.0/15.0*t5+1088.0/15.0*t7+16.0*t11-t95-48.0*t15+t117-t118-t99+t100+t46-t47;
  t126 = t79-661.0/30.0*t5-2461.0/60.0*t7+55.0/4.0*t11+t84+415.0/12.0*t15-55.0/12.0*t17+55.0/4.0*t21-t86+t87-t29+t31;
  t131 = 640.0/3.0*t28;
  t132 = 640.0/3.0*t30;
  t133 = -t66+1936.0/15.0*t5+3608.0/15.0*t7-96.0*t11-t71-656.0/3.0*t15+t117-t118+t73-t74+t131-t132;
  t140 = t50-5644.0/15.0*t5-7922.0/15.0*t7+324.0*t11+t56+448.0*t15-t108+t109-t60+t61-320.0*t28+320.0*t30;
  t145 = -t34+11056.0/15.0*t5+7688.0/15.0*t7-736.0*t11-t40-1136.0/3.0*t15+t97-t98+t44-t45+t131-t132;
  t152 = 3125.0/6.0*t17;
  t153 = 3125.0/2.0*t21;
  t156 = 3125.0/6.0*t28;
  t157 = 3125.0/6.0*t30;
  t158 = 250.0*eta-5875.0/3.0*t5-5875.0/6.0*t7+4375.0/2.0*t11+8750.0/3.0*t13+4375.0/6.0*t15-t152+t153-3125.0/3.0*t23+6250.0/3.0*t26-t156+t157;
  t159 = 125.0*eta;
  t163 = 1875.0*t13;
  t164 = 625.0/4.0*t15;
  t167 = 3125.0/4.0*t23;
  t168 = 3125.0/2.0*t26;
  t170 = 125.0/3.0*eta;
  t174 = 625.0*t13;
  t178 = 1875.0/4.0*t11;

  values[0] = t32;
  values[1] = t48;
  values[2] = t64;
  values[3] = t77;
  values[4] = t90;
  values[5] = t101;
  values[6] = t112;
  values[7] = t119;
  values[8] = t126;
  values[9] = t133;
  values[10] = t140;
  values[11] = t145;
  values[12] = t158;
  values[13] = -t159+3625.0/2.0*t5+1125.0/4.0*t7-9375.0/4.0*t11-t163-t164+3125.0/4.0*t17-9375.0/4.0*t21+t167-t168;
  values[14] = t170-2125.0/3.0*t5-125.0/3.0*t7+1875.0/2.0*t11+t174-t152+t153;
  values[15] = -t159+1125.0/2.0*t5+3625.0/4.0*t7-t178-t163-3125.0/4.0*t15+t167-t168+3125.0/4.0*t28-3125.0/4.0*t30;
  values[16] = 125.0/4.0*eta-375.0*t5-375.0/2.0*t7+t178+t174+t164-t167+t168;
  values[17] = t170-250.0/3.0*t5-2125.0/6.0*t7+t174+625.0/2.0*t15-t156+t157;
}

// values of the derivatives in eta direction
static void C_T_B4_2D_DeriveEta(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t11, t13, t15, t16, t17, t18, t19, t20, t21, t22;
  double t25, t27, t28, t30, t31, t32, t33, t37, t39, t40, t41, t42, t43;
  double t44, t45, t46, t50, t54, t55, t56, t57, t58, t59, t63, t65, t66;
  double t67, t68, t69, t70, t74, t76, t77, t80, t81, t85, t87, t88, t89;
  double t90, t91, t98, t99, t102, t107, t108, t109, t118, t125, t126, t127;
  double t128, t138, t145, t152, t153, t156, t157, t158, t159, t163, t164;
  double t167, t168, t170, t174, t178;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t16 = 128.0/3.0*t15;
  t17 = t9*eta;
  t18 = 265.0/6.0*t17;
  t19 = 1.0-xi-eta;
  t20 = t19*t9;
  t21 = 265.0/6.0*t20;
  t22 = t3*t7;
  t25 = t19*t3*eta;
  t27 = xi*t15;
  t28 = 265.0/6.0*t27;
  t30 = t19*xi*t7;
  t31 = 265.0/2.0*t30;
  t32 = -25.0/3.0+3761.0/60.0*xi+140.0/3.0*eta-4493.0/30.0*t3-4493.0/15.0*t5-80.0*t7+1157.0/12.0*t9+343.0*t11+1157.0/4.0*t13+t16-t18+t21-335.0/4.0*t22+335.0/2.0*t25-t28+t31;
  t33 = 696.0/5.0*xi;
  t37 = 3488.0/3.0*t11;
  t39 = 640.0/3.0*t17;
  t40 = 640.0/3.0*t20;
  t41 = 1040.0/3.0*t22;
  t42 = 2080.0/3.0*t25;
  t43 = 440.0/3.0*t27;
  t44 = 440.0*t30;
  t45 = -t33+7688.0/15.0*t3+11056.0/15.0*t5-1136.0/3.0*t9-t37-736.0*t13+t39-t40+t41-t42+t43-t44;
  t46 = 1382.0/15.0*xi;
  t50 = 984.0*t11;
  t54 = 320.0*t22;
  t55 = 640.0*t25;
  t56 = 110.0/3.0*t27;
  t57 = 110.0*t30;
  t58 = t46-7922.0/15.0*t3-5644.0/15.0*t5+448.0*t9+t50+324.0*t13-320.0*t17+320.0*t20-t54+t55-t56+t57;
  t59 = 568.0/15.0*xi;
  t63 = 416.0*t11;
  t65 = 80.0*t22;
  t66 = 160.0*t25;
  t67 = 40.0/3.0*t27;
  t68 = 40.0*t30;
  t69 = -t59+3608.0/15.0*t3+1936.0/15.0*t5-656.0/3.0*t9-t63-96.0*t13+t39-t40+t65-t66+t67-t68;
  t70 = 193.0/30.0*xi;
  t74 = 235.0/3.0*t11;
  t76 = 55.0/12.0*t22;
  t77 = 55.0/6.0*t25;
  t80 = t70-2461.0/60.0*t3-661.0/30.0*t5+415.0/12.0*t9+t74+55.0/4.0*t13-t18+t21-t76+t77-55.0/12.0*t27+55.0/4.0*t30;
  t81 = 128.0/15.0*xi;
  t85 = 512.0/3.0*t11;
  t87 = 440.0/3.0*t17;
  t88 = 440.0/3.0*t20;
  t89 = 160.0/3.0*t22;
  t90 = 320.0/3.0*t25;
  t91 = -t81+1088.0/15.0*t3+256.0/15.0*t5-48.0*t9-t85+16.0*t13+t87-t88-t89+t90+t67-t68;
  t98 = 110.0/3.0*t17;
  t99 = 110.0/3.0*t20;
  t102 = -16.0/5.0*xi+388.0/15.0*t3+776.0/15.0*t5-104.0/3.0*t9-32.0/3.0*t11-104.0*t13-t98+t99+740.0/3.0*t22-1480.0/3.0*t25-t56+t57;
  t107 = 40.0/3.0*t17;
  t108 = 40.0/3.0*t20;
  t109 = -t81+128.0/15.0*t3+2176.0/15.0*t5+16.0/3.0*t9-t85-144.0*t13+t107-t108-t89+t90+t43-t44;
  t118 = -1.0+t70+44.0/3.0*eta-661.0/60.0*t3-2461.0/30.0*t5-48.0*t7+55.0/12.0*t9+t74+415.0/4.0*t13+t16-55.0/12.0*t17+55.0/12.0*t20-t76+t77-t28+t31;
  t125 = 512.0/3.0*t15;
  t126 = 640.0/3.0*t27;
  t127 = 640.0*t30;
  t128 = 16.0/3.0-t59-224.0/3.0*eta+968.0/15.0*t3+7216.0/15.0*t5+224.0*t7-32.0*t9-t63-656.0*t13-t125+t107-t108+t65-t66+t126-t127;
  t138 = -12.0+t46+152.0*eta-2822.0/15.0*t3-15844.0/15.0*t5-384.0*t7+108.0*t9+t50+1344.0*t13+256.0*t15-t98+t99-t54+t55-320.0*t27+960.0*t30;
  t145 = 16.0-t33-416.0/3.0*eta+5528.0/15.0*t3+15376.0/15.0*t5+288.0*t7-736.0/3.0*t9-t37-1136.0*t13-t125+t87-t88+t41-t42+t126-t127;
  t152 = 3125.0/6.0*t17;
  t153 = 3125.0/6.0*t20;
  t156 = 3125.0/6.0*t27;
  t157 = 3125.0/2.0*t30;
  t158 = 250.0*xi-5875.0/6.0*t3-5875.0/3.0*t5+4375.0/6.0*t9+8750.0/3.0*t11+4375.0/2.0*t13-t152+t153-3125.0/3.0*t22+6250.0/3.0*t25-t156+t157;
  t159 = 125.0*xi;
  t163 = 1875.0*t11;
  t164 = 1875.0/4.0*t13;
  t167 = 3125.0/4.0*t22;
  t168 = 3125.0/2.0*t25;
  t170 = 125.0/3.0*xi;
  t174 = 625.0*t11;
  t178 = 625.0/4.0*t9;

  values[0] = t32;
  values[1] = t45;
  values[2] = t58;
  values[3] = t69;
  values[4] = t80;
  values[5] = t91;
  values[6] = t102;
  values[7] = t109;
  values[8] = t118;
  values[9] = t128;
  values[10] = t138;
  values[11] = t145;
  values[12] = t158;
  values[13] = -t159+3625.0/4.0*t3+1125.0/2.0*t5-3125.0/4.0*t9-t163-t164+3125.0/4.0*t17-3125.0/4.0*t20+t167-t168;
  values[14] = t170-2125.0/6.0*t3-250.0/3.0*t5+625.0/2.0*t9+t174-t152+t153;
  values[15] = -t159+1125.0/4.0*t3+3625.0/2.0*t5-t178-t163-9375.0/4.0*t13+t167-t168+3125.0/4.0*t27-9375.0/4.0*t30;
  values[16] = 125.0/4.0*xi-375.0/2.0*t3-375.0*t5+t178+t174+t164-t167+t168;
  values[17] = t170-125.0/3.0*t3-2125.0/3.0*t5+t174+1875.0/2.0*t13-t156+t157;
}

// values of the derivatives in xi-xi direction
static void C_T_B4_2D_DeriveXiXi(double xi, double eta, double *values)
{
  double t3, t4, t5, t7, t9, t10, t11, t13, t14, t15, t17, t19, t20, t21;
  double t24, t26, t27, t28, t29, t30, t31, t32, t37, t40, t41, t42, t43;
  double t47, t48, t49, t50, t51, t55, t56, t57, t59, t62, t63, t64, t65;
  double t66, t71, t72, t78, t79, t88, t100, t101, t104, t108, t111, t112;
  double t116, t119;

  t3 = xi*xi;
  t4 = 128.0*t3;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*eta;
  t10 = 265.0*t9;
  t11 = 1.0-xi-eta;
  t13 = t11*xi*eta;
  t14 = 265.0*t13;
  t15 = xi*t7;
  t17 = t11*t7;
  t19 = t7*eta;
  t20 = 265.0/3.0*t19;
  t21 = 140.0/3.0-160.0*xi-4493.0/15.0*eta+t4+1157.0/2.0*t5+343.0*t7-t10+t14-335.0*t15+335.0/2.0*t17-t20;
  t24 = 512.0*t3;
  t26 = 3488.0/3.0*t7;
  t27 = 1280.0*t9;
  t28 = 1280.0*t13;
  t29 = 4160.0/3.0*t15;
  t30 = 2080.0/3.0*t17;
  t31 = 880.0/3.0*t19;
  t32 = -416.0/3.0+576.0*xi+15376.0/15.0*eta-t24-2272.0*t5-t26+t27-t28+t29-t30+t31;
  t37 = 984.0*t7;
  t40 = 1280.0*t15;
  t41 = 640.0*t17;
  t42 = 220.0/3.0*t19;
  t43 = 152.0-768.0*xi-15844.0/15.0*eta+768.0*t3+2688.0*t5+t37-1920.0*t9+1920.0*t13-t40+t41-t42;
  t47 = 416.0*t7;
  t48 = 320.0*t15;
  t49 = 160.0*t17;
  t50 = 80.0/3.0*t19;
  t51 = -224.0/3.0+448.0*xi+7216.0/15.0*eta-t24-1312.0*t5-t47+t27-t28+t48-t49+t50;
  t55 = 235.0/3.0*t7;
  t56 = 55.0/3.0*t15;
  t57 = 55.0/6.0*t17;
  t59 = 44.0/3.0-96.0*xi-2461.0/30.0*eta+t4+415.0/2.0*t5+t55-t10+t14-t56+t57-55.0/6.0*t19;
  t62 = 512.0/3.0*t7;
  t63 = 880.0*t9;
  t64 = 880.0*t13;
  t65 = 640.0/3.0*t15;
  t66 = 320.0/3.0*t17;
  t71 = 220.0*t9;
  t72 = 220.0*t13;
  t78 = 80.0*t9;
  t79 = 80.0*t13;
  t88 = 1280.0/3.0*t19;
  t100 = 3125.0*t9;
  t101 = 3125.0*t13;
  t104 = 3125.0/3.0*t19;
  t108 = 1875.0*t7;
  t111 = 3125.0*t15;
  t112 = 3125.0/2.0*t17;
  t116 = 625.0*t7;
  t119 = 1875.0/2.0*t5;

  values[0] = t21;
  values[1] = t32;
  values[2] = t43;
  values[3] = t51;
  values[4] = t59;
  values[5] = 2176.0/15.0*eta-288.0*t5-t62+t63-t64-t65+t66+t50;
  values[6] = 776.0/15.0*eta-208.0*t5-32.0/3.0*t7-t71+t72+2960.0/3.0*t15-1480.0/3.0*t17-t42;
  values[7] = 256.0/15.0*eta+32.0*t5-t62+t78-t79-t65+t66+t31;
  values[8] = -661.0/30.0*eta+55.0/2.0*t5+t55-55.0/2.0*t9+55.0/2.0*t13-t56+t57-t20;
  values[9] = 1936.0/15.0*eta-192.0*t5-t47+t78-t79+t48-t49+t88;
  values[10] = -5644.0/15.0*eta+648.0*t5+t37-t71+t72-t40+t41-640.0*t19;
  values[11] = 11056.0/15.0*eta-1472.0*t5-t26+t63-t64+t29-t30+t88;
  values[12] = -5875.0/3.0*eta+4375.0*t5+8750.0/3.0*t7-t100+t101-12500.0/3.0*t15+6250.0/3.0*t17-t104;
  values[13] = 3625.0/2.0*eta-9375.0/2.0*t5-t108+9375.0/2.0*t9-9375.0/2.0*t13+t111-t112;
  values[14] = -2125.0/3.0*eta+1875.0*t5+t116-t100+t101;
  values[15] = 1125.0/2.0*eta-t119-t108+t111-t112+3125.0/2.0*t19;
  values[16] = -375.0*eta+t119+t116-t111+t112;
  values[17] = -250.0/3.0*eta+t116-t104;
}

// values of the derivatives in xi-eta direction
static void C_T_B4_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t10, t11, t13, t14, t15, t16, t19, t21, t22, t23;
  double t24, t25, t29, t31, t33, t35, t36, t37, t38, t42, t48, t49, t50;
  double t51, t55, t59, t60, t61, t62, t66, t70, t73, t77, t79, t81, t83;
  double t84, t90, t92, t95, t100, t102, t104, t113, t120, t121, t122;
  double t131, t138, t144, t146, t149, t150, t151, t155, t156, t160;
  double t161, t162, t166, t167, t171, t176;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t10 = 265.0/6.0*t9;
  t11 = t3*eta;
  t13 = 1.0-xi-eta;
  t14 = t13*t3;
  t15 = 265.0/2.0*t14;
  t16 = xi*t7;
  t19 = t13*xi*eta;
  t21 = t7*eta;
  t22 = 265.0/6.0*t21;
  t23 = t13*t7;
  t24 = 265.0/2.0*t23;
  t25 = 3761.0/60.0-4493.0/15.0*xi-4493.0/15.0*eta+1157.0/4.0*t3+686.0*t5+1157.0/4.0*t7-t10-300.0*t11+t15-300.0*t16+335.0*t19-t22+t24;
  t29 = 6976.0/3.0*t5;
  t31 = 640.0/3.0*t9;
  t33 = 640.0*t14;
  t35 = 4160.0/3.0*t19;
  t36 = 440.0/3.0*t21;
  t37 = 440.0*t23;
  t38 = -696.0/5.0+15376.0/15.0*xi+11056.0/15.0*eta-1136.0*t3-t29-736.0*t7+t31+4000.0/3.0*t11-t33+3400.0/3.0*t16-t35+t36-t37;
  t42 = 1968.0*t5;
  t48 = 1280.0*t19;
  t49 = 110.0/3.0*t21;
  t50 = 110.0*t23;
  t51 = 1382.0/15.0-15844.0/15.0*xi-5644.0/15.0*eta+1344.0*t3+t42+324.0*t7-320.0*t9-1600.0*t11+960.0*t14-750.0*t16+t48-t49+t50;
  t55 = 832.0*t5;
  t59 = 320.0*t19;
  t60 = 40.0/3.0*t21;
  t61 = 40.0*t23;
  t62 = -568.0/15.0+7216.0/15.0*xi+1936.0/15.0*eta-656.0*t3-t55-96.0*t7+t31+800.0*t11-t33+200.0*t16-t59+t60-t61;
  t66 = 470.0/3.0*t5;
  t70 = 55.0/3.0*t19;
  t73 = 193.0/30.0-2461.0/30.0*xi-661.0/30.0*eta+415.0/4.0*t3+t66+55.0/4.0*t7-t10-425.0/3.0*t11+t15-275.0/12.0*t16+t70-55.0/12.0*t21+55.0/4.0*t23;
  t77 = 1024.0/3.0*t5;
  t79 = 440.0/3.0*t9;
  t81 = 440.0*t14;
  t83 = 640.0/3.0*t19;
  t84 = -128.0/15.0+2176.0/15.0*xi+256.0/15.0*eta-144.0*t3-t77+16.0*t7+t79+1000.0/3.0*t11-t81-200.0/3.0*t16+t83+t60-t61;
  t90 = 110.0/3.0*t9;
  t92 = 110.0*t14;
  t95 = -16.0/5.0+776.0/15.0*xi+776.0/15.0*eta-104.0*t3-64.0/3.0*t5-104.0*t7-t90+1150.0/3.0*t11+t92+1150.0/3.0*t16-2960.0/3.0*t19-t49+t50;
  t100 = 40.0/3.0*t9;
  t102 = 40.0*t14;
  t104 = -128.0/15.0+256.0/15.0*xi+2176.0/15.0*eta+16.0*t3-t77-144.0*t7+t100-200.0/3.0*t11-t102+1000.0/3.0*t16+t83+t36-t37;
  t113 = 193.0/30.0-661.0/30.0*xi-2461.0/30.0*eta+55.0/4.0*t3+t66+415.0/4.0*t7-55.0/12.0*t9-275.0/12.0*t11+55.0/4.0*t14-425.0/3.0*t16+t70-t22+t24;
  t120 = 640.0/3.0*t21;
  t121 = 640.0*t23;
  t122 = -568.0/15.0+1936.0/15.0*xi+7216.0/15.0*eta-96.0*t3-t55-656.0*t7+t100+200.0*t11-t102+800.0*t16-t59+t120-t121;
  t131 = 1382.0/15.0-5644.0/15.0*xi-15844.0/15.0*eta+324.0*t3+t42+1344.0*t7-t90-750.0*t11+t92-1600.0*t16+t48-320.0*t21+960.0*t23;
  t138 = -696.0/5.0+11056.0/15.0*xi+15376.0/15.0*eta-736.0*t3-t29-1136.0*t7+t79+3400.0/3.0*t11-t81+4000.0/3.0*t16-t35+t120-t121;
  t144 = 3125.0/6.0*t9;
  t146 = 3125.0/2.0*t14;
  t149 = 3125.0/6.0*t21;
  t150 = 3125.0/2.0*t23;
  t151 = 250.0-5875.0/3.0*xi-5875.0/3.0*eta+4375.0/2.0*t3+17500.0/3.0*t5+4375.0/2.0*t7-t144-21875.0/6.0*t11+t146-21875.0/6.0*t16+12500.0/3.0*t19-t149+t150;
  t155 = 3750.0*t5;
  t156 = 1875.0/4.0*t7;
  t160 = 3125.0/2.0*t16;
  t161 = 3125.0*t19;
  t162 = -125.0+3625.0/2.0*xi+1125.0/2.0*eta-9375.0/4.0*t3-t155-t156+3125.0/4.0*t9+15625.0/4.0*t11-9375.0/4.0*t14+t160-t161;
  t166 = 1250.0*t5;
  t167 = 3125.0/2.0*t11;
  t171 = 1875.0/4.0*t3;
  t176 = -125.0+1125.0/2.0*xi+3625.0/2.0*eta-t171-t155-9375.0/4.0*t7+t167+15625.0/4.0*t16-t161+3125.0/4.0*t21-9375.0/4.0*t23;

  values[0] = t25;
  values[1] = t38;
  values[2] = t51;
  values[3] = t62;
  values[4] = t73;
  values[5] = t84;
  values[6] = t95;
  values[7] = t104;
  values[8] = t113;
  values[9] = t122;
  values[10] = t131;
  values[11] = t138;
  values[12] = t151;
  values[13] = t162;
  values[14] = 125.0/3.0-2125.0/3.0*xi-250.0/3.0*eta+1875.0/2.0*t3+t166-t144-t167+t146;
  values[15] = t176;
  values[16] = 125.0/4.0-375.0*xi-375.0*eta+t171+t166+t156-t167-t160+t161;
  values[17] = 125.0/3.0-250.0/3.0*xi-2125.0/3.0*eta+t166+1875.0/2.0*t7-t160-t149+t150;
}

// values of the derivatives in eta-eta direction
static void C_T_B4_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double t3, t5, t7, t8, t9, t10, t11, t13, t14, t16, t17, t19, t20, t21;
  double t23, t25, t26, t27, t28, t29, t32, t35, t36, t37, t38, t41, t43;
  double t44, t45, t46, t49, t51, t52, t57, t59, t60, t61, t66, t72, t78;
  double t82, t83, t84, t85, t92, t96, t100, t103, t104, t107, t108, t110;
  double t111, t114;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t8 = 128.0*t7;
  t9 = t3*xi;
  t10 = 265.0/3.0*t9;
  t11 = t3*eta;
  t13 = 1.0-xi-eta;
  t14 = t13*t3;
  t16 = xi*t7;
  t17 = 265.0*t16;
  t19 = t13*xi*eta;
  t20 = 265.0*t19;
  t21 = 140.0/3.0-4493.0/15.0*xi-160.0*eta+343.0*t3+1157.0/2.0*t5+t8-t10-335.0*t11+335.0/2.0*t14-t17+t20;
  t23 = 3488.0/3.0*t3;
  t25 = 1280.0/3.0*t9;
  t26 = 4160.0/3.0*t11;
  t27 = 2080.0/3.0*t14;
  t28 = 880.0*t16;
  t29 = 880.0*t19;
  t32 = 984.0*t3;
  t35 = 1280.0*t11;
  t36 = 640.0*t14;
  t37 = 220.0*t16;
  t38 = 220.0*t19;
  t41 = 416.0*t3;
  t43 = 320.0*t11;
  t44 = 160.0*t14;
  t45 = 80.0*t16;
  t46 = 80.0*t19;
  t49 = 235.0/3.0*t3;
  t51 = 55.0/3.0*t11;
  t52 = 55.0/6.0*t14;
  t57 = 512.0/3.0*t3;
  t59 = 880.0/3.0*t9;
  t60 = 640.0/3.0*t11;
  t61 = 320.0/3.0*t14;
  t66 = 220.0/3.0*t9;
  t72 = 80.0/3.0*t9;
  t78 = 44.0/3.0-2461.0/30.0*xi-96.0*eta+t49+415.0/2.0*t5+t8-55.0/6.0*t9-t51+t52-t17+t20;
  t82 = 512.0*t7;
  t83 = 1280.0*t16;
  t84 = 1280.0*t19;
  t85 = -224.0/3.0+7216.0/15.0*xi+448.0*eta-t41-1312.0*t5-t82+t72+t43-t44+t83-t84;
  t92 = 152.0-15844.0/15.0*xi-768.0*eta+t32+2688.0*t5+768.0*t7-t66-t35+t36-1920.0*t16+1920.0*t19;
  t96 = -416.0/3.0+15376.0/15.0*xi+576.0*eta-t23-2272.0*t5-t82+t59+t26-t27+t83-t84;
  t100 = 3125.0/3.0*t9;
  t103 = 3125.0*t16;
  t104 = 3125.0*t19;
  t107 = 1875.0*t3;
  t108 = 1875.0/2.0*t5;
  t110 = 3125.0*t11;
  t111 = 3125.0/2.0*t14;
  t114 = 625.0*t3;

  values[0] = t21;
  values[1] = 11056.0/15.0*xi-t23-1472.0*t5+t25+t26-t27+t28-t29;
  values[2] = -5644.0/15.0*xi+t32+648.0*t5-640.0*t9-t35+t36-t37+t38;
  values[3] = 1936.0/15.0*xi-t41-192.0*t5+t25+t43-t44+t45-t46;
  values[4] = -661.0/30.0*xi+t49+55.0/2.0*t5-t10-t51+t52-55.0/2.0*t16+55.0/2.0*t19;
  values[5] = 256.0/15.0*xi-t57+32.0*t5+t59-t60+t61+t45-t46;
  values[6] = 776.0/15.0*xi-32.0/3.0*t3-208.0*t5-t66+2960.0/3.0*t11-1480.0/3.0*t14-t37+t38;
  values[7] = 2176.0/15.0*xi-t57-288.0*t5+t72-t60+t61+t28-t29;
  values[8] = t78;
  values[9] = t85;
  values[10] = t92;
  values[11] = t96;
  values[12] = -5875.0/3.0*xi+8750.0/3.0*t3+4375.0*t5-t100-12500.0/3.0*t11+6250.0/3.0*t14-t103+t104;
  values[13] = 1125.0/2.0*xi-t107-t108+3125.0/2.0*t9+t110-t111;
  values[14] = -250.0/3.0*xi+t114-t100;
  values[15] = 3625.0/2.0*xi-t107-9375.0/2.0*t5+t110-t111+9375.0/2.0*t16-9375.0/2.0*t19;
  values[16] = -375.0*xi+t114+t108-t110+t111;
  values[17] = -2125.0/3.0*xi+t114+1875.0*t5-t103+t104;
}
  
// ***********************************************************************

TBaseFunct2D *BF_C_T_B4_2D_Obj = new TBaseFunct2D
        (18, BF_C_T_B4_2D, BFUnitTriangle, 
         C_T_B4_2D_Funct, C_T_B4_2D_DeriveXi,
         C_T_B4_2D_DeriveEta, C_T_B4_2D_DeriveXiXi,
         C_T_B4_2D_DeriveXiEta, C_T_B4_2D_DeriveEtaEta, 5, 4,
         0, NULL);
