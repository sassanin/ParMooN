/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// P3 element with bubbles, conforming, 2D
// ***********************************************************************

// base function values
static void C_T_UL3_2D_Funct(double xi, double eta, double *values)
{
  double t3, t5, t6, t7, t9, t10, t11, t13, t15, t16, t17, t18, t20, t23;
  double t24, t26, t29, t30, t31, t34, t35, t38, t40, t41, t48, t51, t52;
  double t53, t56, t58, t59, t64, t65, t71, t77, t82, t84, t101, t102, t103;
  double t107, t115, t116, t117, t121;

  t3 = xi*xi;
  t5 = xi*eta;
  t6 = 72.0*t5;
  t7 = eta*eta;
  t9 = t3*xi;
  t10 = 9.0/2.0*t9;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t16 = 9.0/2.0*t15;
  t17 = 1.0-xi-eta;
  t18 = t11*t17;
  t20 = t13*t17;
  t23 = t9*eta*t17;
  t24 = 234.0*t23;
  t26 = t3*t7*t17;
  t29 = xi*t15*t17;
  t30 = 234.0*t29;
  t31 = 1.0-11.0/2.0*xi-11.0/2.0*eta+9.0*t3-t6+9.0*t7-t10+153.0/2.0*t11+153.0/2.0*t13-t16+294.0*t18+294.0*t20-t24-432.0*t26-t30;
  t34 = 171.0*t5;
  t35 = 27.0/2.0*t9;
  t38 = 216.0*t18;
  t40 = 486.0*t26;
  t41 = 432.0*t29;
  t48 = 54.0*t29;
  t51 = 30.0*t5;
  t52 = 30.0*t11;
  t53 = 30.0*t13;
  t56 = 36.0*t26;
  t58 = xi-9.0/2.0*t3-t51+t10+t52+t53+174.0*t18+36.0*t20-t24-t56-36.0*t29;
  t59 = 45.0*t5;
  t64 = 432.0*t23;
  t65 = 378.0*t26;
  t71 = 54.0*t23;
  t77 = eta-t51-9.0/2.0*t7+t52+t53+t16+36.0*t18+174.0*t20-36.0*t23-t56-t30;
  t82 = 27.0/2.0*t15;
  t84 = 216.0*t20;
  t101 = 1344.0*t5;
  t102 = 1344.0*t11;
  t103 = 1344.0*t13;
  t107 = 4032.0*t26;
  t115 = 168.0*t5;
  t116 = 168.0*t11;
  t117 = 168.0*t13;
  t121 = 840.0*t26;

  values[0] = t31;
  values[1] = 9.0*xi-45.0/2.0*t3-t34+t35+351.0/2.0*t11+162.0*t13+t38+540.0*t20-t40-t41;
  values[2] = -9.0/2.0*xi+18.0*t3+t6-t35-81.0*t11-135.0/2.0*t13-t38-162.0*t20+t40+t48;
  values[3] = t58;
  values[4] = -t59+54.0*t11+81.0/2.0*t13+324.0*t18+54.0*t20-t64-t65+t48;
  values[5] = -t59+81.0/2.0*t11+54.0*t13+54.0*t18+324.0*t20+t71-t65-t41;
  values[6] = t77;
  values[7] = -9.0/2.0*eta+t6+18.0*t7-135.0/2.0*t11-81.0*t13-t82-162.0*t18-t84+t71+t40;
  values[8] = 9.0*eta-t34-45.0/2.0*t7+162.0*t11+351.0/2.0*t13+t82+540.0*t18+t84-t64-t40;
  values[9] = 420.0*t5-420.0*t11-420.0*t13-1260.0*t18-1260.0*t20+1260.0*t23+1260.0*t26+1260.0*t29;
  values[10] = -t101+t102+t103+2016.0*t18+4032.0*t20+2016.0*t23-t107-4032.0*t29;
  values[11] = -t101+t102+t103+4032.0*t18+2016.0*t20-4032.0*t23-t107+2016.0*t29;
  values[12] = t115-t116-t117-840.0*t18-336.0*t20+840.0*t23+t121+168.0*t29;
  values[13] = t115-t116-t117-588.0*t18-588.0*t20+420.0*t23+1092.0*t26+420.0*t29;
  values[14] = t115-t116-t117-336.0*t18-840.0*t20+168.0*t23+t121+840.0*t29;
}

// values of the derivatives in xi direction
static void C_T_UL3_2D_DeriveXi(double xi, double eta, double *values)
{
  double t2, t3, t4, t5, t7, t9, t10, t12, t14, t16, t18, t19, t21, t22;
  double t23, t25, t27, t28, t29, t30, t31, t32, t34, t35, t38, t39, t42;
  double t43, t44, t45, t46, t52, t53, t54, t56, t57, t58, t63, t64, t67;
  double t68, t75, t76, t77, t78, t79, t86, t87, t88, t95, t100, t101;
  double t102, t107, t121, t122, t123, t124, t131, t132, t135, t144, t145;
  double t146, t147, t154, t155, t158, t169, t178;

  t2 = 72.0*eta;
  t3 = xi*xi;
  t4 = 27.0/2.0*t3;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = 1.0-xi-eta;
  t10 = t5*t9;
  t12 = t3*eta;
  t14 = t7*t9;
  t16 = xi*t7;
  t18 = t12*t9;
  t19 = 702.0*t18;
  t21 = t3*xi*eta;
  t22 = 234.0*t21;
  t23 = t16*t9;
  t25 = t3*t7;
  t27 = t7*eta;
  t28 = t27*t9;
  t29 = 234.0*t28;
  t30 = xi*t27;
  t31 = 234.0*t30;
  t32 = -11.0/2.0+18.0*xi-t2-t4+153.0*t5+153.0/2.0*t7+588.0*t10-294.0*t12+294.0*t14-294.0*t16-t19+t22-864.0*t23+432.0*t25-t29+t31;
  t34 = 171.0*eta;
  t35 = 81.0/2.0*t3;
  t38 = 432.0*t10;
  t39 = 216.0*t12;
  t42 = 972.0*t23;
  t43 = 486.0*t25;
  t44 = 432.0*t28;
  t45 = 432.0*t30;
  t46 = 9.0-45.0*xi-t34+t35+351.0*t5+162.0*t7+t38-t39+540.0*t14-540.0*t16-t42+t43-t44+t45;
  t52 = 54.0*t28;
  t53 = 54.0*t30;
  t54 = -9.0/2.0+36.0*xi+t2-t35-162.0*t5-135.0/2.0*t7-t38+t39-162.0*t14+162.0*t16+t42-t43+t52-t53;
  t56 = 30.0*eta;
  t57 = 60.0*t5;
  t58 = 30.0*t7;
  t63 = 72.0*t23;
  t64 = 36.0*t25;
  t67 = 1.0-9.0*xi-t56+t4+t57+t58+348.0*t10-174.0*t12+36.0*t14-36.0*t16-t19+t22-t63+t64-36.0*t28+36.0*t30;
  t68 = 45.0*eta;
  t75 = 1296.0*t18;
  t76 = 432.0*t21;
  t77 = 756.0*t23;
  t78 = 378.0*t25;
  t79 = -t68+108.0*t5+81.0/2.0*t7+648.0*t10-324.0*t12+54.0*t14-54.0*t16-t75+t76-t77+t78+t52-t53;
  t86 = 162.0*t18;
  t87 = 54.0*t21;
  t88 = -t68+81.0*t5+54.0*t7+108.0*t10-54.0*t12+324.0*t14-324.0*t16+t86-t87-t77+t78-t44+t45;
  t95 = -t56+t57+t58+72.0*t10-36.0*t12+174.0*t14-174.0*t16-108.0*t18+36.0*t21-t63+t64-t29+t31;
  t100 = 216.0*t14;
  t101 = 216.0*t16;
  t102 = t2-135.0*t5-81.0*t7-324.0*t10+162.0*t12-t100+t101+t86-t87+t42-t43;
  t107 = -t34+324.0*t5+351.0/2.0*t7+1080.0*t10-540.0*t12+t100-t101-t75+t76-t42+t43;
  t121 = 420.0*eta-840.0*t5-420.0*t7-2520.0*t10+1260.0*t12-1260.0*t14+1260.0*t16+3780.0*t18-1260.0*t21+2520.0*t23-1260.0*t25+1260.0*t28-1260.0*t30;
  t122 = 1344.0*eta;
  t123 = 2688.0*t5;
  t124 = 1344.0*t7;
  t131 = 8064.0*t23;
  t132 = 4032.0*t25;
  t135 = -t122+t123+t124+4032.0*t10-2016.0*t12+4032.0*t14-4032.0*t16+6048.0*t18-2016.0*t21-t131+t132-4032.0*t28+4032.0*t30;
  t144 = -t122+t123+t124+8064.0*t10-4032.0*t12+2016.0*t14-2016.0*t16-12096.0*t18+4032.0*t21-t131+t132+2016.0*t28-2016.0*t30;
  t145 = 168.0*eta;
  t146 = 336.0*t5;
  t147 = 168.0*t7;
  t154 = 1680.0*t23;
  t155 = 840.0*t25;
  t158 = t145-t146-t147-1680.0*t10+840.0*t12-336.0*t14+336.0*t16+2520.0*t18-840.0*t21+t154-t155+168.0*t28-168.0*t30;
  t169 = t145-t146-t147-1176.0*t10+588.0*t12-588.0*t14+588.0*t16+1260.0*t18-420.0*t21+2184.0*t23-1092.0*t25+420.0*t28-420.0*t30;
  t178 = t145-t146-t147-672.0*t10+336.0*t12-840.0*t14+840.0*t16+504.0*t18-168.0*t21+t154-t155+840.0*t28-840.0*t30;

  values[0] = t32;
  values[1] = t46;
  values[2] = t54;
  values[3] = t67;
  values[4] = t79;
  values[5] = t88;
  values[6] = t95;
  values[7] = t102;
  values[8] = t107;
  values[9] = t121;
  values[10] = t135;
  values[11] = t144;
  values[12] = t158;
  values[13] = t169;
  values[14] = t178;
}

// values of the derivatives in eta direction
static void C_T_UL3_2D_DeriveEta(double xi, double eta, double *values)
{
  double t1, t3, t5, t7, t8, t9, t10, t12, t14, t16, t18, t19, t20, t21;
  double t22, t23, t25, t27, t28, t30, t31, t32, t33, t36, t37, t40, t41;
  double t42, t43, t44, t49, t50, t51, t52, t53, t54, t59, t60, t63, t64;
  double t71, t72, t73, t74, t75, t82, t83, t84, t92, t96, t99, t100;
  double t101, t107, t121, t122, t123, t124, t131, t132, t135, t144, t145;
  double t146, t147, t154, t155, t158, t169, t178;

  t1 = 72.0*xi;
  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t8 = 27.0/2.0*t7;
  t9 = 1.0-xi-eta;
  t10 = t3*t9;
  t12 = t3*eta;
  t14 = t5*t9;
  t16 = xi*t7;
  t18 = t3*xi;
  t19 = t18*t9;
  t20 = 234.0*t19;
  t21 = t18*eta;
  t22 = 234.0*t21;
  t23 = t12*t9;
  t25 = t3*t7;
  t27 = t16*t9;
  t28 = 702.0*t27;
  t30 = xi*t7*eta;
  t31 = 234.0*t30;
  t32 = -11.0/2.0-t1+18.0*eta+153.0/2.0*t3+153.0*t5-t8+294.0*t10-294.0*t12+588.0*t14-294.0*t16-t20+t22-864.0*t23+432.0*t25-t28+t31;
  t33 = 171.0*xi;
  t36 = 216.0*t10;
  t37 = 216.0*t12;
  t40 = 972.0*t23;
  t41 = 486.0*t25;
  t42 = 1296.0*t27;
  t43 = 432.0*t30;
  t44 = -t33+351.0/2.0*t3+324.0*t5+t36-t37+1080.0*t14-540.0*t16-t40+t41-t42+t43;
  t49 = 162.0*t27;
  t50 = 54.0*t30;
  t51 = t1-81.0*t3-135.0*t5-t36+t37-324.0*t14+162.0*t16+t40-t41+t49-t50;
  t52 = 30.0*xi;
  t53 = 30.0*t3;
  t54 = 60.0*t5;
  t59 = 72.0*t23;
  t60 = 36.0*t25;
  t63 = -t52+t53+t54+174.0*t10-174.0*t12+72.0*t14-36.0*t16-t20+t22-t59+t60-108.0*t27+36.0*t30;
  t64 = 45.0*xi;
  t71 = 432.0*t19;
  t72 = 432.0*t21;
  t73 = 756.0*t23;
  t74 = 378.0*t25;
  t75 = -t64+54.0*t3+81.0*t5+324.0*t10-324.0*t12+108.0*t14-54.0*t16-t71+t72-t73+t74+t49-t50;
  t82 = 54.0*t19;
  t83 = 54.0*t21;
  t84 = -t64+81.0/2.0*t3+108.0*t5+54.0*t10-54.0*t12+648.0*t14-324.0*t16+t82-t83-t73+t74-t42+t43;
  t92 = 1.0-t52-9.0*eta+t53+t54+t8+36.0*t10-36.0*t12+348.0*t14-174.0*t16-36.0*t19+36.0*t21-t59+t60-t28+t31;
  t96 = 81.0/2.0*t7;
  t99 = 432.0*t14;
  t100 = 216.0*t16;
  t101 = -9.0/2.0+t1+36.0*eta-135.0/2.0*t3-162.0*t5-t96-162.0*t10+162.0*t12-t99+t100+t82-t83+t40-t41;
  t107 = 9.0-t33-45.0*eta+162.0*t3+351.0*t5+t96+540.0*t10-540.0*t12+t99-t100-t71+t72-t40+t41;
  t121 = 420.0*xi-420.0*t3-840.0*t5-1260.0*t10+1260.0*t12-2520.0*t14+1260.0*t16+1260.0*t19-1260.0*t21+2520.0*t23-1260.0*t25+3780.0*t27-1260.0*t30;
  t122 = 1344.0*xi;
  t123 = 1344.0*t3;
  t124 = 2688.0*t5;
  t131 = 8064.0*t23;
  t132 = 4032.0*t25;
  t135 = -t122+t123+t124+2016.0*t10-2016.0*t12+8064.0*t14-4032.0*t16+2016.0*t19-2016.0*t21-t131+t132-12096.0*t27+4032.0*t30;
  t144 = -t122+t123+t124+4032.0*t10-4032.0*t12+4032.0*t14-2016.0*t16-4032.0*t19+4032.0*t21-t131+t132+6048.0*t27-2016.0*t30;
  t145 = 168.0*xi;
  t146 = 168.0*t3;
  t147 = 336.0*t5;
  t154 = 1680.0*t23;
  t155 = 840.0*t25;
  t158 = t145-t146-t147-840.0*t10+840.0*t12-672.0*t14+336.0*t16+840.0*t19-840.0*t21+t154-t155+504.0*t27-168.0*t30;
  t169 = t145-t146-t147-588.0*t10+588.0*t12-1176.0*t14+588.0*t16+420.0*t19-420.0*t21+2184.0*t23-1092.0*t25+1260.0*t27-420.0*t30;
  t178 = t145-t146-t147-336.0*t10+336.0*t12-1680.0*t14+840.0*t16+168.0*t19-168.0*t21+t154-t155+2520.0*t27-840.0*t30;

  values[0] = t32;
  values[1] = t44;
  values[2] = t51;
  values[3] = t63;
  values[4] = t75;
  values[5] = t84;
  values[6] = t92;
  values[7] = t101;
  values[8] = t107;
  values[9] = t121;
  values[10] = t135;
  values[11] = t144;
  values[12] = t158;
  values[13] = t169;
  values[14] = t178;
}

// values of the derivatives in xi-xi  direction
static void C_T_UL3_2D_DeriveXiXi(double xi, double eta, double *values)
{
 double t1, t3, t4, t6, t8, t10, t11, t12, t13, t14, t15, t17, t19, t20;
 double t21, t22, t24, t25, t27, t28, t29, t33, t35, t39, t40, t42, t47;
 double t48, t49, t50, t56, t57, t68, t84, t90, t91, t101, t107, t108;

  t1 = 27.0*xi;
  t3 = 1.0-xi-eta;
  t4 = t3*eta;
  t6 = xi*eta;
  t8 = eta*eta;
  t10 = t6*t3;
  t11 = 1404.0*t10;
  t12 = xi*xi;
  t13 = t12*eta;
  t14 = 1404.0*t13;
  t15 = t8*t3;
  t17 = xi*t8;
  t19 = t8*eta;
  t20 = 468.0*t19;
  t21 = 18.0-t1+153.0*eta+588.0*t4-1176.0*t6-588.0*t8-t11+t14-864.0*t15+1728.0*t17+t20;
  t22 = 81.0*xi;
  t24 = 432.0*t4;
  t25 = 864.0*t6;
  t27 = 972.0*t15;
  t28 = 1944.0*t17;
  t29 = 864.0*t19;
  t33 = 108.0*t19;
  t35 = 60.0*eta;
  t39 = 72.0*t15;
  t40 = 144.0*t17;
  t42 = -9.0+t1+t35+348.0*t4-696.0*t6-72.0*t8-t11+t14-t39+t40+72.0*t19;
  t47 = 2592.0*t10;
  t48 = 2592.0*t13;
  t49 = 756.0*t15;
  t50 = 1512.0*t17;
  t56 = 324.0*t10;
  t57 = 324.0*t13;
  t68 = 432.0*t8;
  t84 = 2688.0*eta;
  t90 = 8064.0*t15;
  t91 = 16128.0*t17;
  t101 = 336.0*eta;
  t107 = 1680.0*t15;
  t108 = 3360.0*t17;

  values[0] = t21;
  values[1] = -45.0+t22+351.0*eta+t24-t25-1080.0*t8-t27+t28+t29;
  values[2] = 36.0-t22-162.0*eta-t24+t25+324.0*t8+t27-t28-t33;
  values[3] = t42;
  values[4] = 108.0*eta+648.0*t4-1296.0*t6-108.0*t8-t47+t48-t49+t50-t33;
  values[5] = 81.0*eta+108.0*t4-216.0*t6-648.0*t8+t56-t57-t49+t50+t29;
  values[6] = t35+72.0*t4-144.0*t6-348.0*t8-216.0*t10+216.0*t13-t39+t40+t20;
  values[7] = -135.0*eta-324.0*t4+648.0*t6+t68+t56-t57+t27-t28;
  values[8] = 324.0*eta+1080.0*t4-2160.0*t6-t68-t47+t48-t27+t28;
  values[9] = -840.0*eta-2520.0*t4+5040.0*t6+2520.0*t8+7560.0*t10-7560.0*t13+2520.0*t15-5040.0*t17-2520.0*t19;
  values[10] = t84+4032.0*t4-8064.0*t6-8064.0*t8+12096.0*t10-12096.0*t13-t90+t91+8064.0*t19;
  values[11] = t84+8064.0*t4-16128.0*t6-4032.0*t8-24192.0*t10+24192.0*t13-t90+t91-4032.0*t19;
  values[12] = -t101-1680.0*t4+3360.0*t6+672.0*t8+5040.0*t10-5040.0*t13+t107-t108-336.0*t19;
  values[13] = -t101-1176.0*t4+2352.0*t6+1176.0*t8+2520.0*t10-2520.0*t13+2184.0*t15-4368.0*t17-840.0*t19;
  values[14] = -t101-672.0*t4+1344.0*t6+1680.0*t8+1008.0*t10-1008.0*t13+t107-t108-1680.0*t19;
}

// values of the derivatives in xi-eta direction
static void C_T_UL3_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t3, t4, t6, t8, t10, t12, t14, t15, t16, t18, t19, t20, t22, t24;
  double t25, t26, t27, t28, t31, t32, t33, t36, t38, t39, t40, t41, t44;
  double t48, t49, t50, t51, t52, t54, t59, t63, t70, t72, t73, t75, t82;
  double t84, t86, t95, t100, t101, t103, t104, t110, t125, t126, t127;
  double t129, t136, t140, t151, t152, t153, t155, t162, t166, t178, t189;

  t3 = 1.0-xi-eta;
  t4 = t3*xi;
  t6 = xi*eta;
  t8 = xi*xi;
  t10 = t3*eta;
  t12 = eta*eta;
  t14 = t8*t3;
  t15 = 702.0*t14;
  t16 = t8*eta;
  t18 = xi*t8;
  t19 = 234.0*t18;
  t20 = t6*t3;
  t22 = xi*t12;
  t24 = t12*t3;
  t25 = 702.0*t24;
  t26 = t12*eta;
  t27 = 234.0*t26;
  t28 = -72.0+153.0*xi+153.0*eta+588.0*t4-1176.0*t6-294.0*t8+588.0*t10-294.0*t12-t15+1566.0*t16+t19-1728.0*t20+1566.0*t22-t25+t27;
  t31 = 432.0*t4;
  t32 = 1512.0*t6;
  t33 = 216.0*t8;
  t36 = 1944.0*t20;
  t38 = 972.0*t16;
  t39 = 1296.0*t24;
  t40 = 432.0*t26;
  t41 = -171.0+351.0*xi+324.0*eta+t31-t32-t33+1080.0*t10-540.0*t12-t36+2268.0*t22+t38-t39+t40;
  t44 = 756.0*t6;
  t48 = 162.0*t24;
  t49 = 54.0*t26;
  t50 = 72.0-162.0*xi-135.0*eta-t31+t44+t33-324.0*t10+162.0*t12+t36-1134.0*t22-t38+t48-t49;
  t51 = 60.0*xi;
  t52 = 60.0*eta;
  t54 = 420.0*t6;
  t59 = 144.0*t20;
  t63 = -30.0+t51+t52+348.0*t4-t54-174.0*t8+72.0*t10-36.0*t12-t15+774.0*t16+t19-t59+180.0*t22-108.0*t24+36.0*t26;
  t70 = 1296.0*t14;
  t72 = 432.0*t18;
  t73 = 1512.0*t20;
  t75 = -45.0+108.0*xi+81.0*eta+648.0*t4-t44-324.0*t8+108.0*t10-54.0*t12-t70+2052.0*t16+t72-t73+594.0*t22+t48-t49;
  t82 = 162.0*t14;
  t84 = 54.0*t18;
  t86 = -45.0+81.0*xi+108.0*eta+108.0*t4-t44-54.0*t8+648.0*t10-324.0*t12+t82+594.0*t16-t84-t73+2052.0*t22-t39+t40;
  t95 = -30.0+t51+t52+72.0*t4-t54-36.0*t8+348.0*t10-174.0*t12-108.0*t14+180.0*t16+36.0*t18-t59+774.0*t22-t25+t27;
  t100 = 432.0*t10;
  t101 = 216.0*t12;
  t103 = 972.0*t22;
  t104 = 72.0-135.0*xi-162.0*eta-324.0*t4+t44+162.0*t8-t100+t101+t82-1134.0*t16-t84+t36-t103;
  t110 = -171.0+324.0*xi+351.0*eta+1080.0*t4-t32-540.0*t8+t100-t101-t70+2268.0*t16+t72-t36+t103;
  t125 = 420.0-840.0*xi-840.0*eta-2520.0*t4+5040.0*t6+1260.0*t8-2520.0*t10+1260.0*t12+3780.0*t14-6300.0*t16-1260.0*t18+5040.0*t20-6300.0*t22+3780.0*t24-1260.0*t26;
  t126 = 2688.0*xi;
  t127 = 2688.0*eta;
  t129 = 12096.0*t6;
  t136 = 16128.0*t20;
  t140 = -1344.0+t126+t127+4032.0*t4-t129-2016.0*t8+8064.0*t10-4032.0*t12+6048.0*t14+2016.0*t16-2016.0*t18-t136+20160.0*t22-12096.0*t24+4032.0*t26;
  t151 = -1344.0+t126+t127+8064.0*t4-t129-4032.0*t8+4032.0*t10-2016.0*t12-12096.0*t14+20160.0*t16+4032.0*t18-t136+2016.0*t22+6048.0*t24-2016.0*t26;
  t152 = 336.0*xi;
  t153 = 336.0*eta;
  t155 = 2352.0*t6;
  t162 = 3360.0*t20;
  t166 = 168.0-t152-t153-1680.0*t4+t155+840.0*t8-672.0*t10+336.0*t12+2520.0*t14-4200.0*t16-840.0*t18+t162-2184.0*t22+504.0*t24-168.0*t26;
  t178 = 168.0-t152-t153-1176.0*t4+t155+588.0*t8-1176.0*t10+588.0*t12+1260.0*t14-3444.0*t16-420.0*t18+4368.0*t20-3444.0*t22+1260.0*t24-420.0*t26;
  t189 = 168.0-t152-t153-672.0*t4+t155+336.0*t8-1680.0*t10+840.0*t12+504.0*t14-2184.0*t16-168.0*t18+t162-4200.0*t22+2520.0*t24-840.0*t26;

  values[0] = t28;
  values[1] = t41;
  values[2] = t50;
  values[3] = t63;
  values[4] = t75;
  values[5] = t86;
  values[6] = t95;
  values[7] = t104;
  values[8] = t110;
  values[9] = t125;
  values[10] = t140;
  values[11] = t151;
  values[12] = t166;
  values[13] = t178;
  values[14] = t189;
}

// values of the derivatives in eta-eta direction
static void C_T_UL3_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double  t2, t3, t5, t6, t8, t10, t11, t12, t14, t16, t17, t18, t19, t20;
  double t21, t23, t26, t27, t28, t29, t34, t35, t37, t41, t42, t50, t51;
  double t52, t58, t64, t66, t68, t69, t84, t89, t90, t101, t106, t107;

  t2 = 27.0*eta;
  t3 = xi*xi;
  t5 = 1.0-xi-eta;
  t6 = xi*t5;
  t8 = xi*eta;
  t10 = t3*xi;
  t11 = 468.0*t10;
  t12 = t3*t5;
  t14 = t3*eta;
  t16 = t8*t5;
  t17 = 1404.0*t16;
  t18 = eta*eta;
  t19 = xi*t18;
  t20 = 1404.0*t19;
  t21 = 18.0+153.0*xi-t2-588.0*t3+588.0*t6-1176.0*t8+t11-864.0*t12+1728.0*t14-t17+t20;
  t23 = 432.0*t3;
  t26 = 972.0*t12;
  t27 = 1944.0*t14;
  t28 = 2592.0*t16;
  t29 = 2592.0*t19;
  t34 = 324.0*t16;
  t35 = 324.0*t19;
  t37 = 60.0*xi;
  t41 = 72.0*t12;
  t42 = 144.0*t14;
  t50 = 864.0*t10;
  t51 = 756.0*t12;
  t52 = 1512.0*t14;
  t58 = 108.0*t10;
  t64 = -9.0+t37+t2-72.0*t3+348.0*t6-696.0*t8+72.0*t10-t41+t42-t17+t20;
  t66 = 81.0*eta;
  t68 = 432.0*t6;
  t69 = 864.0*t8;
  t84 = 2688.0*xi;
  t89 = 8064.0*t12;
  t90 = 16128.0*t14;
  t101 = 336.0*xi;
  t106 = 1680.0*t12;
  t107 = 3360.0*t14;

  values[0] = t21;
  values[1] = 324.0*xi-t23+1080.0*t6-2160.0*t8-t26+t27-t28+t29;
  values[2] = -135.0*xi+t23-324.0*t6+648.0*t8+t26-t27+t34-t35;
  values[3] = t37-348.0*t3+72.0*t6-144.0*t8+t11-t41+t42-216.0*t16+216.0*t19;
  values[4] = 81.0*xi-648.0*t3+108.0*t6-216.0*t8+t50-t51+t52+t34-t35;
  values[5] = 108.0*xi-108.0*t3+648.0*t6-1296.0*t8-t58-t51+t52-t28+t29;
  values[6] = t64;
  values[7] = 36.0-162.0*xi-t66+324.0*t3-t68+t69-t58+t26-t27;
  values[8] = -45.0+351.0*xi+t66-1080.0*t3+t68-t69+t50-t26+t27;
  values[9] = -840.0*xi+2520.0*t3-2520.0*t6+5040.0*t8-2520.0*t10+2520.0*t12-5040.0*t14+7560.0*t16-7560.0*t19;
  values[10] = t84-4032.0*t3+8064.0*t6-16128.0*t8-4032.0*t10-t89+t90-24192.0*t16+24192.0*t19;
  values[11] = t84-8064.0*t3+4032.0*t6-8064.0*t8+8064.0*t10-t89+t90+12096.0*t16-12096.0*t19;
  values[12] = -t101+1680.0*t3-672.0*t6+1344.0*t8-1680.0*t10+t106-t107+1008.0*t16-1008.0*t19;
  values[13] = -t101+1176.0*t3-1176.0*t6+2352.0*t8-840.0*t10+2184.0*t12-4368.0*t14+2520.0*t16-2520.0*t19;
  values[14] = -t101+672.0*t3-1680.0*t6+3360.0*t8-336.0*t10+t106-t107+5040.0*t16-5040.0*t19;
}

// ***********************************************************************

TBaseFunct2D *BF_C_T_UL3_2D_Obj = new TBaseFunct2D
        (15, BF_C_T_UL3_2D, BFUnitTriangle, 
         C_T_UL3_2D_Funct, C_T_UL3_2D_DeriveXi,
         C_T_UL3_2D_DeriveEta, C_T_UL3_2D_DeriveXiXi,
         C_T_UL3_2D_DeriveXiEta, C_T_UL3_2D_DeriveEtaEta, 5, 3,
         0, NULL);
