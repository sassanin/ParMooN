/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// Q4 element with bubbles, conforming, 2D
// ***********************************************************************

// base function values
static void C_Q_UL4SE_2D_Funct(double xi, double eta, double *values)
{
  double t1 = 145.0/2304.0*xi;
  double t2 = xi*xi;
  double t3 = 73.0/2304.0*t2;
  double t4 = t2*xi;
  double t5 = 37.0/768.0*t4;
  double t6 = 145.0/2304.0*eta;
  double t7 = xi*eta;
  double t8 = 13.0/768.0*t7;
  double t9 = t2*eta;
  double t10 = 47.0/2304.0*t9;
  double t11 = t4*eta;
  double t12 = 77.0/768.0*t11;
  double t13 = eta*eta;
  double t14 = 73.0/2304.0*t13;
  double t15 = xi*t13;
  double t16 = 47.0/2304.0*t15;
  double t17 = t2*t13;
  double t18 = 253.0/768.0*t17;
  double t19 = t4*t13;
  double t20 = 293.0/768.0*t19;
  double t21 = t13*eta;
  double t22 = 37.0/768.0*t21;
  double t23 = xi*t21;
  double t24 = 77.0/768.0*t23;
  double t25 = t2*t21;
  double t26 = 293.0/768.0*t25;
  double t27 = t4*t21;
  double t28 = 111.0/256.0*t27;
  double t30 = 1.0-t2;
  double t33 = -1.0/2.0+3.0/2.0*t2;
  double t34 = (1.0-eta)*t30*t33;
  double t35 = 2.0/9.0*t34;
  double t37 = 1.0-t13;
  double t40 = -1.0/2.0+3.0/2.0*t13;
  double t41 = (1.0-xi)*t37*t40;
  double t42 = 2.0/9.0*t41;
  double t43 = -329.0/2304.0+t1+t3+t5+t6+t8+t10-t12+t14+t16+t18-t20+t22-t24-t26+t28-t35-t42;
  double t44 = xi/12.0;
  double t45 = 5.0/18.0*t2;
  double t46 = t4/12.0;
  double t47 = 5.0/18.0*eta;
  double t48 = t7/12.0;
  double t49 = 5.0/18.0*t9;
  double t50 = t11/12.0;
  double t51 = t13/6.0;
  double t52 = 3.0/4.0*t15;
  double t53 = t17/6.0;
  double t54 = 3.0/4.0*t19;
  double t55 = t21/6.0;
  double t56 = 3.0/4.0*t23;
  double t57 = t25/6.0;
  double t58 = 3.0/4.0*t27;
  double t59 = 8.0/9.0*t34;
  double t60 = 5.0/18.0+t44-t45-t46-t47-t48+t49+t50+t51-t52-t53+t54-t55+t56+t57-t58+t59;
  double t61 = 23.0/48.0*t2;
  double t62 = 23.0/48.0*eta;
  double t63 = 23.0/48.0*t9;
  double t64 = 5.0/16.0*t13;
  double t65 = 5.0/16.0*t17;
  double t66 = 5.0/16.0*t21;
  double t67 = 5.0/16.0*t25;
  double t70 = 5.0/18.0-t44-t45+t46-t47+t48+t49-t50+t51+t52-t53-t54-t55-t56+t57+t58+t59;
  double t73 = (1.0+xi)*t37*t40;
  double t74 = 2.0/9.0*t73;
  double t75 = -329.0/2304.0-t1+t3-t5+t6-t8+t10+t12+t14-t16+t18+t20+t22+t24-t26-t28-t35-t74;
  double t76 = 5.0/18.0*xi;
  double t77 = t2/6.0;
  double t78 = t4/6.0;
  double t79 = eta/12.0;
  double t80 = 3.0/4.0*t9;
  double t81 = 3.0/4.0*t11;
  double t82 = 5.0/18.0*t13;
  double t83 = 5.0/18.0*t15;
  double t84 = t19/6.0;
  double t85 = t21/12.0;
  double t86 = t23/12.0;
  double t87 = 3.0/4.0*t25;
  double t88 = 8.0/9.0*t73;
  double t89 = 5.0/18.0+t76+t77+t78+t79+t48-t80-t81-t82-t83-t53-t84-t85-t86+t87+t58+t88;
  double t90 = 23.0/48.0*xi;
  double t91 = 5.0/16.0*t2;
  double t92 = 5.0/16.0*t4;
  double t93 = 23.0/48.0*t13;
  double t94 = 23.0/48.0*t15;
  double t95 = 5.0/16.0*t19;
  double t98 = 5.0/18.0+t76+t77+t78-t79-t48+t80+t81-t82-t83-t53-t84+t85+t86-t87-t58+t88;
  double t101 = (1.0+eta)*t30*t33;
  double t102 = 2.0/9.0*t101;
  double t103 = -329.0/2304.0-t1+t3-t5-t6+t8-t10-t12+t14-t16+t18+t20-t22-t24+t26+t28-t102-t74;
  double t104 = 8.0/9.0*t101;
  double t105 = 5.0/18.0-t44-t45+t46+t47-t48-t49+t50+t51+t52-t53-t54+t55+t56-t57-t58+t104;
  double t108 = 5.0/18.0+t44-t45-t46+t47+t48-t49-t50+t51-t52-t53+t54+t55-t56-t57+t58+t104;
  double t109 = -329.0/2304.0+t1+t3+t5-t6-t8-t10+t12+t14+t16+t18-t20-t22+t24+t26-t28-t102-t42;
  double t110 = 8.0/9.0*t41;
  double t111 = 5.0/18.0-t76+t77-t78-t79+t48+t80-t81-t82+t83-t53+t84+t85-t86-t87+t58+t110;
  double t114 = 5.0/18.0-t76+t77-t78+t79-t48-t80+t81-t82+t83-t53+t84-t85+t86+t87-t58+t110;
  double t115 = 243.0/256.0*xi;
  double t116 = 81.0/256.0*t2;
  double t117 = 243.0/256.0*t4;
  double t118 = 243.0/256.0*eta;
  double t119 = 729.0/256.0*t7;
  double t120 = 243.0/256.0*t9;
  double t121 = 729.0/256.0*t11;
  double t122 = 81.0/256.0*t13;
  double t123 = 243.0/256.0*t15;
  double t124 = 81.0/256.0*t17;
  double t125 = 243.0/256.0*t19;
  double t126 = 243.0/256.0*t21;
  double t127 = 729.0/256.0*t23;
  double t128 = 243.0/256.0*t25;
  double t129 = 729.0/256.0*t27;
  double t130 = 81.0/256.0-t115-t116+t117-t118+t119+t120-t121-t122+t123+t124-t125+t126-t127-t128+t129;
  double t131 = 81.0/256.0-t115-t116+t117+t118-t119-t120+t121-t122+t123+t124-t125-t126+t127+t128-t129;
  double t132 = 81.0/256.0+t115-t116-t117-t118-t119+t120+t121-t122-t123+t124+t125+t126+t127-t128-t129;
  double t133 = 81.0/256.0+t115-t116-t117+t118+t119-t120-t121-t122-t123+t124+t125-t126-t127+t128+t129;
  values[0] = t43;
  values[1] = t60;
  values[2] = -23.0/48.0+t61+t62-t63+t64-t65-t66+t67-4.0/3.0*t34;
  values[3] = t70;
  values[4] = t75;
  values[5] = t89;
  values[6] = -23.0/48.0-t90+t91+t92+t93+t94-t65-t95-4.0/3.0*t73;
  values[7] = t98;
  values[8] = t103;
  values[9] = t105;
  values[10] = -23.0/48.0+t61-t62+t63+t64-t65+t66-t67-4.0/3.0*t101;
  values[11] = t108;
  values[12] = t109;
  values[13] = t111;
  values[14] = -23.0/48.0+t90+t91-t92+t93-t94-t65+t95-4.0/3.0*t41;
  values[15] = t114;
  values[16] = t130;
  values[17] = t131;
  values[18] = t132;
  values[19] = t133;
}

// values of the derivatives in xi direction
static void C_Q_UL4SE_2D_DeriveXi(double xi, double eta, double *values)
{
  double t1 = 73.0/1152.0*xi;
  double t2 = xi*xi;
  double t3 = 37.0/256.0*t2;
  double t4 = 13.0/768.0*eta;
  double t5 = xi*eta;
  double t6 = 47.0/1152.0*t5;
  double t7 = t2*eta;
  double t8 = 77.0/256.0*t7;
  double t9 = eta*eta;
  double t10 = 47.0/2304.0*t9;
  double t11 = xi*t9;
  double t12 = 253.0/384.0*t11;
  double t13 = t2*t9;
  double t14 = 293.0/256.0*t13;
  double t15 = t9*eta;
  double t16 = 77.0/768.0*t15;
  double t17 = xi*t15;
  double t18 = 293.0/384.0*t17;
  double t19 = t2*t15;
  double t20 = 333.0/256.0*t19;
  double t21 = 1.0-eta;
  double t24 = -1.0/2.0+3.0/2.0*t2;
  double t25 = t21*xi*t24;
  double t26 = 4.0/9.0*t25;
  double t27 = 1.0-t2;
  double t29 = t21*t27*xi;
  double t30 = 2.0/3.0*t29;
  double t34 = (1.0-t9)*(-1.0/2.0+3.0/2.0*t9);
  double t35 = 2.0/9.0*t34;
  double t36 = 145.0/2304.0+t1+t3+t4+t6-t8+t10+t12-t14-t16-t18+t20+t26-t30+t35;
  double t37 = 5.0/9.0*xi;
  double t38 = t2/4.0;
  double t39 = eta/12.0;
  double t40 = 5.0/9.0*t5;
  double t41 = t7/4.0;
  double t42 = 3.0/4.0*t9;
  double t43 = t11/3.0;
  double t44 = 9.0/4.0*t13;
  double t45 = 3.0/4.0*t15;
  double t46 = t17/3.0;
  double t47 = 9.0/4.0*t19;
  double t48 = 16.0/9.0*t25;
  double t49 = 8.0/3.0*t29;
  double t50 = 1.0/12.0-t37-t38-t39+t40+t41-t42-t43+t44+t45+t46-t47-t48+t49;
  double t51 = 23.0/24.0*xi;
  double t52 = 23.0/24.0*t5;
  double t53 = 5.0/8.0*t11;
  double t54 = 5.0/8.0*t17;
  double t58 = -1.0/12.0-t37+t38+t39+t40-t41+t42-t43-t44-t45+t46+t47-t48+t49;
  double t59 = -145.0/2304.0+t1-t3-t4+t6+t8-t10+t12+t14+t16-t18-t20+t26-t30-t35;
  double t60 = xi/3.0;
  double t61 = t2/2.0;
  double t62 = 3.0/2.0*t5;
  double t63 = 9.0/4.0*t7;
  double t64 = 5.0/18.0*t9;
  double t65 = t13/2.0;
  double t66 = t15/12.0;
  double t67 = 3.0/2.0*t17;
  double t68 = 8.0/9.0*t34;
  double t69 = 5.0/18.0+t60+t61+t39-t62-t63-t64-t43-t65-t66+t67+t47+t68;
  double t70 = 5.0/8.0*xi;
  double t71 = 15.0/16.0*t2;
  double t72 = 23.0/48.0*t9;
  double t73 = 15.0/16.0*t13;
  double t74 = 4.0/3.0*t34;
  double t76 = 5.0/18.0+t60+t61-t39+t62+t63-t64-t43-t65+t66-t67-t47+t68;
  double t77 = 1.0+eta;
  double t79 = t77*xi*t24;
  double t80 = 4.0/9.0*t79;
  double t82 = t77*t27*xi;
  double t83 = 2.0/3.0*t82;
  double t84 = -145.0/2304.0+t1-t3+t4-t6-t8-t10+t12+t14-t16+t18+t20+t80-t83-t35;
  double t85 = 16.0/9.0*t79;
  double t86 = 8.0/3.0*t82;
  double t87 = -1.0/12.0-t37+t38-t39-t40+t41+t42-t43-t44+t45-t46-t47-t85+t86;
  double t91 = 1.0/12.0-t37-t38+t39-t40-t41-t42-t43+t44-t45-t46+t47-t85+t86;
  double t92 = 145.0/2304.0+t1+t3-t4-t6+t8+t10+t12-t14+t16+t18-t20+t80-t83+t35;
  double t93 = -5.0/18.0+t60-t61+t39+t62-t63+t64-t43+t65-t66-t67+t47-t68;
  double t95 = -5.0/18.0+t60-t61-t39-t62+t63+t64-t43+t65+t66+t67-t47-t68;
  double t96 = 81.0/128.0*xi;
  double t97 = 729.0/256.0*t2;
  double t98 = 729.0/256.0*eta;
  double t99 = 243.0/128.0*t5;
  double t100 = 2187.0/256.0*t7;
  double t101 = 243.0/256.0*t9;
  double t102 = 81.0/128.0*t11;
  double t103 = 729.0/256.0*t13;
  double t104 = 729.0/256.0*t15;
  double t105 = 243.0/128.0*t17;
  double t106 = 2187.0/256.0*t19;
  double t107 = -243.0/256.0-t96+t97+t98+t99-t100+t101+t102-t103-t104-t105+t106;
  double t108 = -243.0/256.0-t96+t97-t98-t99+t100+t101+t102-t103+t104+t105-t106;
  double t109 = 243.0/256.0-t96-t97-t98+t99+t100-t101+t102+t103+t104-t105-t106;
  double t110 = 243.0/256.0-t96-t97+t98-t99-t100-t101+t102+t103-t104+t105+t106;
  values[0] = t36;
  values[1] = t50;
  values[2] = t51-t52-t53+t54+8.0/3.0*t25-4.0*t29;
  values[3] = t58;
  values[4] = t59;
  values[5] = t69;
  values[6] = -23.0/48.0+t70+t71+t72-t53-t73-t74;
  values[7] = t76;
  values[8] = t84;
  values[9] = t87;
  values[10] = t51+t52-t53-t54+8.0/3.0*t79-4.0*t82;
  values[11] = t91;
  values[12] = t92;
  values[13] = t93;
  values[14] = 23.0/48.0+t70-t71-t72-t53+t73+t74;
  values[15] = t95;
  values[16] = t107;
  values[17] = t108;
  values[18] = t109;
  values[19] = t110;
}

// values of the derivatives in eta direction
static void C_Q_UL4SE_2D_DeriveEta(double xi, double eta, double *values)
{
  double t1 = 13.0/768.0*xi;
  double t2 = xi*xi;
  double t3 = 47.0/2304.0*t2;
  double t4 = t2*xi;
  double t5 = 77.0/768.0*t4;
  double t6 = 73.0/1152.0*eta;
  double t7 = xi*eta;
  double t8 = 47.0/1152.0*t7;
  double t9 = t2*eta;
  double t10 = 253.0/384.0*t9;
  double t11 = t4*eta;
  double t12 = 293.0/384.0*t11;
  double t13 = eta*eta;
  double t14 = 37.0/256.0*t13;
  double t15 = xi*t13;
  double t16 = 77.0/256.0*t15;
  double t17 = t2*t13;
  double t18 = 293.0/256.0*t17;
  double t19 = t4*t13;
  double t20 = 333.0/256.0*t19;
  double t24 = (1.0-t2)*(-1.0/2.0+3.0/2.0*t2);
  double t25 = 2.0/9.0*t24;
  double t26 = 1.0-xi;
  double t29 = -1.0/2.0+3.0/2.0*t13;
  double t30 = t26*eta*t29;
  double t31 = 4.0/9.0*t30;
  double t32 = 1.0-t13;
  double t34 = t26*t32*eta;
  double t35 = 2.0/3.0*t34;
  double t36 = 145.0/2304.0+t1+t3-t5+t6+t8+t10-t12+t14-t16-t18+t20+t25+t31-t35;
  double t37 = xi/12.0;
  double t38 = 5.0/18.0*t2;
  double t39 = t4/12.0;
  double t40 = eta/3.0;
  double t41 = 3.0/2.0*t7;
  double t42 = t9/3.0;
  double t43 = 3.0/2.0*t11;
  double t44 = t13/2.0;
  double t45 = 9.0/4.0*t15;
  double t46 = t17/2.0;
  double t47 = 9.0/4.0*t19;
  double t48 = 8.0/9.0*t24;
  double t49 = -5.0/18.0-t37+t38+t39+t40-t41-t42+t43-t44+t45+t46-t47-t48;
  double t50 = 23.0/48.0*t2;
  double t51 = 5.0/8.0*eta;
  double t52 = 5.0/8.0*t9;
  double t53 = 15.0/16.0*t13;
  double t54 = 15.0/16.0*t17;
  double t55 = 4.0/3.0*t24;
  double t57 = -5.0/18.0+t37+t38-t39+t40+t41-t42-t43-t44-t45+t46+t47-t48;
  double t58 = 1.0+xi;
  double t60 = t58*eta*t29;
  double t61 = 4.0/9.0*t60;
  double t63 = t58*t32*eta;
  double t64 = 2.0/3.0*t63;
  double t65 = 145.0/2304.0-t1+t3+t5+t6-t8+t10+t12+t14+t16-t18-t20+t25+t61-t64;
  double t66 = 3.0/4.0*t2;
  double t67 = 3.0/4.0*t4;
  double t68 = 5.0/9.0*eta;
  double t69 = 5.0/9.0*t7;
  double t70 = t11/3.0;
  double t71 = t13/4.0;
  double t72 = t15/4.0;
  double t73 = 9.0/4.0*t17;
  double t74 = 16.0/9.0*t60;
  double t75 = 8.0/3.0*t63;
  double t76 = 1.0/12.0+t37-t66-t67-t68-t69-t42-t70-t71-t72+t73+t47-t74+t75;
  double t77 = 23.0/24.0*eta;
  double t78 = 23.0/24.0*t7;
  double t79 = 5.0/8.0*t11;
  double t83 = -1.0/12.0-t37+t66+t67-t68-t69-t42-t70+t71+t72-t73-t47-t74+t75;
  double t84 = -145.0/2304.0+t1-t3-t5+t6-t8+t10+t12-t14-t16+t18+t20-t25+t61-t64;
  double t85 = 5.0/18.0-t37-t38+t39+t40+t41-t42-t43+t44+t45-t46-t47+t48;
  double t87 = 5.0/18.0+t37-t38-t39+t40-t41-t42+t43+t44-t45-t46+t47+t48;
  double t88 = -145.0/2304.0-t1-t3+t5+t6+t8+t10-t12-t14+t16+t18-t20-t25+t31-t35;
  double t89 = 16.0/9.0*t30;
  double t90 = 8.0/3.0*t34;
  double t91 = -1.0/12.0+t37+t66-t67-t68+t69-t42+t70+t71-t72-t73+t47-t89+t90;
  double t95 = 1.0/12.0-t37-t66+t67-t68+t69-t42+t70-t71+t72+t73-t47-t89+t90;
  double t96 = 729.0/256.0*xi;
  double t97 = 243.0/256.0*t2;
  double t98 = 729.0/256.0*t4;
  double t99 = 81.0/128.0*eta;
  double t100 = 243.0/128.0*t7;
  double t101 = 81.0/128.0*t9;
  double t102 = 243.0/128.0*t11;
  double t103 = 729.0/256.0*t13;
  double t104 = 2187.0/256.0*t15;
  double t105 = 729.0/256.0*t17;
  double t106 = 2187.0/256.0*t19;
  double t107 = -243.0/256.0+t96+t97-t98-t99+t100+t101-t102+t103-t104-t105+t106;
  double t108 = 243.0/256.0-t96-t97+t98-t99+t100+t101-t102-t103+t104+t105-t106;
  double t109 = -243.0/256.0-t96+t97+t98-t99-t100+t101+t102+t103+t104-t105-t106;
  double t110 = 243.0/256.0+t96-t97-t98-t99-t100+t101+t102-t103-t104+t105+t106;
  values[0] = t36;
  values[1] = t49;
  values[2] = 23.0/48.0-t50+t51-t52-t53+t54+t55;
  values[3] = t57;
  values[4] = t65;
  values[5] = t76;
  values[6] = t77+t78-t52-t79+8.0/3.0*t60-4.0*t63;
  values[7] = t83;
  values[8] = t84;
  values[9] = t85;
  values[10] = -23.0/48.0+t50+t51-t52+t53-t54-t55;
  values[11] = t87;
  values[12] = t88;
  values[13] = t91;
  values[14] = t77-t78-t52+t79+8.0/3.0*t30-4.0*t34;
  values[15] = t95;
  values[16] = t107;
  values[17] = t108;
  values[18] = t109;
  values[19] = t110;
}

// values of the derivatives in xi-xi  direction
static void C_Q_UL4SE_2D_DeriveXiXi(double xi, double eta, double *values)
{
  double t1 = 37.0/128.0*xi;
  double t2 = 47.0/1152.0*eta;
  double t3 = xi*eta;
  double t4 = 77.0/128.0*t3;
  double t5 = eta*eta;
  double t6 = 253.0/384.0*t5;
  double t7 = xi*t5;
  double t8 = 293.0/128.0*t7;
  double t9 = t5*eta;
  double t10 = 293.0/384.0*t9;
  double t11 = xi*t9;
  double t12 = 333.0/128.0*t11;
  double t13 = 1.0-eta;
  double t14 = xi*xi;
  double t16 = -1.0/2.0+3.0/2.0*t14;
  double t17 = t13*t16;
  double t18 = 4.0/9.0*t17;
  double t19 = t13*t14;
  double t20 = 8.0/3.0*t19;
  double t21 = 1.0-t14;
  double t22 = t13*t21;
  double t23 = 2.0/3.0*t22;
  double t24 = 73.0/1152.0+t1+t2-t4+t6-t8-t10+t12+t18+t20-t23;
  double t25 = xi/2.0;
  double t26 = 5.0/9.0*eta;
  double t27 = t3/2.0;
  double t28 = t5/3.0;
  double t29 = 9.0/2.0*t7;
  double t30 = t9/3.0;
  double t31 = 9.0/2.0*t11;
  double t32 = 16.0/9.0*t17;
  double t33 = 32.0/3.0*t19;
  double t34 = 8.0/3.0*t22;
  double t35 = -5.0/9.0-t25+t26+t27-t28+t29+t30-t31-t32-t33+t34;
  double t36 = 23.0/24.0*eta;
  double t37 = 5.0/8.0*t5;
  double t38 = 5.0/8.0*t9;
  double t43 = -5.0/9.0+t25+t26-t27-t28-t29+t30+t31-t32-t33+t34;
  double t44 = 73.0/1152.0-t1+t2+t4+t6+t8-t10-t12+t18+t20-t23;
  double t45 = 3.0/2.0*eta;
  double t46 = 9.0/2.0*t3;
  double t47 = 3.0/2.0*t9;
  double t49 = 15.0/8.0*xi;
  double t50 = 15.0/8.0*t7;
  double t53 = 1.0+eta;
  double t54 = t53*t16;
  double t55 = 4.0/9.0*t54;
  double t56 = t53*t14;
  double t57 = 8.0/3.0*t56;
  double t58 = t53*t21;
  double t59 = 2.0/3.0*t58;
  double t60 = 73.0/1152.0-t1-t2-t4+t6+t8+t10+t12+t55+t57-t59;
  double t61 = 16.0/9.0*t54;
  double t62 = 32.0/3.0*t56;
  double t63 = 8.0/3.0*t58;
  double t64 = -5.0/9.0+t25-t26+t27-t28-t29-t30-t31-t61-t62+t63;
  double t69 = -5.0/9.0-t25-t26-t27-t28+t29-t30+t31-t61-t62+t63;
  double t70 = 73.0/1152.0+t1-t2+t4+t6-t8+t10-t12+t55+t57-t59;
  double t74 = 729.0/128.0*xi;
  double t75 = 243.0/128.0*eta;
  double t76 = 2187.0/128.0*t3;
  double t77 = 81.0/128.0*t5;
  double t78 = 729.0/128.0*t7;
  double t79 = 243.0/128.0*t9;
  double t80 = 2187.0/128.0*t11;
  values[0] = t24;
  values[1] = t35;
  values[2] = 23.0/24.0-t36-t37+t38+8.0/3.0*t17+16.0*t19-4.0*t22;
  values[3] = t43;
  values[4] = t44;
  values[5] = 1.0/3.0+xi-t45-t46-t28-t7+t47+t31;
  values[6] = 5.0/8.0+t49-t37-t50;
  values[7] = 1.0/3.0+xi+t45+t46-t28-t7-t47-t31;
  values[8] = t60;
  values[9] = t64;
  values[10] = 23.0/24.0+t36-t37-t38+8.0/3.0*t54+16.0*t56-4.0*t58;
  values[11] = t69;
  values[12] = t70;
  values[13] = 1.0/3.0-xi+t45-t46-t28+t7-t47+t31;
  values[14] = 5.0/8.0-t49-t37+t50;
  values[15] = 1.0/3.0-xi-t45+t46-t28+t7+t47-t31;
  values[16] = -81.0/128.0+t74+t75-t76+t77-t78-t79+t80;
  values[17] = -81.0/128.0+t74-t75+t76+t77-t78+t79-t80;
  values[18] = -81.0/128.0-t74+t75+t76+t77+t78-t79-t80;
  values[19] = -81.0/128.0-t74-t75-t76+t77+t78+t79+t80;
}

// values of the derivatives in xi-eta direction
static void C_Q_UL4SE_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t1 = 47.0/1152.0*xi;
  double t2 = xi*xi;
  double t3 = 77.0/256.0*t2;
  double t4 = 47.0/1152.0*eta;
  double t5 = xi*eta;
  double t6 = 253.0/192.0*t5;
  double t7 = t2*eta;
  double t8 = 293.0/128.0*t7;
  double t9 = eta*eta;
  double t10 = 77.0/256.0*t9;
  double t11 = xi*t9;
  double t12 = 293.0/128.0*t11;
  double t13 = t2*t9;
  double t14 = 999.0/256.0*t13;
  double t17 = xi*(-1.0/2.0+3.0/2.0*t2);
  double t18 = 4.0/9.0*t17;
  double t20 = (1.0-t2)*xi;
  double t21 = 2.0/3.0*t20;
  double t24 = eta*(-1.0/2.0+3.0/2.0*t9);
  double t25 = 4.0/9.0*t24;
  double t27 = (1.0-t9)*eta;
  double t28 = 2.0/3.0*t27;
  double t29 = 13.0/768.0+t1-t3+t4+t6-t8-t10-t12+t14-t18+t21-t25+t28;
  double t30 = 5.0/9.0*xi;
  double t31 = t2/4.0;
  double t32 = 3.0/2.0*eta;
  double t33 = 2.0/3.0*t5;
  double t34 = 9.0/2.0*t7;
  double t35 = 9.0/4.0*t9;
  double t36 = 27.0/4.0*t13;
  double t37 = 16.0/9.0*t17;
  double t38 = 8.0/3.0*t20;
  double t39 = -1.0/12.0+t30+t31-t32-t33+t34+t35+t11-t36+t37-t38;
  double t40 = 23.0/24.0*xi;
  double t41 = 5.0/4.0*t5;
  double t42 = 15.0/8.0*t11;
  double t43 = 8.0/3.0*t17;
  double t44 = 4.0*t20;
  double t46 = 1.0/12.0+t30-t31+t32-t33-t34-t35+t11+t36+t37-t38;
  double t47 = -13.0/768.0+t1+t3-t4+t6+t8+t10-t12-t14-t18+t21+t25-t28;
  double t48 = 3.0/2.0*xi;
  double t49 = 9.0/4.0*t2;
  double t50 = 5.0/9.0*eta;
  double t51 = t9/4.0;
  double t52 = 9.0/2.0*t11;
  double t53 = 16.0/9.0*t24;
  double t54 = 8.0/3.0*t27;
  double t55 = 1.0/12.0-t48-t49-t50-t33-t7-t51+t52+t36-t53+t54;
  double t56 = 23.0/24.0*eta;
  double t57 = 15.0/8.0*t7;
  double t58 = 8.0/3.0*t24;
  double t59 = 4.0*t27;
  double t61 = -1.0/12.0+t48+t49-t50-t33-t7+t51-t52-t36-t53+t54;
  double t62 = 13.0/768.0-t1-t3-t4+t6+t8-t10+t12+t14+t18-t21+t25-t28;
  double t63 = -1.0/12.0-t30+t31+t32-t33-t34+t35-t11-t36-t37+t38;
  double t65 = 1.0/12.0-t30-t31-t32-t33+t34-t35-t11+t36-t37+t38;
  double t66 = -13.0/768.0-t1+t3+t4+t6-t8+t10+t12-t14+t18-t21-t25+t28;
  double t67 = 1.0/12.0+t48-t49+t50-t33+t7-t51-t52+t36+t53-t54;
  double t69 = -1.0/12.0-t48+t49+t50-t33+t7+t51+t52-t36+t53-t54;
  double t70 = 243.0/128.0*xi;
  double t71 = 2187.0/256.0*t2;
  double t72 = 243.0/128.0*eta;
  double t73 = 81.0/64.0*t5;
  double t74 = 729.0/128.0*t7;
  double t75 = 2187.0/256.0*t9;
  double t76 = 729.0/128.0*t11;
  double t77 = 6561.0/256.0*t13;
  values[0] = t29;
  values[1] = t39;
  values[2] = -t40-t41+t42-t43+t44;
  values[3] = t46;
  values[4] = t47;
  values[5] = t55;
  values[6] = t56-t41-t57+t58-t59;
  values[7] = t61;
  values[8] = t62;
  values[9] = t63;
  values[10] = t40-t41-t42+t43-t44;
  values[11] = t65;
  values[12] = t66;
  values[13] = t67;
  values[14] = -t56-t41+t57-t58+t59;
  values[15] = t69;
  values[16] = 729.0/256.0+t70-t71+t72+t73-t74-t75-t76+t77;
  values[17] = -729.0/256.0-t70+t71+t72+t73-t74+t75+t76-t77;
  values[18] = -729.0/256.0+t70+t71-t72+t73+t74+t75-t76-t77;
  values[19] = 729.0/256.0-t70-t71-t72+t73+t74-t75+t76+t77;
}

// values of the derivatives in eta-eta direction
static void C_Q_UL4SE_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double t1 = 47.0/1152.0*xi;
  double t2 = xi*xi;
  double t3 = 253.0/384.0*t2;
  double t4 = t2*xi;
  double t5 = 293.0/384.0*t4;
  double t6 = 37.0/128.0*eta;
  double t7 = xi*eta;
  double t8 = 77.0/128.0*t7;
  double t9 = t2*eta;
  double t10 = 293.0/128.0*t9;
  double t11 = t4*eta;
  double t12 = 333.0/128.0*t11;
  double t13 = 1.0-xi;
  double t14 = eta*eta;
  double t16 = -1.0/2.0+3.0/2.0*t14;
  double t17 = t13*t16;
  double t18 = 4.0/9.0*t17;
  double t19 = t13*t14;
  double t20 = 8.0/3.0*t19;
  double t21 = 1.0-t14;
  double t22 = t13*t21;
  double t23 = 2.0/3.0*t22;
  double t24 = 73.0/1152.0+t1+t3-t5+t6-t8-t10+t12+t18+t20-t23;
  double t25 = 3.0/2.0*xi;
  double t26 = t2/3.0;
  double t27 = 3.0/2.0*t4;
  double t28 = 9.0/2.0*t7;
  double t29 = 9.0/2.0*t11;
  double t31 = 5.0/8.0*t2;
  double t32 = 15.0/8.0*eta;
  double t33 = 15.0/8.0*t9;
  double t36 = 1.0+xi;
  double t37 = t36*t16;
  double t38 = 4.0/9.0*t37;
  double t39 = t36*t14;
  double t40 = 8.0/3.0*t39;
  double t41 = t36*t21;
  double t42 = 2.0/3.0*t41;
  double t43 = 73.0/1152.0-t1+t3+t5+t6+t8-t10-t12+t38+t40-t42;
  double t44 = 5.0/9.0*xi;
  double t45 = t4/3.0;
  double t46 = eta/2.0;
  double t47 = t7/2.0;
  double t48 = 9.0/2.0*t9;
  double t49 = 16.0/9.0*t37;
  double t50 = 32.0/3.0*t39;
  double t51 = 8.0/3.0*t41;
  double t52 = -5.0/9.0-t44-t26-t45-t46-t47+t48+t29-t49-t50+t51;
  double t53 = 23.0/24.0*xi;
  double t54 = 5.0/8.0*t4;
  double t59 = -5.0/9.0-t44-t26-t45+t46+t47-t48-t29-t49-t50+t51;
  double t60 = 73.0/1152.0-t1+t3+t5-t6-t8+t10+t12+t38+t40-t42;
  double t64 = 73.0/1152.0+t1+t3-t5-t6+t8+t10-t12+t18+t20-t23;
  double t65 = 16.0/9.0*t17;
  double t66 = 32.0/3.0*t19;
  double t67 = 8.0/3.0*t22;
  double t68 = -5.0/9.0+t44-t26+t45+t46-t47-t48+t29-t65-t66+t67;
  double t73 = -5.0/9.0+t44-t26+t45-t46+t47+t48-t29-t65-t66+t67;
  double t74 = 243.0/128.0*xi;
  double t75 = 81.0/128.0*t2;
  double t76 = 243.0/128.0*t4;
  double t77 = 729.0/128.0*eta;
  double t78 = 2187.0/128.0*t7;
  double t79 = 729.0/128.0*t9;
  double t80 = 2187.0/128.0*t11;
  values[0] = t24;
  values[1] = 1.0/3.0-t25-t26+t27-eta+t28+t9-t29;
  values[2] = 5.0/8.0-t31-t32+t33;
  values[3] = 1.0/3.0+t25-t26-t27-eta-t28+t9+t29;
  values[4] = t43;
  values[5] = t52;
  values[6] = 23.0/24.0+t53-t31-t54+8.0/3.0*t37+16.0*t39-4.0*t41;
  values[7] = t59;
  values[8] = t60;
  values[9] = 1.0/3.0+t25-t26-t27+eta+t28-t9-t29;
  values[10] = 5.0/8.0-t31+t32-t33;
  values[11] = 1.0/3.0-t25-t26+t27+eta-t28-t9+t29;
  values[12] = t64;
  values[13] = t68;
  values[14] = 23.0/24.0-t53-t31+t54+8.0/3.0*t17+16.0*t19-4.0*t22;
  values[15] = t73;
  values[16] = -81.0/128.0+t74+t75-t76+t77-t78-t79+t80;
  values[17] = -81.0/128.0+t74+t75-t76-t77+t78+t79-t80;
  values[18] = -81.0/128.0-t74+t75+t76+t77+t78-t79-t80;
  values[19] = -81.0/128.0-t74+t75+t76-t77-t78+t79+t80;
}

// ***********************************************************************

TBaseFunct2D *BF_C_Q_UL4SE_2D_Obj = new TBaseFunct2D
        (20, BF_C_Q_UL4SE_2D, BFUnitSquare, 
         C_Q_UL4SE_2D_Funct, C_Q_UL4SE_2D_DeriveXi,
         C_Q_UL4SE_2D_DeriveEta, C_Q_UL4SE_2D_DeriveXiXi,
         C_Q_UL4SE_2D_DeriveXiEta, C_Q_UL4SE_2D_DeriveEtaEta, 4, 4,
         0, NULL);
