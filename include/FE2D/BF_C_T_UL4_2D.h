/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ********************************************************************
// P4 element with bubbles, conforming, 2D
// ********************************************************************

// base function values
static void C_T_UL4_2D_Funct(double xi, double eta, double *values)
{     
  double t3, t5, t7, t9, t11, t13, t15, t17, t18, t19, t20, t22, t24, t26;
  double t27, t28, t29, t31, t33, t36, t37, t39, t42, t45, t46, t47, t51;
  double t55, t57, t59, t60, t62, t64, t65, t68, t74, t76, t77, t78, t79;
  double t80, t81, t82, t85, t90, t92, t95, t96, t98, t103, t106, t108;
  double t109, t110, t111, t117, t119, t122, t132, t135, t142, t145, t154;
  double t162, t164, t166, t167, t176, t186, t188, t189, t190, t192, t197;
  double t201, t204, t206, t207, t208, t209, t216, t217, t218, t222, t225;
  double t226, t227, t228, t234, t237, t243, t244, t248, t251, t257, t263;
  double t268, t278, t289;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t17 = t3*t3;
  t18 = 32.0/3.0*t17;
  t19 = 1.0-25.0/3.0*xi-25.0/3.0*eta+70.0/3.0*t3-140.0*t5+70.0/3.0*t7-80.0/3.0*t9+3320.0/3.0*t11+3320.0/3.0*t13-80.0/3.0*t15+t18;
  t20 = t9*eta;
  t22 = t3*t7;
  t24 = xi*t15;
  t26 = t7*t7;
  t27 = 32.0/3.0*t26;
  t28 = 1.0-xi-eta;
  t29 = t20*t28;
  t31 = t22*t28;
  t33 = t24*t28;
  t36 = t17*eta*t28;
  t37 = 2750.0/3.0*t36;
  t39 = t9*t7*t28;
  t42 = t3*t15*t28;
  t45 = xi*t26*t28;
  t46 = 2750.0/3.0*t45;
  t47 = -2872.0/3.0*t20-1936.0*t22-2872.0/3.0*t24+t27-5080.0/3.0*t29-3260.0*t31-5080.0/3.0*t33+t37+7700.0/3.0*t39+7700.0/3.0*t42+t46;
  t51 = 1264.0/3.0*t5;
  t55 = 128.0/3.0*t17;
  t57 = 3328.0*t22;
  t59 = 2560.0/3.0*t29;
  t60 = 4640.0*t31;
  t62 = 7040.0/3.0*t39;
  t64 = 6160.0/3.0*t45;
  t65 = 16.0*xi-208.0/3.0*t3-t51+96.0*t9+4928.0/3.0*t11+7648.0/3.0*t13-t55-3680.0/3.0*t20-t57-2144.0*t24-t59-t60-11200.0/3.0*t33+t62+12320.0/3.0*t42+t64;
  t68 = 268.0*t5;
  t74 = 2400.0*t22;
  t76 = 1280.0*t29;
  t77 = 4800.0*t31;
  t78 = 1280.0*t33;
  t79 = 3520.0*t39;
  t80 = 3520.0*t42;
  t81 = 440.0*t45;
  t82 = -12.0*xi+76.0*t3+t68-128.0*t9-1664.0*t11-1312.0*t13+64.0*t17+1408.0*t20+t74+1056.0*t24+t76+t77+t78-t79-t80-t81;
  t85 = 112.0*t5;
  t90 = 1024.0*t22;
  t92 = 1760.0*t31;
  t95 = 880.0/3.0*t45;
  t96 = 16.0/3.0*xi-112.0/3.0*t3-t85+224.0/3.0*t9+2240.0/3.0*t11+1568.0/3.0*t13-t55-1952.0/3.0*t20-t90-416.0*t24-t59-t92-1600.0/3.0*t33+t62+1760.0/3.0*t42+t95;
  t98 = 110.0/3.0*t5;
  t103 = 420.0*t22;
  t106 = 240.0*t31;
  t108 = 550.0/3.0*t39;
  t109 = 550.0/3.0*t42;
  t110 = -xi+22.0/3.0*t3+t98-16.0*t9-400.0*t11-280.0/3.0*t13+t18+1090.0/3.0*t20+t103+170.0/3.0*t24+3170.0/3.0*t29+t106+170.0/3.0*t33-t37-t108-t109;
  t111 = 224.0/3.0*t5;
  t117 = 1280.0*t31;
  t119 = 6160.0/3.0*t36;
  t122 = t111-896.0*t11-896.0/3.0*t13+2512.0/3.0*t20+t90+688.0/3.0*t24+7280.0/3.0*t29+t117+1040.0/3.0*t33-t119-6160.0/3.0*t39-880.0/3.0*t42-t95;
  t132 = 440.0*t36;
  t135 = 28.0*t5-224.0*t11-224.0*t13+184.0*t20+432.0*t22+184.0*t24-40.0*t29+2160.0*t31-40.0*t33+t132-2200.0*t39-2200.0*t42+t81;
  t142 = 880.0/3.0*t36;
  t145 = t111-896.0/3.0*t11-896.0*t13+688.0/3.0*t20+t90+2512.0/3.0*t24+1040.0/3.0*t29+t117+7280.0/3.0*t33-t142-880.0/3.0*t39-6160.0/3.0*t42-t64;
  t154 = -eta+t98+22.0/3.0*t7-280.0/3.0*t11-400.0*t13-16.0*t15+170.0/3.0*t20+t103+1090.0/3.0*t24+t27+170.0/3.0*t29+t106+3170.0/3.0*t33-t108-t109-t46;
  t162 = 128.0/3.0*t26;
  t164 = 2560.0/3.0*t33;
  t166 = 7040.0/3.0*t42;
  t167 = 16.0/3.0*eta-t85-112.0/3.0*t7+1568.0/3.0*t11+2240.0/3.0*t13+224.0/3.0*t15-416.0*t20-t90-1952.0/3.0*t24-t162-1600.0/3.0*t29-t92-t164+t142+1760.0/3.0*t39+t166;
  t176 = -12.0*eta+t68+76.0*t7-1312.0*t11-1664.0*t13-128.0*t15+1056.0*t20+t74+1408.0*t24+64.0*t26+t76+t77+t78-t132-t79-t80;
  t186 = 16.0*eta-t51-208.0/3.0*t7+7648.0/3.0*t11+4928.0/3.0*t13+96.0*t15-2144.0*t20-t57-3680.0/3.0*t24-t162-11200.0/3.0*t29-t60-t164+t119+12320.0/3.0*t39+t166;
  t188 = 1680.0*t11;
  t189 = 1680.0*t13;
  t190 = 1260.0*t20;
  t192 = 1260.0*t24;
  t197 = 5040.0*t5;
  t201 = 50400.0*t22;
  t204 = 70560.0*t31;
  t206 = 55440.0*t36;
  t207 = 55440.0*t39;
  t208 = 55440.0*t42;
  t209 = -t197+40320.0*t11+20160.0*t13-35280.0*t20-t201-15120.0*t24-75600.0*t29-t204-15120.0*t33+t206+t207+t208;
  t216 = 55440.0*t45;
  t217 = -t197+20160.0*t11+40320.0*t13-15120.0*t20-t201-35280.0*t24-15120.0*t29-t204-75600.0*t33+t207+t208+t216;
  t218 = 300.0*t5;
  t222 = 2760.0*t22;
  t225 = 3300.0*t39;
  t226 = 3300.0*t42;
  t227 = 660.0*t45;
  t228 = t218-1800.0*t11-1560.0*t13+1500.0*t20+t222+t192+1500.0*t29+t77+1620.0*t33-t225-t226-t227;
  t234 = 660.0*t36;
  t237 = t218-t188-t189+1380.0*t20+t222+1380.0*t24+1740.0*t29+4260.0*t31+1740.0*t33-t234-2640.0*t39-2640.0*t42-t227;
  t243 = t218-1560.0*t11-1800.0*t13+t190+t222+1500.0*t24+1620.0*t29+t77+1500.0*t33-t234-t225-t226;
  t244 = 7920.0*t5;
  t248 = 95040.0*t22;
  t251 = 142560.0*t31;
  t257 = -t244+79200.0*t11+31680.0*t13-71280.0*t20-t248-23760.0*t24-166320.0*t29-t251-23760.0*t33+110880.0*t36+166320.0*t39+71280.0*t42+7920.0*t45;
  t263 = 190080.0*t31;
  t268 = -t244+63360.0*t11+47520.0*t13-55440.0*t20-t248-39600.0*t24-102960.0*t29-t263-55440.0*t33+t206+182160.0*t39+134640.0*t42+23760.0*t45;
  t278 = -t244+47520.0*t11+63360.0*t13-39600.0*t20-t248-55440.0*t24-55440.0*t29-t263-102960.0*t33+23760.0*t36+134640.0*t39+182160.0*t42+t216;
  t289 = -t244+31680.0*t11+79200.0*t13-23760.0*t20-t248-71280.0*t24-23760.0*t29-t251-166320.0*t33+7920.0*t36+71280.0*t39+166320.0*t42+110880.0*t45;

  values[0] = t19+t47;
  values[1] = t65;
  values[2] = t82;
  values[3] = t96;
  values[4] = t110;
  values[5] = t122;
  values[6] = t135;
  values[7] = t145;
  values[8] = t154;
  values[9] = t167;
  values[10] = t176;
  values[11] = t186;
  values[12] = 420.0*t5-t188-t189+t190+2520.0*t22+t192+1260.0*t29+1260.0*t31+1260.0*t33;
  values[13] = t209;
  values[14] = t217;
  values[15] = t228;
  values[16] = t237;
  values[17] = t243;
  values[18] = t257;
  values[19] = t268;
  values[20] = t278;
  values[21] = t289;
}

// values of the derivatives in xi direction
static void C_T_UL4_2D_DeriveXi(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t10, t11, t13, t15, t17, t18, t20, t22, t23, t25;
  double t27, t29, t31, t32, t33, t34, t35, t36, t38, t40, t42, t44, t45;
  double t46, t47, t48, t49, t52, t56, t58, t60, t61, t62, t63, t64, t67;
  double t68, t71, t72, t73, t76, t82, t84, t85, t86, t87, t88, t89, t90;
  double t91, t92, t93, t94, t95, t96, t97, t100, t105, t107, t108, t109;
  double t114, t115, t116, t119, t124, t127, t129, t130, t133, t134, t135;
  double t136, t137, t139, t146, t147, t150, t151, t156, t169, t170, t175;
  double t184, t185, t190, t199, t206, t207, t210, t211, t212, t217, t226;
  double t228, t229, t230, t232, t239, t240, t244, t248, t249, t252, t253;
  double t254, t255, t256, t257, t258, t267, t268, t269, t270, t274, t279;
  double t280, t281, t282, t283, t284, t285, t294, t295, t300, t308, t309;
  double t313, t317, t318, t329, t336, t337, t346, t361, t378;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t10 = 128.0/3.0*t9;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t17 = 1.0-xi-eta;
  t18 = t11*t17;
  t20 = t9*eta;
  t22 = -25.0/3.0+140.0/3.0*xi-140.0*eta-80.0*t3+6640.0/3.0*t5+3320.0/3.0*t7+t10-2872.0*t11-3872.0*t13-2872.0/3.0*t15-5080.0*t18+5080.0/3.0*t20;
  t23 = t13*t17;
  t25 = t3*t7;
  t27 = t15*t17;
  t29 = xi*t15;
  t31 = t20*t17;
  t32 = 11000.0/3.0*t31;
  t33 = t3*t3;
  t34 = t33*eta;
  t35 = 2750.0/3.0*t34;
  t36 = t25*t17;
  t38 = t9*t7;
  t40 = t29*t17;
  t42 = t3*t15;
  t44 = t7*t7;
  t45 = t44*t17;
  t46 = 2750.0/3.0*t45;
  t47 = xi*t44;
  t48 = 2750.0/3.0*t47;
  t49 = -6520.0*t23+3260.0*t25-5080.0/3.0*t27+5080.0/3.0*t29+t32-t35+7700.0*t36-7700.0/3.0*t38+15400.0/3.0*t40-7700.0/3.0*t42+t46-t48;
  t52 = 1264.0/3.0*eta;
  t56 = 512.0/3.0*t9;
  t58 = 6656.0*t13;
  t60 = 2560.0*t18;
  t61 = 16.0-416.0/3.0*xi-t52+288.0*t3+9856.0/3.0*t5+7648.0/3.0*t7-t56-3680.0*t11-t58-2144.0*t15-t60;
  t62 = 2560.0/3.0*t20;
  t63 = 9280.0*t23;
  t64 = 4640.0*t25;
  t67 = 7040.0*t36;
  t68 = 7040.0/3.0*t38;
  t71 = 6160.0/3.0*t45;
  t72 = 6160.0/3.0*t47;
  t73 = t62-t63+t64-11200.0/3.0*t27+11200.0/3.0*t29+t67-t68+24640.0/3.0*t40-12320.0/3.0*t42+t71-t72;
  t76 = 268.0*eta;
  t82 = 4800.0*t13;
  t84 = 3840.0*t18;
  t85 = -12.0+152.0*xi+t76-384.0*t3-3328.0*t5-1312.0*t7+256.0*t9+4224.0*t11+t82+1056.0*t15+t84;
  t86 = 1280.0*t20;
  t87 = 9600.0*t23;
  t88 = 4800.0*t25;
  t89 = 1280.0*t27;
  t90 = 1280.0*t29;
  t91 = 10560.0*t36;
  t92 = 3520.0*t38;
  t93 = 7040.0*t40;
  t94 = 3520.0*t42;
  t95 = 440.0*t45;
  t96 = 440.0*t47;
  t97 = -t86+t87-t88+t89-t90-t91+t92-t93+t94-t95+t96;
  t100 = 112.0*eta;
  t105 = 2048.0*t13;
  t107 = 16.0/3.0-224.0/3.0*xi-t100+224.0*t3+4480.0/3.0*t5+1568.0/3.0*t7-t56-1952.0*t11-t105-416.0*t15-t60;
  t108 = 3520.0*t23;
  t109 = 1760.0*t25;
  t114 = 880.0/3.0*t45;
  t115 = 880.0/3.0*t47;
  t116 = t62-t108+t109-1600.0/3.0*t27+1600.0/3.0*t29+t67-t68+3520.0/3.0*t40-1760.0/3.0*t42+t114-t115;
  t119 = 110.0/3.0*eta;
  t124 = 840.0*t13;
  t127 = -1.0+44.0/3.0*xi+t119-48.0*t3-800.0*t5-280.0/3.0*t7+t10+1090.0*t11+t124+170.0/3.0*t15+3170.0*t18;
  t129 = 480.0*t23;
  t130 = 240.0*t25;
  t133 = 550.0*t36;
  t134 = 550.0/3.0*t38;
  t135 = 1100.0/3.0*t40;
  t136 = 550.0/3.0*t42;
  t137 = -3170.0/3.0*t20+t129-t130+170.0/3.0*t27-170.0/3.0*t29-t32+t35-t133+t134-t135+t136;
  t139 = 224.0/3.0*eta;
  t146 = 2560.0*t23;
  t147 = 1280.0*t25;
  t150 = 24640.0/3.0*t31;
  t151 = 6160.0/3.0*t34;
  t156 = t139-1792.0*t5-896.0/3.0*t7+2512.0*t11+t105+688.0/3.0*t15+7280.0*t18-7280.0/3.0*t20+t146-t147+1040.0/3.0*t27-1040.0/3.0*t29-t150+t151-6160.0*t36+6160.0/3.0*t38-1760.0/3.0*t40+880.0/3.0*t42-t114+t115;
  t169 = 1760.0*t31;
  t170 = 440.0*t34;
  t175 = 28.0*eta-448.0*t5-224.0*t7+552.0*t11+864.0*t13+184.0*t15-120.0*t18+40.0*t20+4320.0*t23-2160.0*t25-40.0*t27+40.0*t29+t169-t170-6600.0*t36+2200.0*t38-4400.0*t40+2200.0*t42+t95-t96;
  t184 = 3520.0/3.0*t31;
  t185 = 880.0/3.0*t34;
  t190 = t139-1792.0/3.0*t5-896.0*t7+688.0*t11+t105+2512.0/3.0*t15+1040.0*t18-1040.0/3.0*t20+t146-t147+7280.0/3.0*t27-7280.0/3.0*t29-t184+t185-880.0*t36+880.0/3.0*t38-12320.0/3.0*t40+6160.0/3.0*t42-t71+t72;
  t199 = t119-560.0/3.0*t5-400.0*t7+170.0*t11+t124+1090.0/3.0*t15+170.0*t18-170.0/3.0*t20+t129-t130+3170.0/3.0*t27-3170.0/3.0*t29-t133+t134-t135+t136-t46+t48;
  t206 = 2560.0/3.0*t27;
  t207 = 2560.0/3.0*t29;
  t210 = 14080.0/3.0*t40;
  t211 = 7040.0/3.0*t42;
  t212 = -t100+3136.0/3.0*t5+2240.0/3.0*t7-1248.0*t11-t105-1952.0/3.0*t15-1600.0*t18+1600.0/3.0*t20-t108+t109-t206+t207+t184-t185+1760.0*t36-1760.0/3.0*t38+t210-t211;
  t217 = t76-2624.0*t5-1664.0*t7+3168.0*t11+t82+1408.0*t15+t84-t86+t87-t88+t89-t90-t169+t170-t91+t92-t93+t94;
  t226 = -t52+15296.0/3.0*t5+4928.0/3.0*t7-6432.0*t11-t58-3680.0/3.0*t15-11200.0*t18+11200.0/3.0*t20-t63+t64-t206+t207+t150-t151+12320.0*t36-12320.0/3.0*t38+t210-t211;
  t228 = 3360.0*t5;
  t229 = 1680.0*t7;
  t230 = 3780.0*t11;
  t232 = 1260.0*t15;
  t239 = 420.0*eta-t228-t229+t230+5040.0*t13+t232+3780.0*t18-1260.0*t20+2520.0*t23-1260.0*t25+1260.0*t27-1260.0*t29;
  t240 = 5040.0*eta;
  t244 = 100800.0*t13;
  t248 = 141120.0*t23;
  t249 = 70560.0*t25;
  t252 = 221760.0*t31;
  t253 = 55440.0*t34;
  t254 = 166320.0*t36;
  t255 = 55440.0*t38;
  t256 = 110880.0*t40;
  t257 = 55440.0*t42;
  t258 = -t240+80640.0*t5+20160.0*t7-105840.0*t11-t244-15120.0*t15-226800.0*t18+75600.0*t20-t248+t249-15120.0*t27+15120.0*t29+t252-t253+t254-t255+t256-t257;
  t267 = 55440.0*t45;
  t268 = 55440.0*t47;
  t269 = -t240+40320.0*t5+40320.0*t7-45360.0*t11-t244-35280.0*t15-45360.0*t18+15120.0*t20-t248+t249-75600.0*t27+75600.0*t29+t254-t255+t256-t257+t267-t268;
  t270 = 300.0*eta;
  t274 = 5520.0*t13;
  t279 = 9900.0*t36;
  t280 = 3300.0*t38;
  t281 = 6600.0*t40;
  t282 = 3300.0*t42;
  t283 = 660.0*t45;
  t284 = 660.0*t47;
  t285 = t270-3600.0*t5-1560.0*t7+4500.0*t11+t274+t232+4500.0*t18-1500.0*t20+t87-t88+1620.0*t27-1620.0*t29-t279+t280-t281+t282-t283+t284;
  t294 = 2640.0*t31;
  t295 = 660.0*t34;
  t300 = t270-t228-t229+4140.0*t11+t274+1380.0*t15+5220.0*t18-1740.0*t20+8520.0*t23-4260.0*t25+1740.0*t27-1740.0*t29-t294+t295-7920.0*t36+2640.0*t38-5280.0*t40+2640.0*t42-t283+t284;
  t308 = t270-3120.0*t5-1800.0*t7+t230+t274+1500.0*t15+4860.0*t18-1620.0*t20+t87-t88+1500.0*t27-1500.0*t29-t294+t295-t279+t280-t281+t282;
  t309 = 7920.0*eta;
  t313 = 190080.0*t13;
  t317 = 285120.0*t23;
  t318 = 142560.0*t25;
  t329 = -t309+158400.0*t5+31680.0*t7-213840.0*t11-t313-23760.0*t15-498960.0*t18+166320.0*t20-t317+t318-23760.0*t27+23760.0*t29+443520.0*t31-110880.0*t34+498960.0*t36-166320.0*t38+142560.0*t40-71280.0*t42+7920.0*t45-7920.0*t47;
  t336 = 380160.0*t23;
  t337 = 190080.0*t25;
  t346 = -t309+126720.0*t5+47520.0*t7-166320.0*t11-t313-39600.0*t15-308880.0*t18+102960.0*t20-t336+t337-55440.0*t27+55440.0*t29+t252-t253+546480.0*t36-182160.0*t38+269280.0*t40-134640.0*t42+23760.0*t45-23760.0*t47;
  t361 = -t309+95040.0*t5+63360.0*t7-118800.0*t11-t313-55440.0*t15-166320.0*t18+55440.0*t20-t336+t337-102960.0*t27+102960.0*t29+95040.0*t31-23760.0*t34+403920.0*t36-134640.0*t38+364320.0*t40-182160.0*t42+t267-t268;
  t378 = -t309+63360.0*t5+79200.0*t7-71280.0*t11-t313-71280.0*t15-71280.0*t18+23760.0*t20-t317+t318-166320.0*t27+166320.0*t29+31680.0*t31-7920.0*t34+213840.0*t36-71280.0*t38+332640.0*t40-166320.0*t42+110880.0*t45-110880.0*t47;

  values[0] = t22+t49;
  values[1] = t61+t73;
  values[2] = t85+t97;
  values[3] = t107+t116;
  values[4] = t127+t137;
  values[5] = t156;
  values[6] = t175;
  values[7] = t190;
  values[8] = t199;
  values[9] = t212;
  values[10] = t217;
  values[11] = t226;
  values[12] = t239;
  values[13] = t258;
  values[14] = t269;
  values[15] = t285;
  values[16] = t300;
  values[17] = t308;
  values[18] = t329;
  values[19] = t346;
  values[20] = t361;
  values[21] = t378;
}

// values of the derivatives in eta direction
static void C_T_UL4_2D_DeriveEta(double xi, double eta, double *values)
{
  double t3, t5, t7, t9, t11, t13, t15, t16, t17, t18, t20, t22, t23, t25;
  double t27, t29, t31, t32, t33, t34, t35, t36, t38, t40, t42, t44, t45;
  double t46, t47, t48, t49, t51, t55, t57, t58, t59, t60, t63, t64, t67;
  double t68, t69, t70, t74, t76, t77, t78, t79, t80, t81, t82, t83, t84;
  double t85, t86, t87, t88, t89, t93, t95, t96, t101, t102, t103, t104;
  double t108, t112, t113, t116, t117, t118, t119, t120, t121, t128, t129;
  double t132, t133, t138, t151, t152, t157, t166, t167, t172, t180, t184;
  double t192, t194, t196, t197, t200, t201, t202, t211, t212, t221, t225;
  double t228, t229, t230, t232, t239, t240, t244, t248, t249, t252, t253;
  double t254, t255, t256, t257, t258, t267, t268, t269, t270, t274, t279;
  double t280, t281, t282, t283, t284, t285, t294, t295, t300, t308, t309;
  double t313, t317, t318, t329, t336, t337, t346, t361, t378;

  t3 = xi*xi;
  t5 = xi*eta;
  t7 = eta*eta;
  t9 = t3*xi;
  t11 = t3*eta;
  t13 = xi*t7;
  t15 = t7*eta;
  t16 = 128.0/3.0*t15;
  t17 = 1.0-xi-eta;
  t18 = t9*t17;
  t20 = t9*eta;
  t22 = -25.0/3.0-140.0*xi+140.0/3.0*eta+3320.0/3.0*t3+6640.0/3.0*t5-80.0*t7-2872.0/3.0*t9-3872.0*t11-2872.0*t13+t16-5080.0/3.0*t18+5080.0/3.0*t20;
  t23 = t11*t17;
  t25 = t3*t7;
  t27 = t13*t17;
  t29 = xi*t15;
  t31 = t3*t3;
  t32 = t31*t17;
  t33 = 2750.0/3.0*t32;
  t34 = t31*eta;
  t35 = 2750.0/3.0*t34;
  t36 = t20*t17;
  t38 = t9*t7;
  t40 = t25*t17;
  t42 = t3*t15;
  t44 = t29*t17;
  t45 = 11000.0/3.0*t44;
  t46 = t7*t7;
  t47 = xi*t46;
  t48 = 2750.0/3.0*t47;
  t49 = -6520.0*t23+3260.0*t25-5080.0*t27+5080.0/3.0*t29+t33-t35+15400.0/3.0*t36-7700.0/3.0*t38+7700.0*t40-7700.0/3.0*t42+t45-t48;
  t51 = 1264.0/3.0*xi;
  t55 = 6656.0*t11;
  t57 = 2560.0/3.0*t18;
  t58 = 2560.0/3.0*t20;
  t59 = 9280.0*t23;
  t60 = 4640.0*t25;
  t63 = 14080.0/3.0*t36;
  t64 = 7040.0/3.0*t38;
  t67 = 24640.0/3.0*t44;
  t68 = 6160.0/3.0*t47;
  t69 = -t51+4928.0/3.0*t3+15296.0/3.0*t5-3680.0/3.0*t9-t55-6432.0*t13-t57+t58-t59+t60-11200.0*t27+11200.0/3.0*t29+t63-t64+12320.0*t40-12320.0/3.0*t42+t67-t68;
  t70 = 268.0*xi;
  t74 = 4800.0*t11;
  t76 = 1280.0*t18;
  t77 = 1280.0*t20;
  t78 = 9600.0*t23;
  t79 = 4800.0*t25;
  t80 = 3840.0*t27;
  t81 = 1280.0*t29;
  t82 = 7040.0*t36;
  t83 = 3520.0*t38;
  t84 = 10560.0*t40;
  t85 = 3520.0*t42;
  t86 = 1760.0*t44;
  t87 = 440.0*t47;
  t88 = t70-1664.0*t3-2624.0*t5+1408.0*t9+t74+3168.0*t13+t76-t77+t78-t79+t80-t81-t82+t83-t84+t85-t86+t87;
  t89 = 112.0*xi;
  t93 = 2048.0*t11;
  t95 = 3520.0*t23;
  t96 = 1760.0*t25;
  t101 = 3520.0/3.0*t44;
  t102 = 880.0/3.0*t47;
  t103 = -t89+2240.0/3.0*t3+3136.0/3.0*t5-1952.0/3.0*t9-t93-1248.0*t13-t57+t58-t95+t96-1600.0*t27+1600.0/3.0*t29+t63-t64+1760.0*t40-1760.0/3.0*t42+t101-t102;
  t104 = 110.0/3.0*xi;
  t108 = 840.0*t11;
  t112 = 480.0*t23;
  t113 = 240.0*t25;
  t116 = 1100.0/3.0*t36;
  t117 = 550.0/3.0*t38;
  t118 = 550.0*t40;
  t119 = 550.0/3.0*t42;
  t120 = t104-400.0*t3-560.0/3.0*t5+1090.0/3.0*t9+t108+170.0*t13+3170.0/3.0*t18-3170.0/3.0*t20+t112-t113+170.0*t27-170.0/3.0*t29-t33+t35-t116+t117-t118+t119;
  t121 = 224.0/3.0*xi;
  t128 = 2560.0*t23;
  t129 = 1280.0*t25;
  t132 = 6160.0/3.0*t32;
  t133 = 6160.0/3.0*t34;
  t138 = t121-896.0*t3-1792.0/3.0*t5+2512.0/3.0*t9+t93+688.0*t13+7280.0/3.0*t18-7280.0/3.0*t20+t128-t129+1040.0*t27-1040.0/3.0*t29-t132+t133-12320.0/3.0*t36+6160.0/3.0*t38-880.0*t40+880.0/3.0*t42-t101+t102;
  t151 = 440.0*t32;
  t152 = 440.0*t34;
  t157 = 28.0*xi-224.0*t3-448.0*t5+184.0*t9+864.0*t11+552.0*t13-40.0*t18+40.0*t20+4320.0*t23-2160.0*t25-120.0*t27+40.0*t29+t151-t152-4400.0*t36+2200.0*t38-6600.0*t40+2200.0*t42+t86-t87;
  t166 = 880.0/3.0*t32;
  t167 = 880.0/3.0*t34;
  t172 = t121-896.0/3.0*t3-1792.0*t5+688.0/3.0*t9+t93+2512.0*t13+1040.0/3.0*t18-1040.0/3.0*t20+t128-t129+7280.0*t27-7280.0/3.0*t29-t166+t167-1760.0/3.0*t36+880.0/3.0*t38-6160.0*t40+6160.0/3.0*t42-t67+t68;
  t180 = -1.0+t104+44.0/3.0*eta-280.0/3.0*t3-800.0*t5-48.0*t7+170.0/3.0*t9+t108+1090.0*t13+t16+170.0/3.0*t18;
  t184 = -170.0/3.0*t20+t112-t113+3170.0*t27-3170.0/3.0*t29-t116+t117-t118+t119-t45+t48;
  t192 = 512.0/3.0*t15;
  t194 = 16.0/3.0-t89-224.0/3.0*eta+1568.0/3.0*t3+4480.0/3.0*t5+224.0*t7-416.0*t9-t93-1952.0*t13-t192-1600.0/3.0*t18;
  t196 = 2560.0*t27;
  t197 = 2560.0/3.0*t29;
  t200 = 7040.0*t40;
  t201 = 7040.0/3.0*t42;
  t202 = 1600.0/3.0*t20-t95+t96-t196+t197+t166-t167+3520.0/3.0*t36-1760.0/3.0*t38+t200-t201;
  t211 = -12.0+t70+152.0*eta-1312.0*t3-3328.0*t5-384.0*t7+1056.0*t9+t74+4224.0*t13+256.0*t15+t76;
  t212 = -t77+t78-t79+t80-t81-t151+t152-t82+t83-t84+t85;
  t221 = 16.0-t51-416.0/3.0*eta+7648.0/3.0*t3+9856.0/3.0*t5+288.0*t7-2144.0*t9-t55-3680.0*t13-t192-11200.0/3.0*t18;
  t225 = 11200.0/3.0*t20-t59+t60-t196+t197+t132-t133+24640.0/3.0*t36-12320.0/3.0*t38+t200-t201;
  t228 = 1680.0*t3;
  t229 = 3360.0*t5;
  t230 = 1260.0*t9;
  t232 = 3780.0*t13;
  t239 = 420.0*xi-t228-t229+t230+5040.0*t11+t232+1260.0*t18-1260.0*t20+2520.0*t23-1260.0*t25+3780.0*t27-1260.0*t29;
  t240 = 5040.0*xi;
  t244 = 100800.0*t11;
  t248 = 141120.0*t23;
  t249 = 70560.0*t25;
  t252 = 55440.0*t32;
  t253 = 55440.0*t34;
  t254 = 110880.0*t36;
  t255 = 55440.0*t38;
  t256 = 166320.0*t40;
  t257 = 55440.0*t42;
  t258 = -t240+40320.0*t3+40320.0*t5-35280.0*t9-t244-45360.0*t13-75600.0*t18+75600.0*t20-t248+t249-45360.0*t27+15120.0*t29+t252-t253+t254-t255+t256-t257;
  t267 = 221760.0*t44;
  t268 = 55440.0*t47;
  t269 = -t240+20160.0*t3+80640.0*t5-15120.0*t9-t244-105840.0*t13-15120.0*t18+15120.0*t20-t248+t249-226800.0*t27+75600.0*t29+t254-t255+t256-t257+t267-t268;
  t270 = 300.0*xi;
  t274 = 5520.0*t11;
  t279 = 6600.0*t36;
  t280 = 3300.0*t38;
  t281 = 9900.0*t40;
  t282 = 3300.0*t42;
  t283 = 2640.0*t44;
  t284 = 660.0*t47;
  t285 = t270-1800.0*t3-3120.0*t5+1500.0*t9+t274+t232+1500.0*t18-1500.0*t20+t78-t79+4860.0*t27-1620.0*t29-t279+t280-t281+t282-t283+t284;
  t294 = 660.0*t32;
  t295 = 660.0*t34;
  t300 = t270-t228-t229+1380.0*t9+t274+4140.0*t13+1740.0*t18-1740.0*t20+8520.0*t23-4260.0*t25+5220.0*t27-1740.0*t29-t294+t295-5280.0*t36+2640.0*t38-7920.0*t40+2640.0*t42-t283+t284;
  t308 = t270-1560.0*t3-3600.0*t5+t230+t274+4500.0*t13+1620.0*t18-1620.0*t20+t78-t79+4500.0*t27-1500.0*t29-t294+t295-t279+t280-t281+t282;
  t309 = 7920.0*xi;
  t313 = 190080.0*t11;
  t317 = 285120.0*t23;
  t318 = 142560.0*t25;
  t329 = -t309+79200.0*t3+63360.0*t5-71280.0*t9-t313-71280.0*t13-166320.0*t18+166320.0*t20-t317+t318-71280.0*t27+23760.0*t29+110880.0*t32-110880.0*t34+332640.0*t36-166320.0*t38+213840.0*t40-71280.0*t42+31680.0*t44-7920.0*t47;
  t336 = 380160.0*t23;
  t337 = 190080.0*t25;
  t346 = -t309+63360.0*t3+95040.0*t5-55440.0*t9-t313-118800.0*t13-102960.0*t18+102960.0*t20-t336+t337-166320.0*t27+55440.0*t29+t252-t253+364320.0*t36-182160.0*t38+403920.0*t40-134640.0*t42+95040.0*t44-23760.0*t47;
  t361 = -t309+47520.0*t3+126720.0*t5-39600.0*t9-t313-166320.0*t13-55440.0*t18+55440.0*t20-t336+t337-308880.0*t27+102960.0*t29+23760.0*t32-23760.0*t34+269280.0*t36-134640.0*t38+546480.0*t40-182160.0*t42+t267-t268;
  t378 = -t309+31680.0*t3+158400.0*t5-23760.0*t9-t313-213840.0*t13-23760.0*t18+23760.0*t20-t317+t318-498960.0*t27+166320.0*t29+7920.0*t32-7920.0*t34+142560.0*t36-71280.0*t38+498960.0*t40-166320.0*t42+443520.0*t44-110880.0*t47;

  values[0] = t22+t49;
  values[1] = t69;
  values[2] = t88;
  values[3] = t103;
  values[4] = t120;
  values[5] = t138;
  values[6] = t157;
  values[7] = t172;
  values[8] = t180+t184;
  values[9] = t194+t202;
  values[10] = t211+t212;
  values[11] = t221+t225;
  values[12] = t239;
  values[13] = t258;
  values[14] = t269;
  values[15] = t285;
  values[16] = t300;
  values[17] = t308;
  values[18] = t329;
  values[19] = t346;
  values[20] = t361;
  values[21] = t378;
}

// values of the derivatives in xi-xi  direction
static void C_T_UL4_2D_DeriveXiXi(double xi, double eta, double *values)
{
  double t1, t3, t4, t6, t7, t9, t10, t13, t14, t16, t18, t19, t20, t23;
  double t24, t26, t27, t28, t30, t32, t35, t38, t40, t41, t42, t43, t44;
  double t46, t47, t50, t51, t56, t57, t58, t59, t60, t61, t62, t63, t64;
  double t65, t66, t67, t71, t72, t73, t77, t78, t82, t85, t86, t88, t89;
  double t90, t91, t92, t97, t98, t100, t101, t106, t115, t116, t121, t127;
  double t128, t133, t139, t144, t147, t148, t149, t152, t159, t160, t161;
  double t171, t174, t175, t177, t178, t179, t180, t181, t182, t183, t189;
  double t190, t193, t197, t198, t199, t200, t201, t202, t209, t210, t215;
  double t220, t223, t226, t227, t236, t241, t242, t249, t261, t274;

  t1 = xi*eta;
  t3 = eta*eta;
  t4 = t3*xi;
  t6 = xi*xi;
  t7 = t6*eta;
  t9 = 1.0-xi-eta;
  t10 = t4*t9;
  t13 = t3*eta;
  t14 = t13*t9;
  t16 = t3*t9;
  t18 = t9*t7;
  t19 = 11000.0*t18;
  t20 = 128.0*t6;
  t23 = t3*t3;
  t24 = 5500.0/3.0*t23;
  t26 = t6*xi*eta;
  t27 = 22000.0/3.0*t26;
  t28 = t6*t3;
  t30 = xi*t13;
  t32 = t1*t9;
  t35 = -5744.0*t1+13040.0*t4+10160.0*t7+15400.0*t10-160.0*xi+15400.0/3.0*t14-6520.0*t16+t19+t20-3872.0*t3+10160.0/3.0*t13-t24+140.0/3.0-t27-15400.0*t28-30800.0/3.0*t30-10160.0*t32+6640.0/3.0*eta;
  t38 = 512.0*t6;
  t40 = 6656.0*t3;
  t41 = 5120.0*t32;
  t42 = 5120.0*t7;
  t43 = 9280.0*t16;
  t44 = 18560.0*t4;
  t46 = 14080.0*t10;
  t47 = 14080.0*t28;
  t50 = 12320.0/3.0*t23;
  t51 = -416.0/3.0+576.0*xi+9856.0/3.0*eta-t38-7360.0*t1-t40-t41+t42-t43+t44+22400.0/3.0*t13+t46-t47+24640.0/3.0*t14-49280.0/3.0*t30-t50;
  t56 = 4800.0*t3;
  t57 = 7680.0*t32;
  t58 = 7680.0*t7;
  t59 = 9600.0*t16;
  t60 = 19200.0*t4;
  t61 = 2560.0*t13;
  t62 = 21120.0*t10;
  t63 = 21120.0*t28;
  t64 = 7040.0*t14;
  t65 = 14080.0*t30;
  t66 = 880.0*t23;
  t67 = 152.0-768.0*xi-3328.0*eta+768.0*t6+8448.0*t1+t56+t57-t58+t59-t60-t61-t62+t63-t64+t65+t66;
  t71 = 2048.0*t3;
  t72 = 3520.0*t16;
  t73 = 7040.0*t4;
  t77 = 1760.0/3.0*t23;
  t78 = -224.0/3.0+448.0*xi+4480.0/3.0*eta-t38-3904.0*t1-t71-t41+t42-t72+t73+3200.0/3.0*t13+t46-t47+3520.0/3.0*t14-7040.0/3.0*t30-t77;
  t82 = 840.0*t3;
  t85 = 480.0*t16;
  t86 = 960.0*t4;
  t88 = 1100.0*t10;
  t89 = 1100.0*t28;
  t90 = 1100.0/3.0*t14;
  t91 = 2200.0/3.0*t30;
  t92 = 44.0/3.0-96.0*xi-800.0*eta+t20+2180.0*t1+t82+6340.0*t32-6340.0*t7+t85-t86-340.0/3.0*t13-t19+t27-t88+t89-t90+t91;
  t97 = 2560.0*t16;
  t98 = 5120.0*t4;
  t100 = 24640.0*t18;
  t101 = 49280.0/3.0*t26;
  t106 = -1792.0*eta+5024.0*t1+t71+14560.0*t32-14560.0*t7+t97-t98-2080.0/3.0*t13-t100+t101-12320.0*t10+12320.0*t28-1760.0/3.0*t14+3520.0/3.0*t30+t77;
  t115 = 5280.0*t18;
  t116 = 3520.0*t26;
  t121 = -448.0*eta+1104.0*t1+864.0*t3-240.0*t32+240.0*t7+4320.0*t16-8640.0*t4+80.0*t13+t115-t116-13200.0*t10+13200.0*t28-4400.0*t14+8800.0*t30-t66;
  t127 = 3520.0*t18;
  t128 = 7040.0/3.0*t26;
  t133 = -1792.0/3.0*eta+1376.0*t1+t71+2080.0*t32-2080.0*t7+t97-t98-14560.0/3.0*t13-t127+t128-1760.0*t10+1760.0*t28-12320.0/3.0*t14+24640.0/3.0*t30+t50;
  t139 = -560.0/3.0*eta+340.0*t1+t82+340.0*t32-340.0*t7+t85-t86-6340.0/3.0*t13-t88+t89-t90+t91+t24;
  t144 = 5120.0/3.0*t13;
  t147 = 14080.0/3.0*t14;
  t148 = 28160.0/3.0*t30;
  t149 = 3136.0/3.0*eta-2496.0*t1-t71-3200.0*t32+3200.0*t7-t72+t73+t144+t127-t128+3520.0*t10-3520.0*t28+t147-t148;
  t152 = -2624.0*eta+6336.0*t1+t56+t57-t58+t59-t60-t61-t115+t116-t62+t63-t64+t65;
  t159 = 15296.0/3.0*eta-12864.0*t1-t40-22400.0*t32+22400.0*t7-t43+t44+t144+t100-t101+24640.0*t10-24640.0*t28+t147-t148;
  t160 = 3360.0*eta;
  t161 = 7560.0*t1;
  t171 = 100800.0*t3;
  t174 = 141120.0*t16;
  t175 = 282240.0*t4;
  t177 = 665280.0*t18;
  t178 = 443520.0*t26;
  t179 = 332640.0*t10;
  t180 = 332640.0*t28;
  t181 = 110880.0*t14;
  t182 = 221760.0*t30;
  t183 = 80640.0*eta-211680.0*t1-t171-453600.0*t32+453600.0*t7-t174+t175+30240.0*t13+t177-t178+t179-t180+t181-t182;
  t189 = 110880.0*t23;
  t190 = 40320.0*eta-90720.0*t1-t171-90720.0*t32+90720.0*t7-t174+t175+151200.0*t13+t179-t180+t181-t182-t189;
  t193 = 5520.0*t3;
  t197 = 19800.0*t10;
  t198 = 19800.0*t28;
  t199 = 6600.0*t14;
  t200 = 13200.0*t30;
  t201 = 1320.0*t23;
  t202 = -3600.0*eta+9000.0*t1+t193+9000.0*t32-9000.0*t7+t59-t60-3240.0*t13-t197+t198-t199+t200+t201;
  t209 = 7920.0*t18;
  t210 = 5280.0*t26;
  t215 = -t160+8280.0*t1+t193+10440.0*t32-10440.0*t7+8520.0*t16-17040.0*t4-3480.0*t13-t209+t210-15840.0*t10+15840.0*t28-5280.0*t14+10560.0*t30+t201;
  t220 = -3120.0*eta+t161+t193+9720.0*t32-9720.0*t7+t59-t60-3000.0*t13-t209+t210-t197+t198-t199+t200;
  t223 = 190080.0*t3;
  t226 = 285120.0*t16;
  t227 = 570240.0*t4;
  t236 = 158400.0*eta-427680.0*t1-t223-997920.0*t32+997920.0*t7-t226+t227+47520.0*t13+1330560.0*t18-887040.0*t26+997920.0*t10-997920.0*t28+142560.0*t14-285120.0*t30-15840.0*t23;
  t241 = 380160.0*t16;
  t242 = 760320.0*t4;
  t249 = 126720.0*eta-332640.0*t1-t223-617760.0*t32+617760.0*t7-t241+t242+110880.0*t13+t177-t178+1092960.0*t10-1092960.0*t28+269280.0*t14-538560.0*t30-47520.0*t23;
  t261 = 95040.0*eta-237600.0*t1-t223-332640.0*t32+332640.0*t7-t241+t242+205920.0*t13+285120.0*t18-190080.0*t26+807840.0*t10-807840.0*t28+364320.0*t14-728640.0*t30-t189;
  t274 = 63360.0*eta-142560.0*t1-t223-142560.0*t32+142560.0*t7-t226+t227+332640.0*t13+95040.0*t18-63360.0*t26+427680.0*t10-427680.0*t28+332640.0*t14-665280.0*t30-221760.0*t23;

  values[0] = t35;
  values[1] = t51;
  values[2] = t67;
  values[3] = t78;
  values[4] = t92;
  values[5] = t106;
  values[6] = t121;
  values[7] = t133;
  values[8] = t139;
  values[9] = t149;
  values[10] = t152;
  values[11] = t159;
  values[12] = -t160+t161+5040.0*t3+7560.0*t32-7560.0*t7+2520.0*t16-5040.0*t4-2520.0*t13;
  values[13] = t183;
  values[14] = t190;
  values[15] = t202;
  values[16] = t215;
  values[17] = t220;
  values[18] = t236;
  values[19] = t249;
  values[20] = t261;
  values[21] = t274;
}

// values of the derivatives in xi-eta direction
static void C_T_UL4_2D_DeriveXiEta(double xi, double eta, double *values)
{
  double t1, t3, t4, t6, t7, t9, t10, t13, t14, t15, t16, t17, t18, t19;
  double t21, t23, t25, t28, t29, t32, t33, t34, t35, t36, t38, t39, t40;
  double t43, t48, t50, t52, t53, t57, t58, t59, t62, t63, t64, t68, t70;
  double t71, t72, t73, t74, t75, t76, t77, t78, t80, t81, t82, t83, t87;
  double t90, t94, t97, t98, t99, t103, t108, t113, t114, t115, t117, t122;
  double t127, t129, t133, t135, t137, t144, t148, t151, t159, t165, t170;
  double t172, t178, t192, t201, t202, t205, t206, t207, t213, t224, t225;
  double t226, t227, t229, t237, t241, t246, t250, t252, t253, t254, t255;
  double t257, t270, t271, t272, t276, t283, t284, t286, t288, t289, t290;
  double t294, t298, t301, t308, t321, t322, t332, t340, t342, t344, t354;
  double t361, t363, t365, t375, t384, t395, t405;

  t1 = xi*eta;
  t3 = eta*eta;
  t4 = t3*xi;
  t6 = xi*xi;
  t7 = t6*eta;
  t9 = 1.0-xi-eta;
  t10 = t4*t9;
  t13 = t6*xi;
  t14 = t13*t9;
  t15 = 11000.0/3.0*t14;
  t16 = t3*eta;
  t17 = t16*t9;
  t18 = 11000.0/3.0*t17;
  t19 = t6*t9;
  t21 = t3*t9;
  t23 = t9*t7;
  t25 = -140.0-7744.0*t1+11600.0*t4+11600.0*t7+15400.0*t10+6640.0/3.0*xi+t15+t18-5080.0*t19-5080.0*t21+15400.0*t23;
  t28 = t6*t6;
  t29 = 2750.0/3.0*t28;
  t32 = t3*t3;
  t33 = 2750.0/3.0*t32;
  t34 = t13*eta;
  t35 = 8800.0*t34;
  t36 = t6*t3;
  t38 = xi*t16;
  t39 = 8800.0*t38;
  t40 = t1*t9;
  t43 = -2872.0*t6+5080.0/3.0*t13-t29-2872.0*t3+5080.0/3.0*t16-t33-t35-15400.0*t36-t39-13040.0*t40+6640.0/3.0*eta;
  t48 = 13312.0*t1;
  t50 = 2560.0*t19;
  t52 = 2560.0/3.0*t13;
  t53 = 18560.0*t40;
  t57 = 14080.0*t23;
  t58 = 19360.0*t36;
  t59 = 14080.0/3.0*t34;
  t62 = 24640.0/3.0*t17;
  t63 = 6160.0/3.0*t32;
  t64 = -1264.0/3.0+9856.0/3.0*xi+15296.0/3.0*eta-3680.0*t6-t48-6432.0*t3-t50+11840.0*t7+t52-t53+20480.0*t4-11200.0*t21+11200.0/3.0*t16+t57-t58-t59+24640.0*t10-49280.0/3.0*t38+t62-t63;
  t68 = 9600.0*t1;
  t70 = 3840.0*t19;
  t71 = 13440.0*t7;
  t72 = 1280.0*t13;
  t73 = 19200.0*t40;
  t74 = 13440.0*t4;
  t75 = 3840.0*t21;
  t76 = 1280.0*t16;
  t77 = 21120.0*t23;
  t78 = 21120.0*t36;
  t80 = 21120.0*t10;
  t81 = 1760.0*t17;
  t82 = 440.0*t32;
  t83 = 268.0-3328.0*xi-2624.0*eta+4224.0*t6+t68+3168.0*t3+t70-t71-t72+t73-t74+t75-t76-t77+t78+7040.0*t34-t80+t39-t81+t82;
  t87 = 4096.0*t1;
  t90 = 7040.0*t40;
  t94 = 8800.0*t36;
  t97 = 3520.0/3.0*t17;
  t98 = 880.0/3.0*t32;
  t99 = -112.0+4480.0/3.0*xi+3136.0/3.0*eta-1952.0*t6-t87-1248.0*t3-t50+6080.0*t7+t52-t90+5120.0*t4-1600.0*t21+1600.0/3.0*t16+t57-t94-t59+3520.0*t10-7040.0/3.0*t38+t97-t98;
  t103 = 1680.0*t1;
  t108 = 960.0*t40;
  t113 = 1100.0*t23;
  t114 = 1100.0*t36;
  t115 = 1100.0*t10;
  t117 = 110.0/3.0-800.0*xi-560.0/3.0*eta+1090.0*t6+t103+170.0*t3+3170.0*t19-3650.0*t7-3170.0/3.0*t13+t108-650.0*t4+170.0*t21-170.0/3.0*t16-t15+12100.0/3.0*t34+t29-t113+t114-t115+1100.0/3.0*t38;
  t122 = 24640.0/3.0*t14;
  t127 = t87-3600.0*t4-9840.0*t7-1760.0*t10-1792.0*xi-t122-t97+7280.0*t19+1040.0*t21-12320.0*t23+2512.0*t6;
  t129 = 6160.0/3.0*t28;
  t133 = 7040.0*t36;
  t135 = 5120.0*t40;
  t137 = 224.0/3.0-7280.0/3.0*t13+t129+688.0*t3-1040.0/3.0*t16+t98+12320.0*t34+t133+1760.0*t38+t135-1792.0/3.0*eta;
  t144 = 1760.0*t14;
  t148 = 28.0+1728.0*t1-4200.0*t4-4200.0*t7-13200.0*t10-448.0*xi+t144+t81-120.0*t19-120.0*t21-13200.0*t23;
  t151 = 440.0*t28;
  t159 = 552.0*t6+40.0*t13-t151+552.0*t3+40.0*t16-t82+2640.0*t34+13200.0*t36+2640.0*t38+8640.0*t40-448.0*eta;
  t165 = 3520.0/3.0*t14;
  t170 = t87-9840.0*t4-3600.0*t7-12320.0*t10-1792.0/3.0*xi-t165-t62+1040.0*t19+7280.0*t21-1760.0*t23+688.0*t6;
  t172 = 880.0/3.0*t28;
  t178 = 224.0/3.0-1040.0/3.0*t13+t172+2512.0*t3-7280.0/3.0*t16+t63+1760.0*t34+t133+12320.0*t38+t135-1792.0*eta;
  t192 = 110.0/3.0-560.0/3.0*xi-800.0*eta+170.0*t6+t103+1090.0*t3+170.0*t19-650.0*t7-170.0/3.0*t13+t108-3650.0*t4+3170.0*t21-3170.0/3.0*t16-t113+t114+1100.0/3.0*t34-t115+12100.0/3.0*t38-t18+t33;
  t201 = 2560.0*t21;
  t202 = 2560.0/3.0*t16;
  t205 = 14080.0*t10;
  t206 = 14080.0/3.0*t38;
  t207 = -112.0+3136.0/3.0*xi+4480.0/3.0*eta-1248.0*t6-t87-1952.0*t3-1600.0*t19+5120.0*t7+1600.0/3.0*t13-t90+6080.0*t4-t201+t202+t165-7040.0/3.0*t34-t172+3520.0*t23-t94+t205-t206;
  t213 = 268.0-2624.0*xi-3328.0*eta+3168.0*t6+t68+4224.0*t3+t70-t71-t72+t73-t74+t75-t76-t144+t35+t151-t77+t78-t80+7040.0*t38;
  t224 = -1264.0/3.0+15296.0/3.0*xi+9856.0/3.0*eta-6432.0*t6-t48-3680.0*t3-11200.0*t19+20480.0*t7+11200.0/3.0*t13-t53+11840.0*t4-t201+t202+t122-49280.0/3.0*t34-t129+24640.0*t23-t58+t205-t206;
  t225 = 3360.0*xi;
  t226 = 3360.0*eta;
  t227 = 3780.0*t6;
  t229 = 3780.0*t3;
  t237 = 420.0-t225-t226+t227+10080.0*t1+t229+3780.0*t19-6300.0*t7-1260.0*t13+5040.0*t40-6300.0*t4+3780.0*t21-1260.0*t16;
  t241 = 201600.0*t1;
  t246 = 282240.0*t40;
  t250 = 221760.0*t14;
  t252 = 55440.0*t28;
  t253 = 332640.0*t23;
  t254 = 332640.0*t36;
  t255 = 332640.0*t10;
  t257 = -5040.0+80640.0*xi+40320.0*eta-105840.0*t6-t241-45360.0*t3-226800.0*t19+367920.0*t7+75600.0*t13-t246+186480.0*t4-45360.0*t21+15120.0*t16+t250-332640.0*t34-t252+t253-t254+t255-110880.0*t38;
  t270 = 221760.0*t17;
  t271 = 55440.0*t32;
  t272 = -5040.0+40320.0*xi+80640.0*eta-45360.0*t6-t241-105840.0*t3-45360.0*t19+186480.0*t7+15120.0*t13-t246+367920.0*t4-226800.0*t21+75600.0*t16+t253-t254-110880.0*t34+t255-332640.0*t38+t270-t271;
  t276 = 11040.0*t1;
  t283 = 19800.0*t23;
  t284 = 19800.0*t36;
  t286 = 19800.0*t10;
  t288 = 2640.0*t17;
  t289 = 660.0*t32;
  t290 = 300.0-3600.0*xi-3120.0*eta+4500.0*t6+t276+t229+4500.0*t19-14100.0*t7-1500.0*t13+t73-14460.0*t4+4860.0*t21-1620.0*t16-t283+t284+6600.0*t34-t286+9240.0*t38-t288+t289;
  t294 = 2640.0*t14;
  t298 = 300.0+t276-13740.0*t4-13740.0*t7-15840.0*t10-t225-t294-t288+5220.0*t19+5220.0*t21-15840.0*t23;
  t301 = 660.0*t28;
  t308 = 4140.0*t6-1740.0*t13+t301+4140.0*t3-1740.0*t16+t289+7920.0*t34+15840.0*t36+7920.0*t38+17040.0*t40-t226;
  t321 = 300.0-3120.0*xi-3600.0*eta+t227+t276+4500.0*t3+4860.0*t19-14460.0*t7-1620.0*t13+t73-14100.0*t4+4500.0*t21-1500.0*t16-t294+9240.0*t34+t301-t283+t284-t286+6600.0*t38;
  t322 = 380160.0*t1;
  t332 = -7920.0-t322+356400.0*t4+784080.0*t7+427680.0*t10+158400.0*xi+443520.0*t14+31680.0*t17-498960.0*t19-71280.0*t21+997920.0*t23;
  t340 = 712800.0*t36;
  t342 = 570240.0*t40;
  t344 = -213840.0*t6+166320.0*t13-110880.0*t28-71280.0*t3+23760.0*t16-7920.0*t32-776160.0*t34-t340-174240.0*t38-t342+63360.0*eta;
  t354 = -7920.0-t322+546480.0*t4+689040.0*t7+807840.0*t10+126720.0*xi+t250+95040.0*t17-308880.0*t19-166320.0*t21+1092960.0*t23;
  t361 = 950400.0*t36;
  t363 = 760320.0*t40;
  t365 = -166320.0*t6+102960.0*t13-t252-118800.0*t3+55440.0*t16-23760.0*t32-586080.0*t34-t361-364320.0*t38-t363+95040.0*eta;
  t375 = -7920.0-t322+689040.0*t4+546480.0*t7+1092960.0*t10+95040.0*xi+95040.0*t14+t270-166320.0*t19-308880.0*t21+807840.0*t23;
  t384 = -118800.0*t6+55440.0*t13-23760.0*t28-166320.0*t3+102960.0*t16-t271-364320.0*t34-t361-586080.0*t38-t363+126720.0*eta;
  t395 = -7920.0-t322+784080.0*t4+356400.0*t7+997920.0*t10+63360.0*xi+31680.0*t14+443520.0*t17-71280.0*t19-498960.0*t21+427680.0*t23;
  t405 = -71280.0*t6+23760.0*t13-7920.0*t28-213840.0*t3+166320.0*t16-110880.0*t32-174240.0*t34-t340-776160.0*t38-t342+158400.0*eta;

  values[0] = t25+t43;
  values[1] = t64;
  values[2] = t83;
  values[3] = t99;
  values[4] = t117;
  values[5] = t127+t137;
  values[6] = t148+t159;
  values[7] = t170+t178;
  values[8] = t192;
  values[9] = t207;
  values[10] = t213;
  values[11] = t224;
  values[12] = t237;
  values[13] = t257;
  values[14] = t272;
  values[15] = t290;
  values[16] = t298+t308;
  values[17] = t321;
  values[18] = t332+t344;
  values[19] = t354+t365;
  values[20] = t375+t384;
  values[21] = t395+t405;
}

// values of the derivatives in eta-eta direction
static void C_T_UL4_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  double t1, t3, t4, t6, t7, t9, t10, t11, t13, t14, t16, t18, t22, t23;
  double t24, t25, t27, t30, t31, t32, t35, t37, t39, t40, t41, t44, t45;
  double t48, t49, t50, t52, t54, t55, t56, t57, t58, t59, t60, t61, t62;
  double t63, t64, t65, t67, t69, t70, t75, t76, t77, t79, t82, t83, t86;
  double t87, t88, t89, t90, t94, t95, t98, t103, t112, t117, t123, t128;
  double t135, t139, t141, t142, t145, t146, t147, t152, t159, t160, t162;
  double t170, t173, t174, t177, t178, t179, t180, t181, t182, t188, t189;
  double t190, t192, t196, t197, t198, t199, t200, t201, t202, t209, t214;
  double t220, t222, t225, t226, t236, t240, t241, t250, t261, t274;

  t1 = xi*eta;
  t3 = eta*eta;
  t4 = t3*xi;
  t6 = xi*xi;
  t7 = t6*eta;
  t9 = 1.0-xi-eta;
  t10 = t4*t9;
  t11 = 11000.0*t10;
  t13 = t6*xi;
  t14 = t13*t9;
  t16 = t6*t9;
  t18 = t9*t7;
  t22 = t6*t6;
  t23 = 5500.0/3.0*t22;
  t24 = 128.0*t3;
  t25 = t13*eta;
  t27 = t6*t3;
  t30 = xi*t3*eta;
  t31 = 22000.0/3.0*t30;
  t32 = t1*t9;
  t35 = -5744.0*t1+10160.0*t4+13040.0*t7+t11+6640.0/3.0*xi+15400.0/3.0*t14-6520.0*t16+15400.0*t18-3872.0*t6+10160.0/3.0*t13-t23+t24+140.0/3.0-30800.0/3.0*t25-15400.0*t27-t31-10160.0*t32-160.0*eta;
  t37 = 6656.0*t6;
  t39 = 5120.0/3.0*t13;
  t40 = 9280.0*t16;
  t41 = 18560.0*t7;
  t44 = 14080.0/3.0*t14;
  t45 = 28160.0/3.0*t25;
  t48 = 24640.0*t10;
  t49 = 49280.0/3.0*t30;
  t50 = 15296.0/3.0*xi-t37-12864.0*t1+t39-t40+t41-22400.0*t32+22400.0*t4+t44-t45+24640.0*t18-24640.0*t27+t48-t49;
  t52 = 4800.0*t6;
  t54 = 2560.0*t13;
  t55 = 9600.0*t16;
  t56 = 19200.0*t7;
  t57 = 7680.0*t32;
  t58 = 7680.0*t4;
  t59 = 7040.0*t14;
  t60 = 14080.0*t25;
  t61 = 21120.0*t18;
  t62 = 21120.0*t27;
  t63 = 5280.0*t10;
  t64 = 3520.0*t30;
  t65 = -2624.0*xi+t52+6336.0*t1-t54+t55-t56+t57-t58-t59+t60-t61+t62-t63+t64;
  t67 = 2048.0*t6;
  t69 = 3520.0*t16;
  t70 = 7040.0*t7;
  t75 = 3520.0*t10;
  t76 = 7040.0/3.0*t30;
  t77 = 3136.0/3.0*xi-t67-2496.0*t1+t39-t69+t70-3200.0*t32+3200.0*t4+t44-t45+3520.0*t18-3520.0*t27+t75-t76;
  t79 = 840.0*t6;
  t82 = 480.0*t16;
  t83 = 960.0*t7;
  t86 = 1100.0/3.0*t14;
  t87 = 2200.0/3.0*t25;
  t88 = 1100.0*t18;
  t89 = 1100.0*t27;
  t90 = -560.0/3.0*xi+t79+340.0*t1-6340.0/3.0*t13+t82-t83+340.0*t32-340.0*t4+t23-t86+t87-t88+t89;
  t94 = 2560.0*t16;
  t95 = 5120.0*t7;
  t98 = 12320.0/3.0*t22;
  t103 = -1792.0/3.0*xi+t67+1376.0*t1-14560.0/3.0*t13+t94-t95+2080.0*t32-2080.0*t4+t98-12320.0/3.0*t14+24640.0/3.0*t25-1760.0*t18+1760.0*t27-t75+t76;
  t112 = 880.0*t22;
  t117 = -448.0*xi+864.0*t6+1104.0*t1+80.0*t13+4320.0*t16-8640.0*t7-240.0*t32+240.0*t4-t112-4400.0*t14+8800.0*t25-13200.0*t18+13200.0*t27+t63-t64;
  t123 = 1760.0/3.0*t22;
  t128 = -1792.0*xi+t67+5024.0*t1-2080.0/3.0*t13+t94-t95+14560.0*t32-14560.0*t4+t123-1760.0/3.0*t14+3520.0/3.0*t25-12320.0*t18+12320.0*t27-t48+t49;
  t135 = 44.0/3.0-800.0*xi-96.0*eta+t79+2180.0*t1+t24-340.0/3.0*t13+t82-t83+6340.0*t32-6340.0*t4-t86+t87-t88+t89-t11+t31;
  t139 = 512.0*t3;
  t141 = 5120.0*t32;
  t142 = 5120.0*t4;
  t145 = 14080.0*t18;
  t146 = 14080.0*t27;
  t147 = -224.0/3.0+4480.0/3.0*xi+448.0*eta-t67-3904.0*t1-t139+3200.0/3.0*t13-t69+t70-t141+t142-t123+3520.0/3.0*t14-7040.0/3.0*t25+t145-t146;
  t152 = 152.0-3328.0*xi-768.0*eta+t52+8448.0*t1+768.0*t3-t54+t55-t56+t57-t58+t112-t59+t60-t61+t62;
  t159 = -416.0/3.0+9856.0/3.0*xi+576.0*eta-t37-7360.0*t1-t139+22400.0/3.0*t13-t40+t41-t141+t142-t98+24640.0/3.0*t14-49280.0/3.0*t25+t145-t146;
  t160 = 3360.0*xi;
  t162 = 7560.0*t1;
  t170 = 100800.0*t6;
  t173 = 141120.0*t16;
  t174 = 282240.0*t7;
  t177 = 110880.0*t22;
  t178 = 110880.0*t14;
  t179 = 221760.0*t25;
  t180 = 332640.0*t18;
  t181 = 332640.0*t27;
  t182 = 40320.0*xi-t170-90720.0*t1+151200.0*t13-t173+t174-90720.0*t32+90720.0*t4-t177+t178-t179+t180-t181;
  t188 = 665280.0*t10;
  t189 = 443520.0*t30;
  t190 = 80640.0*xi-t170-211680.0*t1+30240.0*t13-t173+t174-453600.0*t32+453600.0*t4+t178-t179+t180-t181+t188-t189;
  t192 = 5520.0*t6;
  t196 = 6600.0*t14;
  t197 = 13200.0*t25;
  t198 = 19800.0*t18;
  t199 = 19800.0*t27;
  t200 = 7920.0*t10;
  t201 = 5280.0*t30;
  t202 = -3120.0*xi+t192+t162-3000.0*t13+t55-t56+9720.0*t32-9720.0*t4-t196+t197-t198+t199-t200+t201;
  t209 = 1320.0*t22;
  t214 = -t160+t192+8280.0*t1-3480.0*t13+8520.0*t16-17040.0*t7+10440.0*t32-10440.0*t4+t209-5280.0*t14+10560.0*t25-15840.0*t18+15840.0*t27-t200+t201;
  t220 = -3600.0*xi+t192+9000.0*t1-3240.0*t13+t55-t56+9000.0*t32-9000.0*t4+t209-t196+t197-t198+t199;
  t222 = 190080.0*t6;
  t225 = 285120.0*t16;
  t226 = 570240.0*t7;
  t236 = 63360.0*xi-t222-142560.0*t1+332640.0*t13-t225+t226-142560.0*t32+142560.0*t4-221760.0*t22+332640.0*t14-665280.0*t25+427680.0*t18-427680.0*t27+95040.0*t10-63360.0*t30;
  t240 = 380160.0*t16;
  t241 = 760320.0*t7;
  t250 = 95040.0*xi-t222-237600.0*t1+205920.0*t13-t240+t241-332640.0*t32+332640.0*t4-t177+364320.0*t14-728640.0*t25+807840.0*t18-807840.0*t27+285120.0*t10-190080.0*t30;
  t261 = 126720.0*xi-t222-332640.0*t1+110880.0*t13-t240+t241-617760.0*t32+617760.0*t4-47520.0*t22+269280.0*t14-538560.0*t25+1092960.0*t18-1092960.0*t27+t188-t189;
  t274 = 158400.0*xi-t222-427680.0*t1+47520.0*t13-t225+t226-997920.0*t32+997920.0*t4-15840.0*t22+142560.0*t14-285120.0*t25+997920.0*t18-997920.0*t27+1330560.0*t10-887040.0*t30;

  values[0] = t35;
  values[1] = t50;
  values[2] = t65;
  values[3] = t77;
  values[4] = t90;
  values[5] = t103;
  values[6] = t117;
  values[7] = t128;
  values[8] = t135;
  values[9] = t147;
  values[10] = t152;
  values[11] = t159;
  values[12] = -t160+5040.0*t6+t162-2520.0*t13+2520.0*t16-5040.0*t7+7560.0*t32-7560.0*t4;
  values[13] = t182;
  values[14] = t190;
  values[15] = t202;
  values[16] = t214;
  values[17] = t220;
  values[18] = t236;
  values[19] = t250;
  values[20] = t261;
  values[21] = t274;
}

// ***********************************************************************

TBaseFunct2D *BF_C_T_UL4_2D_Obj = new TBaseFunct2D
        (22, BF_C_T_UL4_2D, BFUnitTriangle, 
         C_T_UL4_2D_Funct, C_T_UL4_2D_DeriveXi,
         C_T_UL4_2D_DeriveEta, C_T_UL4_2D_DeriveXiXi,
         C_T_UL4_2D_DeriveXiEta, C_T_UL4_2D_DeriveEtaEta, 6, 4,
         0, NULL);
