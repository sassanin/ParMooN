/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// Q3 Raviart-Thomas vector element, nonconforming , 2D
// History:  04.07.2012 implementation (Ulrich)
// ***********************************************************************

// base function values
// vector function, orthonormal to edges, 
// functions 1,2,3, and 4 are orthogonal to edge 1
// functions 5,6,7, and 8 are orthogonal to edge 2
// functions 9,10,11, and 12 are orthogonal to edge 3
// functions 13,14,15, and 16 are orthogonal to edge 4
// functions 17-40 correspond to inner degrees of freedom


// coefficient matrix for different choices of the degrees of freedom
// There seems to be no difference in using integral or point evaluation for 
// inner dofs. 
// The dofs on the edges determine the boundary conditions as well. Using 
// Tschebyscheff-points might improve the boundary approximation.
/*
// using Tschebyscheff-points on edges and integral evaluations for inner dofs
static double N_Q_RT3_2D_CM[1600] = { 
0,0,0,0,-0.0097081309,0.0565831338,0.0565831338,-0.0097081309,0,0,0,0,0.0097081309,-0.0565831338,-0.0565831338,0.0097081309,1.5820312684,0,0,0,0,0,-3.6914063431,0,-2.6367187803,0,0,0,0,0,0,0,0,0,6.1523439044,0,0,0,0,0,
0.0097081309,-0.0565831338,-0.0565831338,0.0097081309,0,0,0,0,-0.0097081309,0.0565831338,0.0565831338,-0.0097081309,0,0,0,0,0,1.5820312684,0,0,0,0,0,-2.6367187803,0,-3.6914063431,0,0,0,0,0,0,0,0,0,6.1523439044,0,0,0,0,
0,0,0,0,0.0388325215,-0.2263325215,-0.2263325215,0.0388325215,0,0,0,0,0.0388325215,-0.2263325215,-0.2263325215,0.0388325215,0,0,4.2187500001,0,0,0,0,0,0,0,0,0,0,0,0,0,-7.0312499994,0,0,0,0,0,0,0,
-0.0105080052,0.147858854,-0.147858854,0.0105080052,0,0,0,0,-0.0105080052,0.147858854,-0.147858854,0.0105080052,0,0,0,0,0,0,0,13.183593528,0,0,0,0,0,0,0,0,0,-18.4570308365,0,0,0,-30.7617186509,0,0,0,0,0,43.0664058715,
0,0,0,0,0.0105080052,-0.147858854,0.147858854,-0.0105080052,0,0,0,0,0.0105080052,-0.147858854,0.147858854,-0.0105080052,0,0,0,0,13.183593528,0,0,0,0,0,0,0,-18.4570308365,0,-30.7617186509,0,0,0,0,0,0,0,43.0664058715,0,
0.0388325215,-0.2263325215,-0.2263325215,0.0388325215,0,0,0,0,0.0388325215,-0.2263325215,-0.2263325215,0.0388325215,0,0,0,0,0,0,0,0,0,4.2187500001,0,0,0,0,0,0,0,0,0,-7.0312499994,0,0,0,0,0,0,0,0,
0,0,0,0,0.0970813072,-0.5658313241,-0.5658313241,0.0970813072,0,0,0,0,-0.0970813072,0.5658313241,0.5658313241,-0.0970813072,-5.2734376115,0,0,0,0,0,22.148438062,0,8.7890626847,0,0,0,0,0,0,0,0,0,-36.9140634322,0,0,0,0,0,
-0.0662912647,0.0662912647,0.0662912647,-0.0662912647,0,0,0,0,0.0662912647,-0.0662912647,-0.0662912647,0.0662912647,0,0,0,0,0,-2.6367187803,0,0,0,0,0,7.9101563408,0,6.1523439044,0,0,0,0,0,0,0,0,0,-18.4570317133,0,0,0,0,
0,0,0,0,0.0662912647,-0.0662912647,-0.0662912647,0.0662912647,0,0,0,0,-0.0662912647,0.0662912647,0.0662912647,-0.0662912647,-2.6367187803,0,0,0,0,0,6.1523439044,0,7.9101563408,0,0,0,0,0,0,0,0,0,-18.4570317133,0,0,0,0,0,
-0.0970813072,0.5658313241,0.5658313241,-0.0970813072,0,0,0,0,0.0970813072,-0.5658313241,-0.5658313241,0.0970813072,0,0,0,0,0,-5.2734376115,0,-0,0,0,0,8.7890626847,0,22.148438062,0,0,0,0,0,-0,0,0,0,-36.9140634322,0,-0,0,-0,
0,0,0,0,-0.0420320184,0.5914353808,-0.5914353808,0.0420320184,0,0,0,0,0.0420320184,-0.5914353808,0.5914353808,-0.0420320184,-0,0,0,0,-0,0,0,0,0,0,35.1562490011,0,0,0,0,0,-0,0,-0,0,-49.2187483275,0,-0,0,
-0.0420320184,0.5914353808,-0.5914353808,0.0420320184,0,0,0,0,0.0420320184,-0.5914353808,0.5914353808,-0.0420320184,0,0,0,0,0,-0,0,0,0,-0,0,0,0,0,0,35.1562490011,0,-0,0,0,0,-0,0,-0,0,-49.2187483275,0,0,
0,0,0,0,-0.0647208691,0.3772208692,0.3772208692,-0.0647208691,0,0,0,0,-0.0647208691,0.3772208692,0.3772208692,-0.0647208691,0,0,-4.2187500001,0,0,0,0,0,0,0,0,0,0,0,0,0,7.0312499994,0,0,0,0,0,0,0,
0.0717531479,-0.1732274227,0.1732274227,-0.0717531479,0,0,0,0,0.0717531479,-0.1732274227,0.1732274227,-0.0717531479,0,0,0,0,0,0,0,-18.4570308365,0,0,0,0,0,0,0,0,0,30.7617180571,0,0,0,43.0664058715,0,0,0,0,0,-71.7773431105,
0,0,0,0,-0.1050800497,1.4785885049,-1.4785885049,0.1050800497,0,0,0,0,-0.1050800497,1.4785885049,-1.4785885049,0.1050800497,0,0,0,0,-43.9453121789,0,0,0,0,0,0,0,61.5234367079,0,184.570311933,0,0,0,0,0,0,0,-258.398435268,0,
-0.265165043,0.265165043,0.265165043,-0.265165043,0,0,0,0,-0.265165043,0.265165043,0.265165043,-0.265165043,0,0,0,0,0,0,0,0,0,-7.0312499994,0,0,0,0,0,0,0,0,0,21.0937499981,0,0,0,0,0,0,0,0,
0,0,0,0,-0.265165043,0.265165043,0.265165043,-0.265165043,0,0,0,0,-0.265165043,0.265165043,0.265165043,-0.265165043,0,0,-7.0312499994,0,0,0,0,0,0,0,0,0,0,0,0,0,21.0937499981,0,0,0,0,0,0,0,
0.1050800497,-1.4785885049,1.4785885049,-0.1050800497,0,0,0,0,0.1050800497,-1.4785885049,1.4785885049,-0.1050800497,0,0,0,0,0,0,0,-43.9453121789,0,0,0,0,0,0,0,0,0,61.5234367079,0,0,0,184.570311933,0,0,0,0,0,-258.398435268,
0,0,0,0,-0.0717531479,0.1732274227,-0.1732274227,0.0717531479,0,0,0,0,-0.0717531479,0.1732274227,-0.1732274227,0.0717531479,0,0,0,0,-18.4570308365,0,0,0,0,0,0,0,30.7617180571,0,43.0664058715,0,0,0,0,0,0,0,-71.7773431105,0,
-0.0647208691,0.3772208692,0.3772208692,-0.0647208691,0,0,0,0,-0.0647208691,0.3772208692,0.3772208692,-0.0647208691,0,0,0,0,0,0,0,0,0,-4.2187500001,0,0,0,0,0,0,0,0,0,7.0312499994,0,0,0,0,0,0,0,0,
0,0,0,0,-0.1132615239,0.660136538,0.660136538,-0.1132615239,0,0,0,0,0.1132615239,-0.660136538,-0.660136538,0.1132615239,3.6914063431,0,0,0,0,0,-18.4570317189,0,-6.1523439044,0,0,0,0,0,0,0,0,0,30.7617195277,0,0,0,0,0,
0.2870125744,-0.6929096496,0.6929096496,-0.2870125744,0,0,0,0,-0.2870125744,0.6929096496,-0.6929096496,0.2870125744,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-49.2187483275,0,0,0,0,0,0,0,0,0,82.0312472025,0,0,
0,0,0,0,0.0700533639,-0.9857256345,0.9857256345,-0.0700533639,0,0,0,0,-0.0700533639,0.9857256345,-0.9857256345,0.0700533639,0,0,0,0,0,0,0,0,0,0,-35.1562490011,0,0,0,0,0,0,0,0,0,49.2187483275,0,0,0,
0.6629126313,-0.6629126313,-0.6629126313,0.6629126313,0,0,0,0,-0.6629126313,0.6629126313,0.6629126313,-0.6629126313,0,0,0,0,0,8.7890626847,0,0,0,0,0,-26.3671880541,0,-36.9140634322,0,0,0,0,0,0,0,0,0,110.742190296,0,0,0,0,
0,0,0,0,-0.6629126313,0.6629126313,0.6629126313,-0.6629126313,0,0,0,0,0.6629126313,-0.6629126313,-0.6629126313,0.6629126313,8.7890626847,0,0,0,0,0,-36.9140634322,0,-26.3671880541,0,0,0,0,0,0,0,0,0,110.742190296,0,0,0,0,0,
0.0700533639,-0.9857256345,0.9857256345,-0.0700533639,0,0,0,0,-0.0700533639,0.9857256345,-0.9857256345,0.0700533639,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-35.1562490011,0,0,0,0,0,0,0,0,0,49.2187483275,0,0,
0,0,0,0,0.2870125744,-0.6929096496,0.6929096496,-0.2870125744,0,0,0,0,-0.2870125744,0.6929096496,-0.6929096496,0.2870125744,0,0,0,0,0,0,0,0,0,0,-49.2187483275,0,0,0,0,0,0,0,0,0,82.0312472025,0,0,0,
0.1132615239,-0.660136538,-0.660136538,0.1132615239,0,0,0,0,-0.1132615239,0.660136538,0.660136538,-0.1132615239,0,0,0,0,0,3.6914063431,0,0,0,0,0,-6.1523439044,0,-18.4570317189,0,-0,0,-0,0,0,0,-0,0,30.7617195277,0,0,0,0,
0,0,0,0,0.12259339,-1.7250199047,1.7250199047,-0.12259339,0,0,0,0,0.12259339,-1.7250199047,1.7250199047,-0.12259339,0,0,0,0,30.7617186509,0,0,0,0,0,0,0,-43.0664058715,0,-153.808593282,0,0,0,0,0,0,0,215.332029396,0,
-0.7175314616,1.732274186,-1.732274186,0.7175314616,0,0,0,0,-0.7175314616,1.732274186,-1.732274186,0.7175314616,0,0,0,0,0,0,0,61.5234367079,0,0,0,0,0,0,0,0,0,-102.539061168,0,0,0,-258.398435268,0,0,0,0,0,430.664058727,
0,0,0,0,0.4419417383,-0.4419417383,-0.4419417383,0.4419417383,0,0,0,0,0.4419417383,-0.4419417383,-0.4419417383,0.4419417383,-0,0,7.0312499994,0,0,0,0,0,0,0,0,0,0,0,0,0,-21.0937499981,0,0,0,0,0,0,0,
0.4419417383,-0.4419417383,-0.4419417383,0.4419417383,0,0,0,0,0.4419417383,-0.4419417383,-0.4419417383,0.4419417383,0,0,0,0,0,0,0,0,0,7.0312499994,0,0,0,0,0,0,0,0,0,-21.0937499981,0,0,0,0,0,0,0,0,
0,0,0,0,0.7175314616,-1.732274186,1.732274186,-0.7175314616,0,0,0,0,0.7175314616,-1.732274186,1.732274186,-0.7175314616,0,0,0,0,61.5234367079,0,0,0,0,0,0,0,-102.539061168,0,-258.398435268,0,0,0,0,0,0,0,430.664058727,0,
-0.12259339,1.7250199047,-1.7250199047,0.12259339,0,0,0,0,-0.12259339,1.7250199047,-1.7250199047,0.12259339,0,0,0,0,0,0,0,30.7617186509,0,0,0,0,0,0,0,0,0,-43.0664058715,0,0,0,-153.808593282,0,0,0,0,0,215.332029396,
0,0,0,0,0.7733980619,-0.7733980619,-0.7733980619,0.7733980619,0,0,0,0,-0.7733980619,0.7733980619,0.7733980619,-0.7733980619,-6.1523439044,0,0,0,0,0,30.7617195277,0,18.4570317133,0,0,0,0,0,0,0,0,0,-92.2851585831,0,0,0,0,0,
-0.4783542905,1.1548494158,-1.1548494158,0.4783542905,0,0,0,0,0.4783542905,-1.1548494158,1.1548494158,-0.4783542905,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,49.2187483275,0,0,0,0,0,0,0,0,0,-82.0312472025,0,0,
0,0,0,0,-0.4783542905,1.1548494158,-1.1548494158,0.4783542905,0,0,0,0,0.4783542905,-1.1548494158,1.1548494158,-0.4783542905,0,0,0,0,0,0,0,0,0,0,49.2187483275,0,0,0,0,0,0,0,0,0,-82.0312472025,0,0,0,
-0.7733980619,0.7733980619,0.7733980619,-0.7733980619,0,0,0,0,0.7733980619,-0.7733980619,-0.7733980619,0.7733980619,0,0,0,0,0,-6.1523439044,0,0,0,0,0,18.4570317133,0,30.7617195277,0,0,0,0,0,0,0,0,0,-92.2851585831,0,0,0,0,
0,0,0,0,-0.8371200299,2.0209865296,-2.0209865296,0.8371200299,0,0,0,0,-0.8371200299,2.0209865296,-2.0209865296,0.8371200299,0,0,0,0,-43.0664058715,0,0,0,0,0,0,0,71.7773431105,0,215.332029396,0,0,0,0,0,0,0,-358.886715617,-0,
0.8371200299,-2.0209865296,2.0209865296,-0.8371200299,0,0,0,0,0.8371200299,-2.0209865296,2.0209865296,-0.8371200299,0,0,0,0,0,0,0,-43.0664058715,0,0,0,0,0,0,0,0,0,71.7773431105,0,0,0,215.332029396,0,0,0,0,0,-358.886715617
};
*/
// using Tschebyscheff-points on edges and point evaluations for inner dofs
static double N_Q_RT3_2D_CM[1600] = {
  0,0,0,0,-0,-0,0,-0,0,0,0,0,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,-0,0,0,-0,0,-0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,-0,0,-0,0,
-0,-0,0,-0,0,0,0,0,0,-0,0,-0,0,0,0,0,-0,-0,0,-0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,0,0,0,0,0,0,-0,0,0.2391463117,-1.3938468501,-1.3938468501,0.2391463117,-0,0,-0,0,-0.2391463117,1.3938468501,1.3938468501,-0.2391463117,
0,-0,0,-0,0,0,0,0,-0,0,-0,0,0,0,0,0,0,-0,0,-0,0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,0,0,-0,-0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,-0,0,-0,0,0,0,0,0,0,-0,0,0,0,0,0,0,0,0,0,0,0,-0,0,0,-0,0,-0,0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,-0,0,-0,0,
0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,0.2391463117,-1.3938468501,-1.3938468501,0.2391463117,0,0,-0,-0,-0.2391463117,1.3938468501,1.3938468501,-0.2391463117,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,-0.0776650429,0.4526650429,0.4526650429,-0.0776650429,0,0,0,0,0,0,0,0,0,0,-0,0,-0.2761423749,1.6094757082,1.6094757082,-0.2761423749,0.2416245781,-1.4082912447,-1.4082912447,0.2416245781,-0.2761423749,1.6094757082,1.6094757082,-0.2761423749,
-0,0,-0,-0,0,0,0,0,-0,0,-0,0,0,0,0,0,-0,0,-0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0,0,-0,0,0,0,0,0,0,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,0,-0,0,-0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,-0,0,-0,
-0.0776650429,0.4526650429,0.4526650429,-0.0776650429,0,0,0,0,0.0776650429,-0.4526650429,-0.4526650429,0.0776650429,0,0,0,0,-0.2761423749,1.6094757082,1.6094757082,-0.2761423749,0.2416245781,-1.4082912447,-1.4082912447,0.2416245781,-0.2761423749,1.6094757082,1.6094757082,-0.2761423749,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.0840640367,1.1828707612,-1.1828707612,0.0840640367,0,0,0,0,0.0840640367,-1.1828707612,1.1828707612,-0.0840640367,0,0,0,0,0,0,0,0,0,0,0,0,-0.2588501026,3.6422973461,-3.6422973461,0.2588501026,0,-0,0,-0,0.2588501026,-3.6422973461,3.6422973461,-0.2588501026,
-0.0840640367,1.1828707612,-1.1828707612,0.0840640367,0,0,0,0,0.0840640367,-1.1828707612,1.1828707612,-0.0840640367,0,0,0,0,-0.2588501026,3.6422973461,-3.6422973461,0.2588501026,-0,0,-0,-0,0.2588501026,-3.6422973461,3.6422973461,-0.2588501026,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,0,0,0,0,0,0,0,0,-0.2391463117,1.3938468501,1.3938468501,-0.2391463117,-0,0,-0,0,0.2391463117,-1.3938468501,-1.3938468501,0.2391463117,
0,0,-0,-0,0,0,0,0,-0,-0,0,-0,0,0,0,0,-0,0,-0,0,-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.0840640367,1.1828707612,-1.1828707612,0.0840640367,0,0,0,0,-0.0840640367,1.1828707612,-1.1828707612,0.0840640367,0,0,0,0,0,0,0,0,0,0,0,0,0.2988943528,-4.2057627065,4.2057627065,-0.2988943528,-0.2615325587,3.6800423682,-3.6800423682,0.2615325587,0.2988943528,-4.2057627065,4.2057627065,-0.2988943528,
-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,-1.6329931619,1.6329931619,1.6329931619,-1.6329931619,-0,-0,0,-0,1.6329931619,-1.6329931619,-1.6329931619,1.6329931619,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,0,0,0,0,0,0,0,0,-1.6329931619,1.6329931619,1.6329931619,-1.6329931619,-0,-0,0,-0,1.6329931619,-1.6329931619,-1.6329931619,1.6329931619,
0.0840640367,-1.1828707612,1.1828707612,-0.0840640367,0,0,0,0,0.0840640367,-1.1828707612,1.1828707612,-0.0840640367,0,0,0,0,0.2988943528,-4.2057627065,4.2057627065,-0.2988943528,-0.2615325587,3.6800423682,-3.6800423682,0.2615325587,0.2988943528,-4.2057627065,4.2057627065,-0.2988943528,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0,0,-0,0,0,0,0,0,0,-0,0,-0,0,0,0,0,0,0,0,0,0,0,0,0,-0,0,-0,0,-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,-0,0,-0,
-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,-0.2391463117,1.3938468501,1.3938468501,-0.2391463117,-0,-0,0,-0,0.2391463117,-1.3938468501,-1.3938468501,0.2391463117,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,0.1035533906,-0.6035533906,-0.6035533906,0.1035533906,0,0,0,0,0,0,0,0,0,0,0,0,0.2761423749,-1.6094757082,-1.6094757082,0.2761423749,-0.1380711875,0.8047378541,0.8047378541,-0.1380711875,0.2761423749,-1.6094757082,-1.6094757082,0.2761423749,
0.5740251485,-1.3858192988,1.3858192988,-0.5740251485,0,0,0,0,-0.5740251485,1.3858192988,-1.3858192988,0.5740251485,0,0,0,0,1.7675390615,-4.2672167744,4.2672167744,-1.7675390615,0,-0,0,-0,-1.7675390615,4.2672167744,-4.2672167744,1.7675390615,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,0,0,0,0,-0.1120853823,1.5771610149,-1.5771610149,0.1120853823,0,0,0,0,0,0,0,0,0,0,-0,0,0.2588501026,-3.6422973461,3.6422973461,-0.2588501026,0,0,-0,0,-0.2588501026,3.6422973461,-3.6422973461,0.2588501026,
0.5303300859,-0.5303300859,-0.5303300859,0.5303300859,0,0,0,0,-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,1.8856180832,-1.8856180832,-1.8856180832,1.8856180832,-1.6499158228,1.6499158228,1.6499158228,-1.6499158228,1.8856180832,-1.8856180832,-1.8856180832,1.8856180832,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.5303300859,0.5303300859,0.5303300859,-0.5303300859,0,0,0,0,0.5303300859,-0.5303300859,-0.5303300859,0.5303300859,0,0,0,0,0,0,0,0,0,0,0,0,1.8856180832,-1.8856180832,-1.8856180832,1.8856180832,-1.6499158228,1.6499158228,1.6499158228,-1.6499158228,1.8856180832,-1.8856180832,-1.8856180832,1.8856180832,
0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,0,0,0,0,-0.1120853823,1.5771610149,-1.5771610149,0.1120853823,0,0,0,0,0.2588501026,-3.6422973461,3.6422973461,-0.2588501026,0,-0,0,-0,-0.2588501026,3.6422973461,-3.6422973461,0.2588501026,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.5740251485,-1.3858192988,1.3858192988,-0.5740251485,0,0,0,0,-0.5740251485,1.3858192988,-1.3858192988,0.5740251485,0,0,0,0,0,0,0,0,0,0,-0,0,1.7675390615,-4.2672167744,4.2672167744,-1.7675390615,0,0,-0,0,-1.7675390615,4.2672167744,-4.2672167744,1.7675390615,
0.1035533906,-0.6035533906,-0.6035533906,0.1035533906,0,0,0,0,-0.1035533906,0.6035533906,0.6035533906,-0.1035533906,0,0,0,0,0.2761423749,-1.6094757082,-1.6094757082,0.2761423749,-0.1380711875,0.8047378541,0.8047378541,-0.1380711875,0.2761423749,-1.6094757082,-1.6094757082,0.2761423749,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,0,0,0,0,0.1120853823,-1.5771610149,1.5771610149,-0.1120853823,0,0,0,0,0,0,0,0,0,0,-0,0,-0.2988943528,4.2057627065,-4.2057627065,0.2988943528,0.1494471764,-2.1028813533,2.1028813533,-0.1494471764,-0.2988943528,4.2057627065,-4.2057627065,0.2988943528,
-0.5740251485,1.3858192988,-1.3858192988,0.5740251485,0,0,0,0,-0.5740251485,1.3858192988,-1.3858192988,0.5740251485,0,0,0,0,-2.0409783059,4.9273575067,-4.9273575067,2.0409783059,1.7858560177,-4.3114378184,4.3114378184,-1.7858560177,-2.0409783059,4.9273575067,-4.9273575067,2.0409783059,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,0,0,0,0,0,0,-0,0,1.6329931619,-1.6329931619,-1.6329931619,1.6329931619,0,-0,-0,0,-1.6329931619,1.6329931619,1.6329931619,-1.6329931619,
0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,1.6329931619,-1.6329931619,-1.6329931619,1.6329931619,0,0,-0,0,-1.6329931619,1.6329931619,1.6329931619,-1.6329931619,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.5740251485,-1.3858192988,1.3858192988,-0.5740251485,0,0,0,0,0.5740251485,-1.3858192988,1.3858192988,-0.5740251485,0,0,0,0,0,0,0,0,0,0,-0,0,-2.0409783059,4.9273575067,-4.9273575067,2.0409783059,1.7858560177,-4.3114378184,4.3114378184,-1.7858560177,-2.0409783059,4.9273575067,-4.9273575067,2.0409783059,
-0.1120853823,1.5771610149,-1.5771610149,0.1120853823,0,0,0,0,-0.1120853823,1.5771610149,-1.5771610149,0.1120853823,0,0,0,0,-0.2988943528,4.2057627065,-4.2057627065,0.2988943528,0.1494471764,-2.1028813533,2.1028813533,-0.1494471764,-0.2988943528,4.2057627065,-4.2057627065,0.2988943528,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,-0.7071067812,0.7071067812,0.7071067812,-0.7071067812,0,0,0,0,0,0,0,0,0,0,-0,0,-1.8856180832,1.8856180832,1.8856180832,-1.8856180832,0.9428090416,-0.9428090416,-0.9428090416,0.9428090416,-1.8856180832,1.8856180832,1.8856180832,-1.8856180832,
-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,0,0,0,0.7653668647,-1.847759065,1.847759065,-0.7653668647,0,0,0,0,-1.7675390615,4.2672167744,-4.2672167744,1.7675390615,-0,0,-0,0,1.7675390615,-4.2672167744,4.2672167744,-1.7675390615,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,0,0,0,0.7653668647,-1.847759065,1.847759065,-0.7653668647,0,0,0,0,0,0,0,0,0,0,0,0,-1.7675390615,4.2672167744,-4.2672167744,1.7675390615,-0,-0,0,-0,1.7675390615,-4.2672167744,4.2672167744,-1.7675390615,
-0.7071067812,0.7071067812,0.7071067812,-0.7071067812,0,0,0,0,0.7071067812,-0.7071067812,-0.7071067812,0.7071067812,0,0,0,0,-1.8856180832,1.8856180832,1.8856180832,-1.8856180832,0.9428090416,-0.9428090416,-0.9428090416,0.9428090416,-1.8856180832,1.8856180832,1.8856180832,-1.8856180832,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,0,0,0,-0.7653668647,1.847759065,-1.847759065,0.7653668647,0,0,0,0,0,0,0,0,0,-0,0,0,2.0409783059,-4.9273575067,4.9273575067,-2.0409783059,-1.020489153,2.4636787534,-2.4636787534,1.020489153,2.0409783059,-4.9273575067,4.9273575067,-2.0409783059,
0.7653668647,-1.847759065,1.847759065,-0.7653668647,0,0,0,0,0.7653668647,-1.847759065,1.847759065,-0.7653668647,0,0,0,0,2.0409783059,-4.9273575067,4.9273575067,-2.0409783059,-1.020489153,2.4636787534,-2.4636787534,1.020489153,2.0409783059,-4.9273575067,4.9273575067,-2.0409783059,0,0,0,0,0,0,0,0,0,0,0,0
};

static void N_Q_RT3_2D_Funct(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={1,0,xi,0 ,eta,0,
  xi*xi,0, eta*eta, 0, xi*eta, 0, 
  xi*xi*xi, 0,   xi*xi*eta,    0, xi*eta*eta,    0, eta*eta*eta,   0,
  xi*xi*xi*xi,0, xi*xi*xi*eta, 0, xi*xi*eta*eta, 0, xi*eta*eta*eta,0,
  xi*xi*xi*xi*eta,0,    xi*xi*xi*eta*eta,    0,xi*xi*eta*eta*eta, 0,
  xi*xi*xi*xi*eta*eta,0,xi*xi*xi*eta*eta*eta,0,
  xi*xi*xi*xi*eta*eta*eta,0  };
  double mon_y[40]={0, 1, 0, xi, 0, eta, 
  0, xi*xi, 0, eta*eta, 0, xi*eta,
  0, xi*xi*xi,     0, xi*xi*eta,     0, xi*eta*eta,     0,eta*eta*eta,
  0, xi*xi*xi*eta, 0, xi*xi*eta*eta, 0, xi*eta*eta*eta, 0, eta*eta*eta*eta,
  0, xi*xi*xi*eta*eta,     0, xi*xi*eta*eta*eta,    0, xi*eta*eta*eta*eta,
  0, xi*xi*xi*eta*eta*eta, 0, xi*xi*eta*eta*eta*eta,
  0, xi*xi*xi*eta*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of the derivatives in xi direction
static void N_Q_RT3_2D_DeriveXi(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={0,0,1,0 ,0,0,
  2*xi,0,   0, 0, eta, 0, 
  3*xi*xi, 0,   2*xi*eta,    0, eta*eta,    0, 0,   0,
  4*xi*xi*xi,0, 3*xi*xi*eta, 0, 2*xi*eta*eta, 0, eta*eta*eta,0,
  4*xi*xi*xi*eta,0,    3*xi*xi*eta*eta,    0,2*xi*eta*eta*eta, 0,
  4*xi*xi*xi*eta*eta,0,3*xi*xi*eta*eta*eta,0,
  4*xi*xi*xi*eta*eta*eta,0  };
  double mon_y[40]={0, 0, 0, 1, 0, 0, 
  0, 2*xi, 0, 0, 0, eta,
  0, 3*xi*xi,     0, 2*xi*eta,     0, eta*eta,     0,0,
  0, 3*xi*xi*eta, 0, 2*xi*eta*eta, 0, eta*eta*eta, 0, 0,
  0, 3*xi*xi*eta*eta,     0, 2*xi*eta*eta*eta,    0, eta*eta*eta*eta,
  0, 3*xi*xi*eta*eta*eta, 0, 2*xi*eta*eta*eta*eta,
  0, 3*xi*xi*eta*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of the derivatives in eta direction
static void N_Q_RT3_2D_DeriveEta(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={0,0,0,0 ,1,0,
  0,0, 2*eta, 0, xi, 0, 
  0, 0,   xi*xi,    0, 2*xi*eta,    0, 3*eta*eta,   0,
  0,0, xi*xi*xi, 0, 2*xi*xi*eta, 0, 3*xi*eta*eta,0,
  xi*xi*xi*xi,0,    2*xi*xi*xi*eta,    0,3*xi*xi*eta*eta, 0,
  2*xi*xi*xi*xi*eta,0,3*xi*xi*xi*eta*eta,0,
  3*xi*xi*xi*xi*eta*eta,0  };
  double mon_y[40]={0, 0, 0, 0, 0, 1, 
  0, 0, 0, 2*eta, 0, xi,
  0, 0,     0, xi*xi,     0, 2*xi*eta,     0,3*eta*eta,
  0, xi*xi*xi, 0, 2*xi*xi*eta, 0, 3*xi*eta*eta, 0, 4*eta*eta*eta,
  0, 2*xi*xi*xi*eta,     0, 3*xi*xi*eta*eta,    0, 4*xi*eta*eta*eta,
  0, 3*xi*xi*xi*eta*eta, 0, 4*xi*xi*eta*eta*eta,
  0, 4*xi*xi*xi*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in xi-xi direction
static void N_Q_RT3_2D_DeriveXiXi(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={0,0,0,0 ,0,0,
  2,0,   0, 0, 0, 0, 
  6*xi, 0,   2*eta,    0, 0,    0, 0,   0,
  12*xi*xi,0, 6*xi*eta, 0, 2*eta*eta, 0, 0,0,
  12*xi*xi*eta,0,    6*xi*eta*eta,    0,2*eta*eta*eta, 0,
  12*xi*xi*eta*eta,0,6*xi*eta*eta*eta,0,
  12*xi*xi*eta*eta*eta,0  };
  double mon_y[40]={0, 0, 0, 0, 0, 0, 
  0, 2, 0, 0, 0, 0,
  0, 6*xi,     0, 2*eta,     0, 0,     0,0,
  0, 6*xi*eta, 0, 2*eta*eta, 0, 0, 0, 0,
  0, 6*xi*eta*eta,     0, 2*eta*eta*eta,    0, 0,
  0, 6*xi*eta*eta*eta, 0, 2*eta*eta*eta*eta,
  0, 6*xi*eta*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in eta-eta direction
static void N_Q_RT3_2D_DeriveEtaEta(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={0,0,0,0 ,0,0,
  0,0, 2, 0, 0, 0, 
  0, 0,   0,    0, 2*xi,    0, 6*eta,   0,
  0,0, 0, 0, 2*xi*xi, 0, 6*xi*eta,0,
  0,0,    2*xi*xi*xi,    0,6*xi*xi*eta, 0,
  2*xi*xi*xi*xi, 0, 6*xi*xi*xi*eta, 0,
  6*xi*xi*xi*xi*eta,0  };
  double mon_y[40]={0, 0, 0, 0, 0, 0, 
  0, 0, 0, 2, 0, 0,
  0, 0,     0, 0,     0, 2*xi,     0,6*eta,
  0, 0, 0, 2*xi*xi, 0, 6*xi*eta, 0, 12*eta*eta,
  0, 2*xi*xi*xi,     0, 6*xi*xi*eta,    0, 12*eta*eta*eta,
  0, 6*xi*xi*xi*eta, 0, 12*xi*xi*eta*eta,
  0, 12*xi*xi*xi*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}

// values of derivatives in xi-eta direction
static void N_Q_RT3_2D_DeriveXiEta(double xi, double eta, double *values)
{
  int nBF = 40; // number of basis functions
  // monomials x-component and y-component
  double mon_x[40]={0,0,0,0 ,0,0,
  0,0,   0, 0, 1, 0, 
  0, 0,   2*xi,    0, 2*eta,    0, 0,   0,
  0,0, 3*xi*xi, 0, 4*xi*eta, 0, 3*eta*eta,0,
  4*xi*xi*xi,0,    6*xi*xi*eta,    0,6*xi*eta*eta, 0,
  8*xi*xi*xi*eta,0,9*xi*xi*eta*eta,0,
  12*xi*xi*xi*eta*eta,0  };
  double mon_y[40]={0, 0, 0, 0, 0, 0, 
  0, 0, 0, 0, 0, 1,
  0, 0,     0, 2*xi,     0, 2*eta,     0,0,
  0, 3*xi*xi, 0, 4*xi*eta, 0, 3*eta*eta, 0, 0,
  0, 6*xi*xi*eta,     0, 6*xi*eta*eta,    0, 4*eta*eta*eta,
  0, 9*xi*xi*eta*eta, 0, 8*xi*eta*eta*eta,
  0, 12*xi*xi*eta*eta*eta};
  
  memset(values, 0.0, 2*nBF*SizeOfDouble); // 2 is the space dimension
  for(int i=0; i<nBF; i++)
  {
    for(int j=0; j<nBF; j++)
    {
      values[i    ] += N_Q_RT3_2D_CM[i+j*nBF]*mon_x[j];
      values[i+nBF] += N_Q_RT3_2D_CM[i+j*nBF]*mon_y[j];
    }
  }
}


// ***********************************************************************

TBaseFunct2D *BF_N_Q_RT3_2D_Obj = new TBaseFunct2D
        (40, BF_N_Q_RT3_2D, BFUnitSquare, 
         N_Q_RT3_2D_Funct, N_Q_RT3_2D_DeriveXi,
         N_Q_RT3_2D_DeriveEta, N_Q_RT3_2D_DeriveXiXi,
         N_Q_RT3_2D_DeriveXiEta, N_Q_RT3_2D_DeriveEtaEta, 7, 4,
         0, NULL, 2);
