/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// Q4Rot element, nonconforming, 3D
// ***********************************************************************

static void N_H_Q4_3D_Funct(double xi, double eta, double zeta,
                          double *values)
{
  double t1, t2, t3, t4, t5, t6, t7, t8, t10, t12, t13, t14, t15, t16, t17;
  double t19, t20, t21, t22, t23, t24, t26, t27, t28, t29, t30, t32, t33;
  double t34, t35, t37, t39, t40, t42, t43, t44, t46, t48, t49, t51, t52;
  double t53, t58, t59, t61, t62, t63, t65, t66, t68, t69, t70, t75, t77;
  double t80, t85, t87, t88, t89, t90, t91, t93, t95, t97, t98, t99, t100;
  double t101, t102, t104, t109, t111, t112, t113, t114, t115, t116, t118;
  double t119, t120, t122, t123, t124, t125, t126, t127, t132, t133, t134;
  double t136, t138, t139, t141, t142, t143, t144, t145, t146, t147, t148;
  double t150, t151, t152, t153, t154, t155, t158, t159, t160, t161, t162;
  double t168, t169, t170, t171, t172, t173, t175, t176, t177, t178, t179;
  double t180, t184, t185, t186, t189, t190, t191, t192, t193, t194, t195;
  double t196, t197, t199, t200, t201, t202, t203, t205, t206, t207, t208;
  double t209, t210, t211, t212, t214, t215, t216, t217, t218, t219, t220;
  double t263, t264, t265, t266, t267, t268, t274, t275, t276;

  t1 = eta*eta;
  t2 = t1*t1;
  t3 = 35.0/8.0*t2;
  t4 = 15.0/4.0*t1;
  t5 = 3.0/8.0+t3-t4;
  t6 = zeta*zeta;
  t7 = t6*zeta;
  t8 = 5.0/2.0*t7;
  t10 = t8-3.0/2.0*zeta;
  t12 = t5*t10/2.0;
  t13 = xi*xi;
  t14 = t13*t13;
  t15 = 35.0/8.0*t14;
  t16 = 15.0/4.0*t13;
  t17 = 3.0/8.0+t15-t16;
  t19 = t17*t10/2.0;
  t20 = 5.0/4.0*t7;
  t21 = t6*t6;
  t22 = 35.0/16.0*t21;
  t23 = 15.0/8.0*t6;
  t24 = 3.0/4.0*zeta;
  t26 = t1*eta;
  t27 = 5.0/4.0*t26;
  t28 = 15.0/8.0*t1;
  t29 = 35.0/16.0*t2;
  t30 = 5.0/2.0*t26;
  t32 = t30-3.0/2.0*eta;
  t33 = 35.0/8.0*t21;
  t34 = 15.0/4.0*t6;
  t35 = 3.0/8.0+t33-t34;
  t37 = t32*t35/2.0;
  t39 = t17*t32/2.0;
  t40 = 3.0/4.0*eta;
  t42 = 15.0/8.0*t13;
  t43 = t13*xi;
  t44 = 5.0/2.0*t43;
  t46 = t44-3.0/2.0*xi;
  t48 = t46*t5/2.0;
  t49 = 5.0/4.0*t43;
  t51 = t46*t35/2.0;
  t52 = 35.0/16.0*t14;
  t53 = 3.0/4.0*xi;
  t58 = xi*t10;
  t59 = t58/2.0;
  t61 = -1.0/2.0+3.0/2.0*t6;
  t62 = t46*t61;
  t63 = t62/2.0;
  t65 = -1.0/2.0+3.0/2.0*t1;
  t66 = xi*t65;
  t68 = t66*t35/4.0;
  t69 = t46*t10;
  t70 = t69/4.0;
  t75 = 63.0/8.0*t21*zeta-35.0/4.0*t7+15.0/8.0*zeta;
  t77 = t46*t75/4.0;
  t80 = xi*t5*t61/4.0;
  t85 = 63.0/8.0*t14*xi-35.0/4.0*t43+15.0/8.0*xi;
  t87 = t85*t10/4.0;
  t88 = t66*t61;
  t89 = t88/4.0;
  t90 = xi*t61;
  t91 = t90/2.0;
  t93 = t17*t65;
  t95 = t93*zeta/4.0;
  t97 = -1.0/2.0+3.0/2.0*t13;
  t98 = t97*t65;
  t99 = t98*zeta;
  t100 = t99/4.0;
  t101 = t65*t10;
  t102 = t101/2.0;
  t104 = t32*t75/4.0;
  t109 = 63.0/8.0*t2*eta-35.0/4.0*t26+15.0/8.0*eta;
  t111 = t109*t10/4.0;
  t112 = t65*zeta;
  t113 = t112/2.0;
  t114 = t32*t10;
  t115 = t114/4.0;
  t116 = t97*t5;
  t118 = t116*zeta/4.0;
  t119 = t32*zeta;
  t120 = t119/2.0;
  t122 = t97*zeta;
  t123 = t122/2.0;
  t124 = t97*t10;
  t125 = t124/2.0;
  t126 = t46*zeta;
  t127 = t126/2.0;
  t132 = t17*eta*t61/4.0;
  t133 = t97*t32;
  t134 = t133/2.0;
  t136 = t85*t32/4.0;
  t138 = t46*t109/4.0;
  t139 = t97*eta;
  t141 = t139*t35/4.0;
  t142 = t139/2.0;
  t143 = t139*t61;
  t144 = t143/4.0;
  t145 = t46*t32;
  t146 = t145/4.0;
  t147 = t46*eta;
  t148 = t147/2.0;
  t150 = eta*t10;
  t151 = t150/2.0;
  t152 = t32*t61;
  t153 = t152/2.0;
  t154 = eta*t61;
  t155 = t154/2.0;
  t158 = t66/2.0;
  t159 = t46*t65;
  t160 = t159/2.0;
  t161 = xi*t32;
  t162 = t161/2.0;
  t168 = t97*t61;
  t169 = t168/4.0;
  t170 = t97*t35;
  t171 = t170/4.0;
  t172 = t17*t61;
  t173 = t172/4.0;
  t175 = t65*t61;
  t176 = t175/4.0;
  t177 = t5*t61;
  t178 = t177/4.0;
  t179 = t65*t35;
  t180 = t179/4.0;
  t184 = t98/4.0;
  t185 = t93/4.0;
  t186 = t116/4.0;
  t189 = t161*zeta;
  t190 = t189/6.0;
  t191 = t147*zeta;
  t192 = t191/6.0;
  t193 = xi*eta;
  t194 = t193*t10;
  t195 = t194/3.0;
  t196 = t193*t61;
  t197 = t196/2.0;
  t199 = t193*zeta/6.0;
  t200 = t147*t61;
  t201 = t200/2.0;
  t202 = t161*t61;
  t203 = t202/2.0;
  t205 = t66*t10;
  t206 = t205/2.0;
  t207 = t159*zeta;
  t208 = t207/2.0;
  t209 = t189/3.0;
  t210 = t66*zeta;
  t211 = t210/2.0;
  t212 = t194/6.0;
  t214 = t191/3.0;
  t215 = t133*zeta;
  t216 = t215/2.0;
  t217 = t139*t10;
  t218 = t217/2.0;
  t219 = t139*zeta;
  t220 = t219/2.0;
  t263 = t98/2.0;
  t264 = t93/2.0;
  t265 = t168/2.0;
  t266 = t116/2.0;
  t267 = t170/2.0;
  t268 = t172/2.0;
  t274 = t175/2.0;
  t275 = t177/2.0;
  t276 = t179/2.0;

  values[0] = t12+t19-t20+t22-t23+t24+3.0/16.0;
  values[1] = -t27-t28+t29+t37+t39+t40+3.0/16.0;
  values[2] = -t42-t48+t49-t51+t52-t53+3.0/16.0;
  values[3] = t27-t28+t29-t37-t39-t40+3.0/16.0;
  values[4] = -t42+t48-t49+t51+t52+t53+3.0/16.0;
  values[5] = -t12-t19+t20+t22-t23-t24+3.0/16.0;
  values[6] = -t59+t51-t63+t68+t70-t77-t80+t87-t89+t91;
  values[7] = t12-t95-t100-t102+t104-t111+t113+t115+t118-t120;
  values[8] = t123+t95+t19-t100-t125-t70-t77+t87+t127-t118;
  values[9] = t12-t95-t100-t102-t104+t111+t113-t115+t118+t120;
  values[10] = t132-t134-t136+t138-t141+t142-t144+t39+t146-t148;
  values[11] = -t132+t151+t141+t37+t104-t153-t144-t111+t155-t115;
  values[12] = -t132-t151+t141+t37-t104-t153-t144+t111+t155+t115;
  values[13] = t158+t48-t160+t136-t138-t68+t146+t80-t89-t162;
  values[14] = t132-t134+t136-t138-t141+t142-t144+t39-t146+t148;
  values[15] = -t158-t48+t160+t136-t138+t68+t146-t80+t89-t162;
  values[16] = t123+t95+t19-t100-t125+t70+t77-t87-t127-t118;
  values[17] = t59+t51-t63+t68-t70+t77-t80-t87-t89+t91;
  values[18] = t19+t169-t125+t171-t173;
  values[19] = t176+t37-t153+t178-t180;
  values[20] = -t51+t63+t169-t171+t173;
  values[21] = t176-t37+t153+t178-t180;
  values[22] = t48-t160+t184+t185-t186;
  values[23] = -t12+t176+t102-t178+t180;
  values[24] = t190+t192-t195+t197-t199-t201-t203;
  values[25] = -t206-t208-t209+t192+t211+t212-t199;
  values[26] = -t190+t214-t212-t216+t199-t218+t220;
  values[27] = t206+t208-t209+t192-t211+t212-t199;
  values[28] = t190-t214+t212-t216-t199-t218+t220;
  values[29] = -t190-t192+t195+t197+t199-t201-t203;
  values[30] = t12+t176-t102-t178+t180;
  values[31] = t184-t134-t185+t186+t39;
  values[32] = -t48+t160+t184+t185-t186;
  values[33] = t184+t134-t185+t186-t39;
  values[34] = t51-t63+t169-t171+t173;
  values[35] = -t19+t169+t125+t171-t173;
  values[36] = t51-t70-t77+t87;
  values[37] = t12+t104-t111-t115;
  values[38] = t19+t70-t77+t87;
  values[39] = t12-t104+t111+t115;
  values[40] = -t136+t138+t39-t146;
  values[41] = t37+t104-t111+t115;
  values[42] = -t132+t141+t144-t218;
  values[43] = -t68+t80+t89-t203;
  values[44] = t132-t141+t144+t201;
  values[45] = t68-t80-t89-t203;
  values[46] = -t208+t95+t100-t118;
  values[47] = t206+t68-t80+t89;
  values[48] = -t206+t68-t80+t89;
  values[49] = -t95+t100-t216+t118;
  values[50] = t208+t95+t100-t118;
  values[51] = -t95+t100+t216+t118;
  values[52] = t132-t141+t144-t201;
  values[53] = -t132+t141+t144+t218;
  values[54] = t37-t104+t111-t115;
  values[55] = t48+t136-t138-t146;
  values[56] = t136-t138+t39+t146;
  values[57] = -t48+t136-t138-t146;
  values[58] = t19-t70+t77-t87;
  values[59] = t51+t70+t77-t87;
  values[60] = t16-1.0/8.0+t4-t3-t15-t33+t34;
  values[61] = -t66-t44+t159+t62+5.0/2.0*xi+t88-t90;
  values[62] = -t30+t133-t139+t152+t143+5.0/2.0*eta-t154;
  values[63] = -t122+t99-t8+t101+t124+5.0/2.0*zeta-t112;
  values[64] = 21.0/4.0*t13-t263-7.0/8.0+t264-t265-t15-t266-t267+t268;
  values[65] = t193-t196+t145+t200-t147-t161+t202;
  values[66] = t205+t207-t58-t210+xi*zeta+t69-t126;
  values[67] = 21.0/4.0*t1-t263-7.0/8.0-t3-t274-t264+t266+t275-t276;
  values[68] = -t150+eta*zeta+t215+t217-t219+t114-t119;
  values[69] = -7.0/8.0-t274-t265-t33-t275+t276+21.0/4.0*t6+t267-t268;
}

static void N_H_Q4_3D_DeriveXi(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t3, t5, t6, t7, t8, t10, t12, t13, t14, t15, t17, t19, t20, t21;
  double t22, t23, t26, t28, t29, t30, t33, t35, t36, t39, t40, t41, t42;
  double t43, t44, t45, t46, t48, t49, t50, t57, t59, t60, t63, t65, t66;
  double t67, t68, t69, t70, t72, t73, t74, t75, t76, t78, t79, t80, t81;
  double t82, t83, t84, t85, t89, t90, t91, t93, t100, t101, t103, t104;
  double t105, t106, t107, t108, t109, t110, t112, t113, t114, t115, t116;
  double t117, t118, t120, t122, t123, t124, t125, t126, t127, t128, t131;
  double t132, t133, t135, t136, t137, t138, t139, t140, t141, t142, t144;
  double t145, t146, t147, t148, t150, t151, t152, t153, t154, t155, t156;
  double t157, t159, t160, t161, t162, t163, t164, t165, t199, t200, t201;
  double t202, t203, t204;

  t1 = xi*xi;
  t2 = t1*xi;
  t3 = 35.0/2.0*t2;
  t5 = t3-15.0/2.0*xi;
  t6 = zeta*zeta;
  t7 = t6*zeta;
  t8 = 5.0/2.0*t7;
  t10 = t8-3.0/2.0*zeta;
  t12 = t5*t10/2.0;
  t13 = eta*eta;
  t14 = t13*eta;
  t15 = 5.0/2.0*t14;
  t17 = t15-3.0/2.0*eta;
  t19 = t5*t17/2.0;
  t20 = 15.0/4.0*xi;
  t21 = 15.0/2.0*t1;
  t22 = t21-3.0/2.0;
  t23 = t13*t13;
  t26 = 3.0/8.0+35.0/8.0*t23-15.0/4.0*t13;
  t28 = t22*t26/2.0;
  t29 = 15.0/4.0*t1;
  t30 = t6*t6;
  t33 = 3.0/8.0+35.0/8.0*t30-15.0/4.0*t6;
  t35 = t22*t33/2.0;
  t36 = 35.0/4.0*t2;
  t39 = 5.0/4.0*t7;
  t40 = 3.0/4.0*zeta;
  t41 = 3.0/2.0*t6;
  t42 = -1.0/2.0+t41;
  t43 = t22*t42;
  t44 = t43/2.0;
  t45 = 3.0/2.0*t13;
  t46 = -1.0/2.0+t45;
  t48 = t46*t33/4.0;
  t49 = t22*t10;
  t50 = t49/4.0;
  t57 = t22*(63.0/8.0*t30*zeta-35.0/4.0*t7+15.0/8.0*zeta)/4.0;
  t59 = t26*t42/4.0;
  t60 = t1*t1;
  t63 = 315.0/8.0*t60-105.0/4.0*t1+15.0/8.0;
  t65 = t63*t10/4.0;
  t66 = t46*t42;
  t67 = t66/4.0;
  t68 = 3.0/4.0*t6;
  t69 = -t39+t40+t35-t44+t48+t50-t57-t59+t65-t67-1.0/4.0+t68;
  t70 = t46*t5;
  t72 = t70*zeta/4.0;
  t73 = xi*t46;
  t74 = t73*zeta;
  t75 = 3.0/4.0*t74;
  t76 = xi*t26;
  t78 = 3.0/4.0*t76*zeta;
  t79 = -t72-t75+t78;
  t80 = xi*zeta;
  t81 = 3.0/2.0*t80;
  t82 = xi*t10;
  t83 = 3.0/2.0*t82;
  t84 = t22*zeta;
  t85 = t84/2.0;
  t89 = t5*eta*t42/4.0;
  t90 = xi*t17;
  t91 = 3.0/2.0*t90;
  t93 = t63*t17/4.0;
  t100 = t22*(63.0/8.0*t23*eta-35.0/4.0*t14+15.0/8.0*eta)/4.0;
  t101 = xi*eta;
  t103 = 3.0/4.0*t101*t33;
  t104 = 3.0/2.0*t101;
  t105 = t101*t42;
  t106 = 3.0/4.0*t105;
  t107 = t22*t17;
  t108 = t107/4.0;
  t109 = t22*eta;
  t110 = t109/2.0;
  t112 = -t89+t103-t106;
  t113 = 3.0/4.0*t13;
  t114 = t22*t46;
  t115 = t114/2.0;
  t116 = 5.0/4.0*t14;
  t117 = 3.0/4.0*eta;
  t118 = -1.0/4.0+t113+t28-t115+t93-t100-t48+t108+t59-t67-t116+t117;
  t120 = 1.0/4.0-t113-t28+t115+t93-t100+t48+t108-t59+t67-t116+t117;
  t122 = t39-t40+t35-t44+t48-t50+t57-t59-t65-t67-1.0/4.0+t68;
  t123 = xi*t42;
  t124 = 3.0/4.0*t123;
  t125 = xi*t33;
  t126 = 3.0/4.0*t125;
  t127 = t5*t42;
  t128 = t127/4.0;
  t131 = 3.0/4.0*t73;
  t132 = t70/4.0;
  t133 = 3.0/4.0*t76;
  t135 = t17*zeta;
  t136 = t135/6.0;
  t137 = t109*zeta;
  t138 = t137/6.0;
  t139 = eta*t10;
  t140 = t139/3.0;
  t141 = eta*t42;
  t142 = t141/2.0;
  t144 = eta*zeta/6.0;
  t145 = t109*t42;
  t146 = t145/2.0;
  t147 = t17*t42;
  t148 = t147/2.0;
  t150 = t46*t10;
  t151 = t150/2.0;
  t152 = t114*zeta;
  t153 = t152/2.0;
  t154 = t135/3.0;
  t155 = t46*zeta;
  t156 = t155/2.0;
  t157 = t139/6.0;
  t159 = t137/3.0;
  t160 = t90*zeta;
  t161 = 3.0/2.0*t160;
  t162 = t101*t10;
  t163 = 3.0/2.0*t162;
  t164 = t101*zeta;
  t165 = 3.0/2.0*t164;
  t199 = 3.0/2.0*t73;
  t200 = t70/2.0;
  t201 = 3.0/2.0*t123;
  t202 = 3.0/2.0*t76;
  t203 = 3.0/2.0*t125;
  t204 = t127/2.0;

  values[0] = t12;
  values[1] = t19;
  values[2] = -t20-t28+t29-t35+t36-3.0/4.0;
  values[3] = -t19;
  values[4] = -t20+t28-t29+t35+t36+3.0/4.0;
  values[5] = -t12;
  values[6] = t69;
  values[7] = t79;
  values[8] = t81+t72+t12-t75-t83-t50-t57+t65+t85-t78;
  values[9] = t79;
  values[10] = t89-t91-t93+t100-t103+t104-t106+t19+t108-t110;
  values[11] = t112;
  values[12] = t112;
  values[13] = t118;
  values[14] = t89-t91+t93-t100-t103+t104-t106+t19-t108+t110;
  values[15] = t120;
  values[16] = t81+t72+t12-t75-t83+t50+t57-t65-t85-t78;
  values[17] = t122;
  values[18] = t12+t124-t83+t126-t128;
  values[19] = 0.0;
  values[20] = -t35+t44+t124-t126+t128;
  values[21] = 0.0;
  values[22] = t28-t115+t131+t132-t133;
  values[23] = 0.0;
  values[24] = t136+t138-t140+t142-t144-t146-t148;
  values[25] = -t151-t153-t154+t138+t156+t157-t144;
  values[26] = -t136+t159-t157-t161+t144-t163+t165;
  values[27] = t151+t153-t154+t138-t156+t157-t144;
  values[28] = t136-t159+t157-t161-t144-t163+t165;
  values[29] = -t136-t138+t140+t142+t144-t146-t148;
  values[30] = 0.0;
  values[31] = t131-t91-t132+t133+t19;
  values[32] = -t28+t115+t131+t132-t133;
  values[33] = t131+t91-t132+t133-t19;
  values[34] = t35-t44+t124-t126+t128;
  values[35] = -t12+t124+t83+t126-t128;
  values[36] = t35-t50-t57+t65;
  values[37] = 0.0;
  values[38] = t12+t50-t57+t65;
  values[39] = 0.0;
  values[40] = -t93+t100+t19-t108;
  values[41] = 0.0;
  values[42] = -t89+t103+t106-t163;
  values[43] = -t48+t59+t67-t148;
  values[44] = t89-t103+t106+t146;
  values[45] = t48-t59-t67-t148;
  values[46] = -t153+t72+t75-t78;
  values[47] = t151+t48-t59+t67;
  values[48] = -t151+t48-t59+t67;
  values[49] = -t72+t75-t161+t78;
  values[50] = t153+t72+t75-t78;
  values[51] = -t72+t75+t161+t78;
  values[52] = t89-t103+t106-t146;
  values[53] = -t89+t103+t106+t163;
  values[54] = 0.0;
  values[55] = t28+t93-t100-t108;
  values[56] = t93-t100+t19+t108;
  values[57] = -t28+t93-t100-t108;
  values[58] = t12-t50+t57-t65;
  values[59] = t35+t50+t57-t65;
  values[60] = -t5;
  values[61] = 7.0/2.0-t45-t21+t114+t43+t66-t41;
  values[62] = 3.0*t90-3.0*t101+3.0*t105;
  values[63] = -3.0*t80+3.0*t74+3.0*t82;
  values[64] = 21.0/2.0*xi-t199+t200-t201-t3-t202-t203+t204;
  values[65] = 5.0/2.0*eta-t141+t107+t145-t109-t15+t147;
  values[66] = t150+t152-t8+5.0/2.0*zeta-t155+t49-t84;
  values[67] = -t199-t200+t202;
  values[68] = 3.0*t160+3.0*t162-3.0*t164;
  values[69] = -t201+t203-t204;
}

static void N_H_Q4_3D_DeriveEta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t3, t5, t6, t7, t8, t10, t12, t13, t14, t15, t16, t17, t18, t21;
  double t23, t24, t25, t28, t30, t32, t33, t35, t37, t39, t41, t43, t44;
  double t46, t47, t48, t49, t50, t52, t53, t54, t55, t56, t57, t58, t59;
  double t66, t67, t70, t72, t73, t74, t75, t76, t77, t79, t80, t81, t83;
  double t86, t87, t88, t95, t97, t99, t100, t101, t102, t103, t104, t105;
  double t106, t107, t108, t109, t110, t111, t112, t113, t114, t115, t116;
  double t117, t118, t119, t121, t123, t124, t125, t126, t127, t128, t131;
  double t132, t133, t136, t137, t138, t139, t140, t141, t142, t143, t145;
  double t146, t147, t148, t149, t151, t152, t153, t154, t155, t156, t157;
  double t158, t160, t161, t162, t163, t164, t165, t166, t198, t199, t200;
  double t206, t207, t208;

  t1 = eta*eta;
  t2 = t1*eta;
  t3 = 35.0/2.0*t2;
  t5 = t3-15.0/2.0*eta;
  t6 = zeta*zeta;
  t7 = t6*zeta;
  t8 = 5.0/2.0*t7;
  t10 = t8-3.0/2.0*zeta;
  t12 = t5*t10/2.0;
  t13 = 15.0/4.0*t1;
  t14 = 15.0/4.0*eta;
  t15 = 35.0/4.0*t2;
  t16 = 15.0/2.0*t1;
  t17 = t16-3.0/2.0;
  t18 = t6*t6;
  t21 = 3.0/8.0+35.0/8.0*t18-15.0/4.0*t6;
  t23 = t17*t21/2.0;
  t24 = xi*xi;
  t25 = t24*t24;
  t28 = 3.0/8.0+35.0/8.0*t25-15.0/4.0*t24;
  t30 = t28*t17/2.0;
  t32 = t24*xi;
  t33 = 5.0/2.0*t32;
  t35 = t33-3.0/2.0*xi;
  t37 = t35*t5/2.0;
  t39 = xi*eta;
  t41 = 3.0/4.0*t39*t21;
  t43 = 3.0/2.0*t6;
  t44 = -1.0/2.0+t43;
  t46 = xi*t5*t44/4.0;
  t47 = t39*t44;
  t48 = 3.0/4.0*t47;
  t49 = t41-t46-t48;
  t50 = t28*eta;
  t52 = 3.0/4.0*t50*zeta;
  t53 = 3.0/2.0*t24;
  t54 = -1.0/2.0+t53;
  t55 = t54*eta;
  t56 = t55*zeta;
  t57 = 3.0/4.0*t56;
  t58 = eta*t10;
  t59 = 3.0/2.0*t58;
  t66 = t17*(63.0/8.0*t18*zeta-35.0/4.0*t7+15.0/8.0*zeta)/4.0;
  t67 = t1*t1;
  t70 = 315.0/8.0*t67-105.0/4.0*t1+15.0/8.0;
  t72 = t70*t10/4.0;
  t73 = eta*zeta;
  t74 = 3.0/2.0*t73;
  t75 = t17*t10;
  t76 = t75/4.0;
  t77 = t54*t5;
  t79 = t77*zeta/4.0;
  t80 = t17*zeta;
  t81 = t80/2.0;
  t83 = t52-t57-t79;
  t86 = t28*t44/4.0;
  t87 = t54*t17;
  t88 = t87/2.0;
  t95 = (63.0/8.0*t25*xi-35.0/4.0*t32+15.0/8.0*xi)*t17/4.0;
  t97 = t35*t70/4.0;
  t99 = t54*t21/4.0;
  t100 = 3.0/4.0*t24;
  t101 = t54*t44;
  t102 = t101/4.0;
  t103 = t35*t17;
  t104 = t103/4.0;
  t105 = 5.0/4.0*t32;
  t106 = 3.0/4.0*xi;
  t107 = t86-t88-t95+t97-t99-1.0/4.0+t100-t102+t30+t104-t105+t106;
  t108 = 5.0/4.0*t7;
  t109 = 3.0/4.0*zeta;
  t110 = t17*t44;
  t111 = t110/2.0;
  t112 = 3.0/4.0*t6;
  t113 = -t86+t108-t109+t99+t23+t66-t111-t102-t72-1.0/4.0+t112-t76;
  t114 = -t86-t108+t109+t99+t23-t66-t111-t102+t72-1.0/4.0+t112+t76;
  t115 = 3.0/2.0*t39;
  t116 = t35*eta;
  t117 = 3.0/2.0*t116;
  t118 = xi*t17;
  t119 = t118/2.0;
  t121 = t86-t88+t95-t97-t99-1.0/4.0+t100-t102+t30-t104+t105-t106;
  t123 = eta*t44;
  t124 = 3.0/4.0*t123;
  t125 = t5*t44;
  t126 = t125/4.0;
  t127 = eta*t21;
  t128 = 3.0/4.0*t127;
  t131 = 3.0/4.0*t55;
  t132 = 3.0/4.0*t50;
  t133 = t77/4.0;
  t136 = t118*zeta;
  t137 = t136/6.0;
  t138 = t35*zeta;
  t139 = t138/6.0;
  t140 = xi*t10;
  t141 = t140/3.0;
  t142 = xi*t44;
  t143 = t142/2.0;
  t145 = xi*zeta/6.0;
  t146 = t35*t44;
  t147 = t146/2.0;
  t148 = t118*t44;
  t149 = t148/2.0;
  t151 = t39*t10;
  t152 = 3.0/2.0*t151;
  t153 = t116*zeta;
  t154 = 3.0/2.0*t153;
  t155 = t136/3.0;
  t156 = t39*zeta;
  t157 = 3.0/2.0*t156;
  t158 = t140/6.0;
  t160 = t138/3.0;
  t161 = t87*zeta;
  t162 = t161/2.0;
  t163 = t54*t10;
  t164 = t163/2.0;
  t165 = t54*zeta;
  t166 = t165/2.0;
  t198 = 3.0/2.0*t55;
  t199 = 3.0/2.0*t50;
  t200 = t77/2.0;
  t206 = 3.0/2.0*t123;
  t207 = t125/2.0;
  t208 = 3.0/2.0*t127;

  values[0] = t12;
  values[1] = -t13-t14+t15+t23+t30+3.0/4.0;
  values[2] = -t37;
  values[3] = t13-t14+t15-t23-t30-3.0/4.0;
  values[4] = t37;
  values[5] = -t12;
  values[6] = t49;
  values[7] = t12-t52-t57-t59+t66-t72+t74+t76+t79-t81;
  values[8] = t83;
  values[9] = t12-t52-t57-t59-t66+t72+t74-t76+t79+t81;
  values[10] = t107;
  values[11] = t113;
  values[12] = t114;
  values[13] = t115+t37-t117+t95-t97-t41+t104+t46-t48-t119;
  values[14] = t121;
  values[15] = -t115-t37+t117+t95-t97+t41+t104-t46+t48-t119;
  values[16] = t83;
  values[17] = t49;
  values[18] = 0.0;
  values[19] = t124+t23-t111+t126-t128;
  values[20] = 0.0;
  values[21] = t124-t23+t111+t126-t128;
  values[22] = t37-t117+t131+t132-t133;
  values[23] = -t12+t124+t59-t126+t128;
  values[24] = t137+t139-t141+t143-t145-t147-t149;
  values[25] = -t152-t154-t155+t139+t157+t158-t145;
  values[26] = -t137+t160-t158-t162+t145-t164+t166;
  values[27] = t152+t154-t155+t139-t157+t158-t145;
  values[28] = t137-t160+t158-t162-t145-t164+t166;
  values[29] = -t137-t139+t141+t143+t145-t147-t149;
  values[30] = t12+t124-t59-t126+t128;
  values[31] = t131-t88-t132+t133+t30;
  values[32] = -t37+t117+t131+t132-t133;
  values[33] = t131+t88-t132+t133-t30;
  values[34] = 0.0;
  values[35] = 0.0;
  values[36] = 0.0;
  values[37] = t12+t66-t72-t76;
  values[38] = 0.0;
  values[39] = t12-t66+t72+t76;
  values[40] = -t95+t97+t30-t104;
  values[41] = t23+t66-t72+t76;
  values[42] = -t86+t99+t102-t164;
  values[43] = -t41+t46+t48-t149;
  values[44] = t86-t99+t102+t147;
  values[45] = t41-t46-t48-t149;
  values[46] = -t154+t52+t57-t79;
  values[47] = t152+t41-t46+t48;
  values[48] = -t152+t41-t46+t48;
  values[49] = -t52+t57-t162+t79;
  values[50] = t154+t52+t57-t79;
  values[51] = -t52+t57+t162+t79;
  values[52] = t86-t99+t102-t147;
  values[53] = -t86+t99+t102+t164;
  values[54] = t23-t66+t72-t76;
  values[55] = t37+t95-t97-t104;
  values[56] = t95-t97+t30+t104;
  values[57] = -t37+t95-t97-t104;
  values[58] = 0.0;
  values[59] = 0.0;
  values[60] = -t5;
  values[61] = -3.0*t39+3.0*t116+3.0*t47;
  values[62] = -t16+t87+7.0/2.0-t53+t110+t101-t43;
  values[63] = 3.0*t56+3.0*t58-3.0*t73;
  values[64] = -t198+t199-t200;
  values[65] = 5.0/2.0*xi-t142+t103+t146-t33-t118+t148;
  values[66] = 3.0*t151+3.0*t153-3.0*t156;
  values[67] = 21.0/2.0*eta-t198-t3-t206-t199+t200+t207-t208;
  values[68] = -t8+5.0/2.0*zeta+t161+t163-t165+t75-t80;
  values[69] = -t206-t207+t208;
}

static void N_H_Q4_3D_DeriveZeta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t5, t6, t7, t8, t10, t11, t12, t15, t17, t18, t19, t20, t21, t23;
  double t24, t26, t27, t29, t31, t32, t33, t35, t37, t39, t40, t41, t42;
  double t43, t44, t45, t47, t48, t49, t50, t53, t55, t58, t65, t66, t67;
  double t68, t69, t72, t73, t74, t75, t76, t77, t78, t80, t87, t88, t89;
  double t90, t92, t93, t94, t95, t96, t97, t98, t99, t100, t101, t102, t105;
  double t106, t108, t109, t110, t111, t112, t113, t114, t115, t116, t117;
  double t120, t121, t123, t124, t125, t126, t127, t128, t130, t131, t132;
  double t133, t134, t135, t140, t141, t142, t143, t144, t145, t146, t147;
  double t148, t149, t150, t151, t152, t153, t155, t156, t157, t158, t159;
  double t160, t161, t163, t164, t165, t166, t167, t168, t199, t200, t201;
  double t206, t207, t208;

  t1 = eta*eta;
  t2 = t1*t1;
  t5 = 3.0/8.0+35.0/8.0*t2-15.0/4.0*t1;
  t6 = zeta*zeta;
  t7 = 15.0/2.0*t6;
  t8 = t7-3.0/2.0;
  t10 = t5*t8/2.0;
  t11 = xi*xi;
  t12 = t11*t11;
  t15 = 3.0/8.0+35.0/8.0*t12-15.0/4.0*t11;
  t17 = t15*t8/2.0;
  t18 = 15.0/4.0*t6;
  t19 = t6*zeta;
  t20 = 35.0/4.0*t19;
  t21 = 15.0/4.0*zeta;
  t23 = t1*eta;
  t24 = 5.0/2.0*t23;
  t26 = t24-3.0/2.0*eta;
  t27 = 35.0/2.0*t19;
  t29 = t27-15.0/2.0*zeta;
  t31 = t26*t29/2.0;
  t32 = t11*xi;
  t33 = 5.0/2.0*t32;
  t35 = t33-3.0/2.0*xi;
  t37 = t35*t29/2.0;
  t39 = xi*t8;
  t40 = t39/2.0;
  t41 = t35*zeta;
  t42 = 3.0/2.0*t41;
  t43 = 3.0/2.0*t1;
  t44 = -1.0/2.0+t43;
  t45 = xi*t44;
  t47 = t45*t29/4.0;
  t48 = t35*t8;
  t49 = t48/4.0;
  t50 = t6*t6;
  t53 = 315.0/8.0*t50-105.0/4.0*t6+15.0/8.0;
  t55 = t35*t53/4.0;
  t58 = 3.0/4.0*xi*t5*zeta;
  t65 = (63.0/8.0*t12*xi-35.0/4.0*t32+15.0/8.0*xi)*t8/4.0;
  t66 = t45*zeta;
  t67 = 3.0/4.0*t66;
  t68 = xi*zeta;
  t69 = 3.0/2.0*t68;
  t72 = t15*t44/4.0;
  t73 = 3.0/2.0*t11;
  t74 = -1.0/2.0+t73;
  t75 = t74*t44;
  t76 = t75/4.0;
  t77 = t44*t8;
  t78 = t77/2.0;
  t80 = t26*t53/4.0;
  t87 = (63.0/8.0*t2*eta-35.0/4.0*t23+15.0/8.0*eta)*t8/4.0;
  t88 = 3.0/4.0*t1;
  t89 = t26*t8;
  t90 = t89/4.0;
  t92 = t74*t5/4.0;
  t93 = 5.0/4.0*t23;
  t94 = 3.0/4.0*eta;
  t95 = t10-t72-t76-t78+t80-t87-1.0/4.0+t88+t90+t92-t93+t94;
  t96 = 3.0/4.0*t11;
  t97 = t74*t8;
  t98 = t97/2.0;
  t99 = 5.0/4.0*t32;
  t100 = 3.0/4.0*xi;
  t101 = -1.0/4.0+t96+t72+t17-t76-t98-t49-t55+t65+t99-t100-t92;
  t102 = t10-t72-t76-t78-t80+t87-1.0/4.0+t88-t90+t92+t93-t94;
  t105 = 3.0/4.0*t15*eta*zeta;
  t106 = t74*eta;
  t108 = t106*t29/4.0;
  t109 = t106*zeta;
  t110 = 3.0/4.0*t109;
  t111 = t105-t108-t110;
  t112 = eta*t8;
  t113 = t112/2.0;
  t114 = t26*zeta;
  t115 = 3.0/2.0*t114;
  t116 = eta*zeta;
  t117 = 3.0/2.0*t116;
  t120 = -t47+t58-t67;
  t121 = -1.0/4.0+t96+t72+t17-t76-t98+t49+t55-t65-t99+t100-t92;
  t123 = t74*zeta;
  t124 = 3.0/4.0*t123;
  t125 = t74*t29;
  t126 = t125/4.0;
  t127 = t15*zeta;
  t128 = 3.0/4.0*t127;
  t130 = t44*zeta;
  t131 = 3.0/4.0*t130;
  t132 = t5*zeta;
  t133 = 3.0/4.0*t132;
  t134 = t44*t29;
  t135 = t134/4.0;
  t140 = xi*t26;
  t141 = t140/6.0;
  t142 = t35*eta;
  t143 = t142/6.0;
  t144 = xi*eta;
  t145 = t144*t8;
  t146 = t145/3.0;
  t147 = t144*zeta;
  t148 = 3.0/2.0*t147;
  t149 = t144/6.0;
  t150 = t142*zeta;
  t151 = 3.0/2.0*t150;
  t152 = t140*zeta;
  t153 = 3.0/2.0*t152;
  t155 = t45*t8;
  t156 = t155/2.0;
  t157 = t35*t44;
  t158 = t157/2.0;
  t159 = t140/3.0;
  t160 = t45/2.0;
  t161 = t145/6.0;
  t163 = t142/3.0;
  t164 = t74*t26;
  t165 = t164/2.0;
  t166 = t106*t8;
  t167 = t166/2.0;
  t168 = t106/2.0;
  t199 = 3.0/2.0*t123;
  t200 = t125/2.0;
  t201 = 3.0/2.0*t127;
  t206 = 3.0/2.0*t130;
  t207 = 3.0/2.0*t132;
  t208 = t134/2.0;

  values[0] = t10+t17-t18+t20-t21+3.0/4.0;
  values[1] = t31;
  values[2] = -t37;
  values[3] = -t31;
  values[4] = t37;
  values[5] = -t10-t17+t18+t20-t21-3.0/4.0;
  values[6] = -t40+t37-t42+t47+t49-t55-t58+t65-t67+t69;
  values[7] = t95;
  values[8] = t101;
  values[9] = t102;
  values[10] = t111;
  values[11] = -t105+t113+t108+t31+t80-t115-t110-t87+t117-t90;
  values[12] = -t105-t113+t108+t31-t80-t115-t110+t87+t117+t90;
  values[13] = t120;
  values[14] = t111;
  values[15] = -t120;
  values[16] = t121;
  values[17] = t40+t37-t42+t47-t49+t55-t58-t65-t67+t69;
  values[18] = t17+t124-t98+t126-t128;
  values[19] = t131+t31-t115+t133-t135;
  values[20] = -t37+t42+t124-t126+t128;
  values[21] = t131-t31+t115+t133-t135;
  values[22] = 0.0;
  values[23] = -t10+t131+t78-t133+t135;
  values[24] = t141+t143-t146+t148-t149-t151-t153;
  values[25] = -t156-t158-t159+t143+t160+t161-t149;
  values[26] = -t141+t163-t161-t165+t149-t167+t168;
  values[27] = t156+t158-t159+t143-t160+t161-t149;
  values[28] = t141-t163+t161-t165-t149-t167+t168;
  values[29] = -t141-t143+t146+t148+t149-t151-t153;
  values[30] = t10+t131-t78-t133+t135;
  values[31] = 0.0;
  values[32] = 0.0;
  values[33] = 0.0;
  values[34] = t37-t42+t124-t126+t128;
  values[35] = -t17+t124+t98+t126-t128;
  values[36] = t37-t49-t55+t65;
  values[37] = t10+t80-t87-t90;
  values[38] = t17+t49-t55+t65;
  values[39] = t10-t80+t87+t90;
  values[40] = 0.0;
  values[41] = t31+t80-t87+t90;
  values[42] = -t105+t108+t110-t167;
  values[43] = -t47+t58+t67-t153;
  values[44] = t105-t108+t110+t151;
  values[45] = t47-t58-t67-t153;
  values[46] = -t158+t72+t76-t92;
  values[47] = t156+t47-t58+t67;
  values[48] = -t156+t47-t58+t67;
  values[49] = -t72+t76-t165+t92;
  values[50] = t158+t72+t76-t92;
  values[51] = -t72+t76+t165+t92;
  values[52] = t105-t108+t110-t151;
  values[53] = -t105+t108+t110+t167;
  values[54] = t31-t80+t87-t90;
  values[55] = 0.0;
  values[56] = 0.0;
  values[57] = 0.0;
  values[58] = t17-t49+t55-t65;
  values[59] = t37+t49+t55-t65;
  values[60] = -t29;
  values[61] = 3.0*t41+3.0*t66-3.0*t68;
  values[62] = 3.0*t114+3.0*t109-3.0*t116;
  values[63] = 7.0/2.0-t73+t75-t7+t77+t97-t43;
  values[64] = -t199-t200+t201;
  values[65] = -3.0*t147+3.0*t150+3.0*t152;
  values[66] = t155+t157-t39-t45+5.0/2.0*xi+t48-t33;
  values[67] = -t206+t207-t208;
  values[68] = -t112+5.0/2.0*eta+t164+t166-t106+t89-t24;
  values[69] = -t206-t199-t27-t207+t208+21.0/2.0*zeta+t200-t201;
}

static void N_H_Q4_3D_DeriveXiXi(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t3, t4, t5, t8, t10, t11, t12, t15, t17, t18, t21, t23, t24, t25;
  double t28, t30, t31, t35, t36, t37, t38, t39, t46, t50, t52, t55, t56;
  double t58, t59, t60, t62, t63, t64, t65, t66, t67, t71, t72, t73, t75;
  double t82, t84, t85, t86, t87, t88, t89, t90, t92, t93, t94, t100, t101;
  double t102, t103, t104, t106, t108, t109, t110, t112, t113, t114, t115;
  double t117, t118, t120, t121, t122, t123, t124, t125, t126, t131, t132;
  double t164, t166, t167, t168;
  
  t1 = xi*xi;
  t2 = 105.0/2.0*t1;
  t3 = t2-15.0/2.0;
  t4 = zeta*zeta;
  t5 = t4*zeta;
  t8 = 5.0/2.0*t5-3.0/2.0*zeta;
  t10 = t3*t8/2.0;
  t11 = eta*eta;
  t12 = t11*eta;
  t15 = 5.0/2.0*t12-3.0/2.0*eta;
  t17 = t3*t15/2.0;
  t18 = t11*t11;
  t21 = 3.0/8.0+35.0/8.0*t18-15.0/4.0*t11;
  t23 = 15.0/2.0*xi*t21;
  t24 = 15.0/2.0*xi;
  t25 = t4*t4;
  t28 = 3.0/8.0+35.0/8.0*t25-15.0/4.0*t4;
  t30 = 15.0/2.0*xi*t28;
  t31 = 105.0/4.0*t1;
  t35 = -1.0/2.0+3.0/2.0*t4;
  t36 = xi*t35;
  t37 = 15.0/2.0*t36;
  t38 = xi*t8;
  t39 = 15.0/4.0*t38;
  t46 = 15.0/4.0*xi*(63.0/8.0*t25*zeta-35.0/4.0*t5+15.0/8.0*zeta);
  t50 = 315.0/2.0*t1*xi-105.0/2.0*xi;
  t52 = t50*t8/4.0;
  t55 = -1.0/2.0+3.0/2.0*t11;
  t56 = t3*t55;
  t58 = t56*zeta/4.0;
  t59 = t55*zeta;
  t60 = 3.0/4.0*t59;
  t62 = 3.0/4.0*t21*zeta;
  t63 = -t58-t60+t62;
  t64 = 15.0/4.0*zeta;
  t65 = 15.0/4.0*t5;
  t66 = xi*zeta;
  t67 = 15.0/2.0*t66;
  t71 = t3*eta*t35/4.0;
  t72 = 15.0/4.0*t12;
  t73 = 15.0/4.0*eta;
  t75 = t50*t15/4.0;
  t82 = 15.0/4.0*xi*(63.0/8.0*t18*eta-35.0/4.0*t12+15.0/8.0*eta);
  t84 = 3.0/4.0*eta*t28;
  t85 = eta*t35;
  t86 = 3.0/4.0*t85;
  t87 = xi*t15;
  t88 = 15.0/4.0*t87;
  t89 = xi*eta;
  t90 = 15.0/2.0*t89;
  t92 = -t71+t84-t86;
  t93 = xi*t55;
  t94 = 15.0/2.0*t93;
  t100 = 27.0/16.0*t4;
  t101 = 9.0/4.0*zeta;
  t102 = 105.0/32.0*t25;
  t103 = t3*t35;
  t104 = t103/4.0;
  t106 = 63.0/16.0*t4;
  t108 = 63.0/16.0*t11;
  t109 = t56/4.0;
  t110 = 105.0/32.0*t18;
  t112 = t89*zeta;
  t113 = 5.0/2.0*t112;
  t114 = t89*t35;
  t115 = 15.0/2.0*t114;
  t117 = t93*zeta;
  t118 = 15.0/2.0*t117;
  t120 = 5.0*t112;
  t121 = t15*zeta;
  t122 = 3.0/2.0*t121;
  t123 = eta*t8;
  t124 = 3.0/2.0*t123;
  t125 = eta*zeta;
  t126 = 3.0/2.0*t125;
  t131 = 27.0/16.0*t11;
  t132 = 9.0/4.0*eta;
  t164 = t56/2.0;
  t166 = 105.0/16.0*t18;
  t167 = 105.0/16.0*t25;
  t168 = t103/2.0;

  values[0] = t10;
  values[1] = t17;
  values[2] = -15.0/4.0-t23+t24-t30+t31;
  values[3] = -t17;
  values[4] = -15.0/4.0+t23-t24+t30+t31;
  values[5] = -t10;
  values[6] = t30-t37+t39-t46+t52;
  values[7] = t63;
  values[8] = t64+t58+t10-t60-t65-t39-t46+t52+t67-t62;
  values[9] = t63;
  values[10] = t71-t72+t73-t75+t82-t84-t86+t17+t88-t90;
  values[11] = t92;
  values[12] = t92;
  values[13] = t23-t94+t75-t82+t88;
  values[14] = t71-t72+t73+t75-t82-t84-t86+t17-t88+t90;
  values[15] = -t23+t94+t75-t82+t88;
  values[16] = t64+t58+t10-t60-t65+t39+t46-t52-t67-t62;
  values[17] = t30-t37-t39+t46-t52;
  values[18] = t10-3.0/32.0-t100-t65+t101+t102-t104;
  values[19] = 0.0;
  values[20] = -t30+t37-21.0/32.0+t106-t102+t104;
  values[21] = 0.0;
  values[22] = t23-t94-21.0/32.0+t108+t109-t110;
  values[23] = 0.0;
  values[24] = t113-t115;
  values[25] = -t118+t113;
  values[26] = t120-t122-t124+t126;
  values[27] = t118+t113;
  values[28] = -t120-t122-t124+t126;
  values[29] = -t113-t115;
  values[30] = 0.0;
  values[31] = -3.0/32.0-t131-t72+t132-t109+t110+t17;
  values[32] = -t23+t94-21.0/32.0+t108+t109-t110;
  values[33] = -3.0/32.0-t131+t72-t132-t109+t110-t17;
  values[34] = t30-t37-21.0/32.0+t106-t102+t104;
  values[35] = -t10-3.0/32.0-t100+t65-t101+t102-t104;
  values[36] = t30-t39-t46+t52;
  values[37] = 0.0;
  values[38] = t10+t39-t46+t52;
  values[39] = 0.0;
  values[40] = -t75+t82+t17-t88;
  values[41] = 0.0;
  values[42] = -t71+t84+t86-t124;
  values[43] = 0.0;
  values[44] = t71-t84+t86+t115;
  values[45] = 0.0;
  values[46] = -t118+t58+t60-t62;
  values[47] = 0.0;
  values[48] = 0.0;
  values[49] = -t58+t60-t122+t62;
  values[50] = t118+t58+t60-t62;
  values[51] = -t58+t60+t122+t62;
  values[52] = t71-t84+t86-t115;
  values[53] = -t71+t84+t86+t124;
  values[54] = 0.0;
  values[55] = t23+t75-t82-t88;
  values[56] = t75-t82+t17+t88;
  values[57] = -t23+t75-t82-t88;
  values[58] = t10-t39+t46-t52;
  values[59] = t30+t39+t46-t52;
  values[60] = -t3;
  values[61] = -15.0*xi+15.0*t93+15.0*t36;
  values[62] = 15.0/2.0*t12-15.0/2.0*eta+3.0*t85;
  values[63] = -15.0/2.0*zeta+3.0*t59+15.0/2.0*t5;
  values[64] = 87.0/8.0+27.0/8.0*t11+t164+27.0/8.0*t4-t2-t166-t167+t168;
  values[65] = 15.0*t87+15.0*t114-15.0*t89;
  values[66] = 15.0*t117+15.0*t38-15.0*t66;
  values[67] = 21.0/16.0-63.0/8.0*t11-t164+t166;
  values[68] = 3.0*t121+3.0*t123-3.0*t125;
  values[69] = 21.0/16.0-63.0/8.0*t4+t167-t168;
}

static void N_H_Q4_3D_DeriveXiEta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t5, t6, t7, t8, t10, t11, t12, t16, t18, t19, t20, t23, t25;
  double t26, t27, t29, t30, t31, t32, t33, t35, t36, t37, t38, t39, t41;
  double t42, t43, t45, t46, t47, t48, t53, t54, t59, t61, t62, t63, t64;
  double t65, t66, t67, t68, t69, t70, t71, t72, t73, t74, t75, t76, t77;
  double t78, t79, t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91;
  double t92, t96, t97, t98, t99, t100, t101, t102, t103, t104, t105, t107;
  double t108, t109, t110, t111, t112, t113, t140, t141, t142;

  t1 = xi*xi;
  t5 = 35.0/2.0*t1*xi-15.0/2.0*xi;
  t6 = eta*eta;
  t7 = 15.0/2.0*t6;
  t8 = t7-3.0/2.0;
  t10 = t5*t8/2.0;
  t11 = 15.0/2.0*t1;
  t12 = t11-3.0/2.0;
  t16 = 35.0/2.0*t6*eta-15.0/2.0*eta;
  t18 = t12*t16/2.0;
  t19 = zeta*zeta;
  t20 = t19*t19;
  t23 = 3.0/8.0+35.0/8.0*t20-15.0/4.0*t19;
  t25 = 3.0/4.0*eta*t23;
  t26 = 3.0/2.0*t19;
  t27 = -1.0/2.0+t26;
  t29 = t16*t27/4.0;
  t30 = eta*t27;
  t31 = 3.0/4.0*t30;
  t32 = t25-t29-t31;
  t33 = t5*eta;
  t35 = 3.0/4.0*t33*zeta;
  t36 = xi*eta;
  t37 = t36*zeta;
  t38 = 9.0/4.0*t37;
  t39 = xi*t16;
  t41 = 3.0/4.0*t39*zeta;
  t42 = -t35-t38+t41;
  t43 = t35-t38-t41;
  t45 = t5*t27/4.0;
  t46 = xi*t8;
  t47 = 3.0/2.0*t46;
  t48 = t1*t1;
  t53 = (315.0/8.0*t48-105.0/4.0*t1+15.0/8.0)*t8/4.0;
  t54 = t6*t6;
  t59 = t12*(315.0/8.0*t54-105.0/4.0*t6+15.0/8.0)/4.0;
  t61 = 3.0/4.0*xi*t23;
  t62 = 3.0/2.0*xi;
  t63 = xi*t27;
  t64 = 3.0/4.0*t63;
  t65 = t12*t8;
  t66 = t65/4.0;
  t67 = 15.0/4.0*t1;
  t68 = t45-t47-t53+t59-t61+t62-t64+t10+t66-t67+3.0/4.0;
  t69 = -t45+t61-t64;
  t70 = 3.0/2.0*eta;
  t71 = t12*eta;
  t72 = 3.0/2.0*t71;
  t73 = 15.0/4.0*t6;
  t74 = t70+t18-t72+t53-t59-t25+t66+t29-t31-t73+3.0/4.0;
  t75 = t45-t47+t53-t59-t61+t62-t64+t10-t66+t67-3.0/4.0;
  t76 = -t70-t18+t72+t53-t59+t25+t66-t29+t31-t73+3.0/4.0;
  t77 = 9.0/4.0*t36;
  t78 = 3.0/4.0*t33;
  t79 = 3.0/4.0*t39;
  t81 = t8*zeta;
  t82 = t81/6.0;
  t83 = t12*zeta;
  t84 = t83/6.0;
  t85 = t19*zeta;
  t86 = 5.0/6.0*t85;
  t87 = zeta/3.0;
  t88 = 3.0/4.0*t19;
  t89 = t12*t27;
  t90 = t89/2.0;
  t91 = t8*t27;
  t92 = t91/2.0;
  t96 = 5.0/2.0*t85-3.0/2.0*zeta;
  t97 = eta*t96;
  t98 = 3.0/2.0*t97;
  t99 = t71*zeta;
  t100 = 3.0/2.0*t99;
  t101 = t81/3.0;
  t102 = eta*zeta;
  t103 = 3.0/2.0*t102;
  t104 = 5.0/12.0*t85;
  t105 = 5.0/12.0*zeta;
  t107 = t83/3.0;
  t108 = t46*zeta;
  t109 = 3.0/2.0*t108;
  t110 = xi*t96;
  t111 = 3.0/2.0*t110;
  t112 = xi*zeta;
  t113 = 3.0/2.0*t112;
  t140 = 9.0/2.0*t36;
  t141 = 3.0/2.0*t33;
  t142 = 3.0/2.0*t39;

  values[0] = 0.0;
  values[1] = t10;
  values[2] = -t18;
  values[3] = -t10;
  values[4] = t18;
  values[5] = 0.0;
  values[6] = t32;
  values[7] = t42;
  values[8] = t43;
  values[9] = t42;
  values[10] = t68;
  values[11] = t69;
  values[12] = t69;
  values[13] = t74;
  values[14] = t75;
  values[15] = t76;
  values[16] = t43;
  values[17] = t32;
  values[18] = 0.0;
  values[19] = 0.0;
  values[20] = 0.0;
  values[21] = 0.0;
  values[22] = t18-t72+t77+t78-t79;
  values[23] = 0.0;
  values[24] = t82+t84-t86+t87-1.0/4.0+t88-t90-t92;
  values[25] = -t98-t100-t101+t84+t103+t104-t105;
  values[26] = -t82+t107-t104+t105-t109-t111+t113;
  values[27] = t98+t100-t101+t84-t103+t104-t105;
  values[28] = t82-t107+t104-t105-t109-t111+t113;
  values[29] = -t82-t84+t86-t87-1.0/4.0+t88-t90-t92;
  values[30] = 0.0;
  values[31] = t77-t47-t78+t79+t10;
  values[32] = -t18+t72+t77+t78-t79;
  values[33] = t77+t47-t78+t79-t10;
  values[34] = 0.0;
  values[35] = 0.0;
  values[36] = 0.0;
  values[37] = 0.0;
  values[38] = 0.0;
  values[39] = 0.0;
  values[40] = -t53+t59+t10-t66;
  values[41] = 0.0;
  values[42] = -t45+t61+t64-t111;
  values[43] = -t25+t29+t31-t92;
  values[44] = t45-t61+t64+t90;
  values[45] = t25-t29-t31-t92;
  values[46] = -t100+t35+t38-t41;
  values[47] = t98+t25-t29+t31;
  values[48] = -t98+t25-t29+t31;
  values[49] = -t35+t38-t109+t41;
  values[50] = t100+t35+t38-t41;
  values[51] = -t35+t38+t109+t41;
  values[52] = t45-t61+t64-t90;
  values[53] = -t45+t61+t64+t111;
  values[54] = 0.0;
  values[55] = t18+t53-t59-t66;
  values[56] = t53-t59+t10+t66;
  values[57] = -t18+t53-t59-t66;
  values[58] = 0.0;
  values[59] = 0.0;
  values[60] = 0.0;
  values[61] = -3.0*eta+3.0*t71+3.0*t30;
  values[62] = 3.0*t46-3.0*xi+3.0*t63;
  values[63] = 9.0*t37;
  values[64] = -t140+t141-t142;
  values[65] = 9.0/2.0-t26+t65+t89-t11-t7+t91;
  values[66] = 3.0*t97+3.0*t99-3.0*t102;
  values[67] = -t140-t141+t142;
  values[68] = 3.0*t108+3.0*t110-3.0*t112;
  values[69] = 0.0;
}

static void N_H_Q4_3D_DeriveXiZeta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t5, t6, t7, t8, t10, t11, t12, t16, t18, t19, t20, t21, t22;
  double t23, t24, t26, t27, t28, t29, t34, t35, t38, t40, t41, t46, t47;
  double t48, t49, t50, t52, t53, t54, t56, t57, t58, t59, t60, t61, t62;
  double t65, t66, t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78;
  double t79, t80, t81, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93;
  double t94, t97, t98, t99, t101, t102, t103, t104, t105, t106, t107, t108;
  double t110, t111, t112, t113, t114, t115, t141, t142, t143;

  t1 = xi*xi;
  t5 = 35.0/2.0*t1*xi-15.0/2.0*xi;
  t6 = zeta*zeta;
  t7 = 15.0/2.0*t6;
  t8 = t7-3.0/2.0;
  t10 = t5*t8/2.0;
  t11 = 15.0/2.0*t1;
  t12 = t11-3.0/2.0;
  t16 = 35.0/2.0*t6*zeta-15.0/2.0*zeta;
  t18 = t12*t16/2.0;
  t19 = 15.0/4.0*t6;
  t20 = t12*zeta;
  t21 = 3.0/2.0*t20;
  t22 = eta*eta;
  t23 = 3.0/2.0*t22;
  t24 = -1.0/2.0+t23;
  t26 = t24*t16/4.0;
  t27 = t12*t8;
  t28 = t27/4.0;
  t29 = t6*t6;
  t34 = t12*(315.0/8.0*t29-105.0/4.0*t6+15.0/8.0)/4.0;
  t35 = t22*t22;
  t38 = 3.0/8.0+35.0/8.0*t35-15.0/4.0*t22;
  t40 = 3.0/4.0*t38*zeta;
  t41 = t1*t1;
  t46 = (315.0/8.0*t41-105.0/4.0*t1+15.0/8.0)*t8/4.0;
  t47 = t24*zeta;
  t48 = 3.0/4.0*t47;
  t49 = 3.0/2.0*zeta;
  t50 = -t19+3.0/4.0+t18-t21+t26+t28-t34-t40+t46-t48+t49;
  t52 = t5*t24/4.0;
  t53 = xi*t24;
  t54 = 3.0/4.0*t53;
  t56 = 3.0/4.0*xi*t38;
  t57 = -t52-t54+t56;
  t58 = 3.0/2.0*xi;
  t59 = xi*t8;
  t60 = 3.0/2.0*t59;
  t61 = 15.0/4.0*t1;
  t62 = t58+t52+t10-t54-t60-t28-t34+t46+t61-3.0/4.0-t56;
  t65 = 3.0/4.0*t5*eta*zeta;
  t66 = xi*eta;
  t68 = 3.0/4.0*t66*t16;
  t69 = t66*zeta;
  t70 = 9.0/4.0*t69;
  t71 = t65-t68-t70;
  t72 = -t65+t68-t70;
  t73 = -t26+t40-t48;
  t74 = t58+t52+t10-t54-t60+t28+t34-t46-t61+3.0/4.0-t56;
  t75 = t19-3.0/4.0+t18-t21+t26-t28+t34-t40-t46-t48+t49;
  t76 = xi*zeta;
  t77 = 9.0/4.0*t76;
  t78 = xi*t16;
  t79 = 3.0/4.0*t78;
  t80 = t5*zeta;
  t81 = 3.0/4.0*t80;
  t84 = t22*eta;
  t85 = 5.0/12.0*t84;
  t86 = 5.0/12.0*eta;
  t87 = t12*eta;
  t88 = t87/6.0;
  t89 = eta*t8;
  t90 = t89/3.0;
  t91 = eta*zeta;
  t92 = 3.0/2.0*t91;
  t93 = t87*zeta;
  t94 = 3.0/2.0*t93;
  t97 = 5.0/2.0*t84-3.0/2.0*eta;
  t98 = t97*zeta;
  t99 = 3.0/2.0*t98;
  t101 = t24*t8;
  t102 = t101/2.0;
  t103 = t12*t24;
  t104 = t103/2.0;
  t105 = 5.0/6.0*t84;
  t106 = eta/3.0;
  t107 = 3.0/4.0*t22;
  t108 = t89/6.0;
  t110 = t87/3.0;
  t111 = xi*t97;
  t112 = 3.0/2.0*t111;
  t113 = t66*t8;
  t114 = 3.0/2.0*t113;
  t115 = 3.0/2.0*t66;
  t141 = 9.0/2.0*t76;
  t142 = 3.0/2.0*t78;
  t143 = 3.0/2.0*t80;

  values[0] = t10;
  values[1] = 0.0;
  values[2] = -t18;
  values[3] = 0.0;
  values[4] = t18;
  values[5] = -t10;
  values[6] = t50;
  values[7] = t57;
  values[8] = t62;
  values[9] = t57;
  values[10] = t71;
  values[11] = t72;
  values[12] = t72;
  values[13] = t73;
  values[14] = t71;
  values[15] = -t73;
  values[16] = t74;
  values[17] = t75;
  values[18] = t10+t77-t60+t79-t81;
  values[19] = 0.0;
  values[20] = -t18+t21+t77-t79+t81;
  values[21] = 0.0;
  values[22] = 0.0;
  values[23] = 0.0;
  values[24] = t85-t86+t88-t90+t92-t94-t99;
  values[25] = -t102-t104-t105+t106+t88-1.0/4.0+t107+t108;
  values[26] = -t85+t86+t110-t108-t112-t114+t115;
  values[27] = t102+t104-t105+t106+t88+1.0/4.0-t107+t108;
  values[28] = t85-t86-t110+t108-t112-t114+t115;
  values[29] = -t85+t86-t88+t90+t92-t94-t99;
  values[30] = 0.0;
  values[31] = 0.0;
  values[32] = 0.0;
  values[33] = 0.0;
  values[34] = t18-t21+t77-t79+t81;
  values[35] = -t10+t77+t60+t79-t81;
  values[36] = t18-t28-t34+t46;
  values[37] = 0.0;
  values[38] = t10+t28-t34+t46;
  values[39] = 0.0;
  values[40] = 0.0;
  values[41] = 0.0;
  values[42] = -t65+t68+t70-t114;
  values[43] = -t26+t40+t48-t99;
  values[44] = t65-t68+t70+t94;
  values[45] = t26-t40-t48-t99;
  values[46] = -t104+t52+t54-t56;
  values[47] = t102+t26-t40+t48;
  values[48] = -t102+t26-t40+t48;
  values[49] = -t52+t54-t112+t56;
  values[50] = t104+t52+t54-t56;
  values[51] = -t52+t54+t112+t56;
  values[52] = t65-t68+t70-t94;
  values[53] = -t65+t68+t70+t114;
  values[54] = 0.0;
  values[55] = 0.0;
  values[56] = 0.0;
  values[57] = 0.0;
  values[58] = t10-t28+t34-t46;
  values[59] = t18+t28+t34-t46;
  values[60] = 0.0;
  values[61] = 3.0*t20+3.0*t47-3.0*zeta;
  values[62] = 9.0*t69;
  values[63] = -3.0*xi+3.0*t53+3.0*t59;
  values[64] = -t141-t142+t143;
  values[65] = -3.0*t91+3.0*t93+3.0*t98;
  values[66] = t101+t103-t7+9.0/2.0-t23+t27-t11;
  values[67] = 0.0;
  values[68] = 3.0*t111+3.0*t113-3.0*t66;
  values[69] = -t141+t142-t143;
}

static void N_H_Q4_3D_DeriveEtaEta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t3, t4, t5, t8, t10, t11, t12, t13, t16, t18, t19, t20;
  double t23, t25, t27, t30, t32, t35, t38, t40, t41, t42, t43, t45, t47;
  double t48, t49, t50, t51, t58, t62, t64, t65, t66, t67, t69, t70, t71;
  double t73, t75, t76, t83, t85, t86, t87, t89, t90, t93, t94, t95, t96;
  double t100, t101, t102, t103, t106, t107, t108, t109, t111, t112, t114;
  double t115, t116, t117, t119, t120, t121, t122, t123, t124, t125, t127;
  double t128, t134, t164, t165, t171, t172;

  t1 = eta*eta;
  t2 = 105.0/2.0*t1;
  t3 = t2-15.0/2.0;
  t4 = zeta*zeta;
  t5 = t4*zeta;
  t8 = 5.0/2.0*t5-3.0/2.0*zeta;
  t10 = t3*t8/2.0;
  t11 = 15.0/2.0*eta;
  t12 = 105.0/4.0*t1;
  t13 = t4*t4;
  t16 = 3.0/8.0+35.0/8.0*t13-15.0/4.0*t4;
  t18 = 15.0/2.0*eta*t16;
  t19 = xi*xi;
  t20 = t19*t19;
  t23 = 3.0/8.0+35.0/8.0*t20-15.0/4.0*t19;
  t25 = 15.0/2.0*eta*t23;
  t27 = t19*xi;
  t30 = 5.0/2.0*t27-3.0/2.0*xi;
  t32 = t30*t3/2.0;
  t35 = 3.0/4.0*xi*t16;
  t38 = -1.0/2.0+3.0/2.0*t4;
  t40 = xi*t3*t38/4.0;
  t41 = xi*t38;
  t42 = 3.0/4.0*t41;
  t43 = t35-t40-t42;
  t45 = 3.0/4.0*t23*zeta;
  t47 = -1.0/2.0+3.0/2.0*t19;
  t48 = t47*zeta;
  t49 = 3.0/4.0*t48;
  t50 = 15.0/4.0*t5;
  t51 = 15.0/4.0*zeta;
  t58 = 15.0/4.0*eta*(63.0/8.0*t13*zeta-35.0/4.0*t5+15.0/8.0*zeta);
  t62 = 315.0/2.0*t1*eta-105.0/2.0*eta;
  t64 = t62*t8/4.0;
  t65 = eta*t8;
  t66 = 15.0/4.0*t65;
  t67 = t47*t3;
  t69 = t67*zeta/4.0;
  t70 = eta*zeta;
  t71 = 15.0/2.0*t70;
  t73 = t45-t49-t69;
  t75 = t47*eta;
  t76 = 15.0/2.0*t75;
  t83 = 15.0/4.0*(63.0/8.0*t20*xi-35.0/4.0*t27+15.0/8.0*xi)*eta;
  t85 = t30*t62/4.0;
  t86 = t30*eta;
  t87 = 15.0/4.0*t86;
  t89 = eta*t38;
  t90 = 15.0/2.0*t89;
  t93 = 15.0/4.0*xi;
  t94 = 15.0/4.0*t27;
  t95 = xi*eta;
  t96 = 15.0/2.0*t95;
  t100 = 63.0/16.0*t4;
  t101 = t3*t38;
  t102 = t101/4.0;
  t103 = 105.0/32.0*t13;
  t106 = 9.0/4.0*xi;
  t107 = 27.0/16.0*t19;
  t108 = 105.0/32.0*t20;
  t109 = t67/4.0;
  t111 = 27.0/16.0*t4;
  t112 = 9.0/4.0*zeta;
  t114 = t95*zeta;
  t115 = 5.0/2.0*t114;
  t116 = t95*t38;
  t117 = 15.0/2.0*t116;
  t119 = xi*t8;
  t120 = 3.0/2.0*t119;
  t121 = t30*zeta;
  t122 = 3.0/2.0*t121;
  t123 = 5.0*t114;
  t124 = xi*zeta;
  t125 = 3.0/2.0*t124;
  t127 = t75*zeta;
  t128 = 15.0/2.0*t127;
  t134 = 63.0/16.0*t19;
  t164 = 105.0/16.0*t20;
  t165 = t67/2.0;
  t171 = t101/2.0;
  t172 = 105.0/16.0*t13;

  values[0] = t10;
  values[1] = -t11-15.0/4.0+t12+t18+t25;
  values[2] = -t32;
  values[3] = t11-15.0/4.0+t12-t18-t25;
  values[4] = t32;
  values[5] = -t10;
  values[6] = t43;
  values[7] = t10-t45-t49-t50+t51+t58-t64+t66+t69-t71;
  values[8] = t73;
  values[9] = t10-t45-t49-t50+t51-t58+t64-t66+t69+t71;
  values[10] = -t76-t83+t85+t25+t87;
  values[11] = t18+t58-t90-t64-t66;
  values[12] = t18-t58-t90+t64+t66;
  values[13] = t93+t32-t94+t83-t85-t35+t87+t40-t42-t96;
  values[14] = -t76+t83-t85+t25-t87;
  values[15] = -t93-t32+t94+t83-t85+t35+t87-t40+t42-t96;
  values[16] = t73;
  values[17] = t43;
  values[18] = 0.0;
  values[19] = -21.0/32.0+t100+t18-t90+t102-t103;
  values[20] = 0.0;
  values[21] = -21.0/32.0+t100-t18+t90+t102-t103;
  values[22] = t32-t94+t106-3.0/32.0-t107+t108-t109;
  values[23] = -t10-3.0/32.0-t111+t50-t112-t102+t103;
  values[24] = t115-t117;
  values[25] = -t120-t122-t123+t125;
  values[26] = -t115-t128;
  values[27] = t120+t122-t123-t125;
  values[28] = t115-t128;
  values[29] = -t115-t117;
  values[30] = t10-3.0/32.0-t111-t50+t112-t102+t103;
  values[31] = -21.0/32.0+t134-t76-t108+t109+t25;
  values[32] = -t32+t94-t106-3.0/32.0-t107+t108-t109;
  values[33] = -21.0/32.0+t134+t76-t108+t109-t25;
  values[34] = 0.0;
  values[35] = 0.0;
  values[36] = 0.0;
  values[37] = t10+t58-t64-t66;
  values[38] = 0.0;
  values[39] = t10-t58+t64+t66;
  values[40] = -t83+t85+t25-t87;
  values[41] = t18+t58-t64+t66;
  values[42] = 0.0;
  values[43] = -t35+t40+t42-t117;
  values[44] = 0.0;
  values[45] = t35-t40-t42-t117;
  values[46] = -t122+t45+t49-t69;
  values[47] = t120+t35-t40+t42;
  values[48] = -t120+t35-t40+t42;
  values[49] = -t45+t49-t128+t69;
  values[50] = t122+t45+t49-t69;
  values[51] = -t45+t49+t128+t69;
  values[52] = 0.0;
  values[53] = 0.0;
  values[54] = t18-t58+t64-t66;
  values[55] = t32+t83-t85-t87;
  values[56] = t83-t85+t25+t87;
  values[57] = -t32+t83-t85-t87;
  values[58] = 0.0;
  values[59] = 0.0;
  values[60] = -t3;
  values[61] = -15.0/2.0*xi+15.0/2.0*t27+3.0*t41;
  values[62] = -15.0*eta+15.0*t75+15.0*t89;
  values[63] = 3.0*t48+15.0/2.0*t5-15.0/2.0*zeta;
  values[64] = 21.0/16.0-63.0/8.0*t19+t164-t165;
  values[65] = 15.0*t86-15.0*t95+15.0*t116;
  values[66] = 3.0*t119+3.0*t121-3.0*t124;
  values[67] = 87.0/8.0+27.0/8.0*t19-t2+27.0/8.0*t4-t164+t165+t171-t172;
  values[68] = 15.0*t127+15.0*t65-15.0*t70;
  values[69] = 21.0/16.0-63.0/8.0*t4-t171+t172;
}

static void N_H_Q4_3D_DeriveEtaZeta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t5, t6, t7, t8, t10, t11, t12, t16, t18, t19, t21, t24, t25;
  double t26, t27, t28, t29, t32, t34, t35, t36, t37, t38, t39, t40, t41;
  double t46, t47, t52, t53, t54, t55, t57, t58, t59, t60, t61, t63, t65;
  double t66, t67, t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78;
  double t79, t80, t81, t85, t86, t87, t88, t89, t90, t91, t92, t93, t96;
  double t97, t98, t99, t100, t102, t103, t104, t105, t106, t107, t108, t110;
  double t111, t112, t113, t114, t115, t116, t143, t144, t145;

  t1 = eta*eta;
  t5 = 35.0/2.0*t1*eta-15.0/2.0*eta;
  t6 = zeta*zeta;
  t7 = 15.0/2.0*t6;
  t8 = t7-3.0/2.0;
  t10 = t5*t8/2.0;
  t11 = 15.0/2.0*t1;
  t12 = t11-3.0/2.0;
  t16 = 35.0/2.0*t6*zeta-15.0/2.0*zeta;
  t18 = t12*t16/2.0;
  t19 = xi*eta;
  t21 = 3.0/4.0*t19*t16;
  t24 = 3.0/4.0*xi*t5*zeta;
  t25 = t19*zeta;
  t26 = 9.0/4.0*t25;
  t27 = t21-t24-t26;
  t28 = xi*xi;
  t29 = t28*t28;
  t32 = 3.0/8.0+35.0/8.0*t29-15.0/4.0*t28;
  t34 = 3.0/4.0*t32*eta;
  t35 = 3.0/2.0*t28;
  t36 = -1.0/2.0+t35;
  t37 = t36*eta;
  t38 = 3.0/4.0*t37;
  t39 = eta*t8;
  t40 = 3.0/2.0*t39;
  t41 = t6*t6;
  t46 = t12*(315.0/8.0*t41-105.0/4.0*t6+15.0/8.0)/4.0;
  t47 = t1*t1;
  t52 = (315.0/8.0*t47-105.0/4.0*t1+15.0/8.0)*t8/4.0;
  t53 = 3.0/2.0*eta;
  t54 = t12*t8;
  t55 = t54/4.0;
  t57 = t36*t5/4.0;
  t58 = 15.0/4.0*t1;
  t59 = t10-t34-t38-t40+t46-t52+t53+t55+t57-t58+3.0/4.0;
  t60 = t34-t38-t57;
  t61 = t10-t34-t38-t40-t46+t52+t53-t55+t57+t58-3.0/4.0;
  t63 = 3.0/4.0*t32*zeta;
  t65 = t36*t16/4.0;
  t66 = t36*zeta;
  t67 = 3.0/4.0*t66;
  t68 = t63-t65-t67;
  t69 = 15.0/4.0*t6;
  t70 = t12*zeta;
  t71 = 3.0/2.0*t70;
  t72 = 3.0/2.0*zeta;
  t73 = -t63+t69-3.0/4.0+t65+t18+t46-t71-t67-t52+t72-t55;
  t74 = -t63-t69+3.0/4.0+t65+t18-t46-t71-t67+t52+t72+t55;
  t75 = -t21+t24-t26;
  t76 = eta*zeta;
  t77 = 9.0/4.0*t76;
  t78 = t5*zeta;
  t79 = 3.0/4.0*t78;
  t80 = eta*t16;
  t81 = 3.0/4.0*t80;
  t85 = xi*t12;
  t86 = t85/6.0;
  t87 = t28*xi;
  t88 = 5.0/12.0*t87;
  t89 = 5.0/12.0*xi;
  t90 = xi*t8;
  t91 = t90/3.0;
  t92 = xi*zeta;
  t93 = 3.0/2.0*t92;
  t96 = 5.0/2.0*t87-3.0/2.0*xi;
  t97 = t96*zeta;
  t98 = 3.0/2.0*t97;
  t99 = t85*zeta;
  t100 = 3.0/2.0*t99;
  t102 = t19*t8;
  t103 = 3.0/2.0*t102;
  t104 = t96*eta;
  t105 = 3.0/2.0*t104;
  t106 = t85/3.0;
  t107 = 3.0/2.0*t19;
  t108 = t90/6.0;
  t110 = 5.0/6.0*t87;
  t111 = xi/3.0;
  t112 = t36*t12;
  t113 = t112/2.0;
  t114 = t36*t8;
  t115 = t114/2.0;
  t116 = 3.0/4.0*t28;
  t143 = 9.0/2.0*t76;
  t144 = 3.0/2.0*t78;
  t145 = 3.0/2.0*t80;

  values[0] = t10;
  values[1] = t18;
  values[2] = 0.0;
  values[3] = -t18;
  values[4] = 0.0;
  values[5] = -t10;
  values[6] = t27;
  values[7] = t59;
  values[8] = t60;
  values[9] = t61;
  values[10] = t68;
  values[11] = t73;
  values[12] = t74;
  values[13] = t75;
  values[14] = t68;
  values[15] = -t75;
  values[16] = t60;
  values[17] = t27;
  values[18] = 0.0;
  values[19] = t77+t18-t71+t79-t81;
  values[20] = 0.0;
  values[21] = t77-t18+t71+t79-t81;
  values[22] = 0.0;
  values[23] = -t10+t77+t40-t79+t81;
  values[24] = t86+t88-t89-t91+t93-t98-t100;
  values[25] = -t103-t105-t106+t88-t89+t107+t108;
  values[26] = -t86+t110-t111-t108-t113-t115-1.0/4.0+t116;
  values[27] = t103+t105-t106+t88-t89-t107+t108;
  values[28] = t86-t110+t111+t108-t113-t115-1.0/4.0+t116;
  values[29] = -t86-t88+t89+t91+t93-t98-t100;
  values[30] = t10+t77-t40-t79+t81;
  values[31] = 0.0;
  values[32] = 0.0;
  values[33] = 0.0;
  values[34] = 0.0;
  values[35] = 0.0;
  values[36] = 0.0;
  values[37] = t10+t46-t52-t55;
  values[38] = 0.0;
  values[39] = t10-t46+t52+t55;
  values[40] = 0.0;
  values[41] = t18+t46-t52+t55;
  values[42] = -t63+t65+t67-t115;
  values[43] = -t21+t24+t26-t100;
  values[44] = t63-t65+t67+t98;
  values[45] = t21-t24-t26-t100;
  values[46] = -t105+t34+t38-t57;
  values[47] = t103+t21-t24+t26;
  values[48] = -t103+t21-t24+t26;
  values[49] = -t34+t38-t113+t57;
  values[50] = t105+t34+t38-t57;
  values[51] = -t34+t38+t113+t57;
  values[52] = t63-t65+t67-t98;
  values[53] = -t63+t65+t67+t115;
  values[54] = t18-t46+t52-t55;
  values[55] = 0.0;
  values[56] = 0.0;
  values[57] = 0.0;
  values[58] = 0.0;
  values[59] = 0.0;
  values[60] = 0.0;
  values[61] = 9.0*t25;
  values[62] = 3.0*t70+3.0*t66-3.0*zeta;
  values[63] = 3.0*t37+3.0*t39-3.0*eta;
  values[64] = 0.0;
  values[65] = -3.0*t92+3.0*t97+3.0*t99;
  values[66] = 3.0*t102+3.0*t104-3.0*t19;
  values[67] = -t143+t144-t145;
  values[68] = -t7+9.0/2.0+t112+t114-t35+t54-t11;
  values[69] = -t143-t144+t145;
}

static void N_H_Q4_3D_DeriveZetaZeta(double xi, double eta, double zeta,
                             double *values)
{
  double t1, t2, t5, t7, t8, t9, t12, t14, t15, t16, t17, t19, t22, t23;
  double t24, t26, t27, t30, t32, t34, t35, t36, t37, t39, t40, t42, t43;
  double t44, t48, t50, t52, t59, t60, t62, t63, t65, t72, t73, t74, t77;
  double t78, t79, t83, t84, t86, t87, t88, t89, t90, t91, t92, t95, t98;
  double t99, t100, t101, t103, t104, t105, t106, t107, t109, t110, t113;
  double t115, t116, t117, t118, t119, t120, t121, t122, t124, t125, t126;
  double t128, t129, t163, t164, t169, t170;

  t1 = eta*eta;
  t2 = t1*t1;
  t5 = 3.0/8.0+35.0/8.0*t2-15.0/4.0*t1;
  t7 = 15.0/2.0*t5*zeta;
  t8 = xi*xi;
  t9 = t8*t8;
  t12 = 3.0/8.0+35.0/8.0*t9-15.0/4.0*t8;
  t14 = 15.0/2.0*t12*zeta;
  t15 = 15.0/2.0*zeta;
  t16 = zeta*zeta;
  t17 = 105.0/4.0*t16;
  t19 = t1*eta;
  t22 = 5.0/2.0*t19-3.0/2.0*eta;
  t23 = 105.0/2.0*t16;
  t24 = t23-15.0/2.0;
  t26 = t22*t24/2.0;
  t27 = xi*t8;
  t30 = 5.0/2.0*t27-3.0/2.0*xi;
  t32 = t30*t24/2.0;
  t34 = xi*zeta;
  t35 = 15.0/2.0*t34;
  t36 = 15.0/4.0*t27;
  t37 = 15.0/4.0*xi;
  t39 = -1.0/2.0+3.0/2.0*t1;
  t40 = xi*t39;
  t42 = t40*t24/4.0;
  t43 = t30*zeta;
  t44 = 15.0/4.0*t43;
  t48 = 315.0/2.0*t16*zeta-105.0/2.0*zeta;
  t50 = t30*t48/4.0;
  t52 = 3.0/4.0*xi*t5;
  t59 = 15.0/4.0*(63.0/8.0*t9*xi-35.0/4.0*t27+15.0/8.0*xi)*zeta;
  t60 = 3.0/4.0*t40;
  t62 = t39*zeta;
  t63 = 15.0/2.0*t62;
  t65 = t22*t48/4.0;
  t72 = 15.0/4.0*(63.0/8.0*t2*eta-35.0/4.0*t19+15.0/8.0*eta)*zeta;
  t73 = t22*zeta;
  t74 = 15.0/4.0*t73;
  t77 = -1.0/2.0+3.0/2.0*t8;
  t78 = t77*zeta;
  t79 = 15.0/2.0*t78;
  t83 = 3.0/4.0*t12*eta;
  t84 = t77*eta;
  t86 = t84*t24/4.0;
  t87 = 3.0/4.0*t84;
  t88 = t83-t86-t87;
  t89 = eta*zeta;
  t90 = 15.0/2.0*t89;
  t91 = 15.0/4.0*t19;
  t92 = 15.0/4.0*eta;
  t95 = -t42+t52-t60;
  t98 = 63.0/16.0*t8;
  t99 = t77*t24;
  t100 = t99/4.0;
  t101 = 105.0/32.0*t9;
  t103 = 27.0/16.0*t1;
  t104 = 9.0/4.0*eta;
  t105 = 105.0/32.0*t2;
  t106 = t39*t24;
  t107 = t106/4.0;
  t109 = 9.0/4.0*xi;
  t110 = 27.0/16.0*t8;
  t113 = 63.0/16.0*t1;
  t115 = xi*eta;
  t116 = t115*zeta;
  t117 = 5.0*t116;
  t118 = 3.0/2.0*t115;
  t119 = t30*eta;
  t120 = 3.0/2.0*t119;
  t121 = xi*t22;
  t122 = 3.0/2.0*t121;
  t124 = t40*zeta;
  t125 = 15.0/2.0*t124;
  t126 = 5.0/2.0*t116;
  t128 = t84*zeta;
  t129 = 15.0/2.0*t128;
  t163 = t99/2.0;
  t164 = 105.0/16.0*t9;
  t169 = 105.0/16.0*t2;
  t170 = t106/2.0;

  values[0] = t7+t14-t15+t17-15.0/4.0;
  values[1] = t26;
  values[2] = -t32;
  values[3] = -t26;
  values[4] = t32;
  values[5] = -t7-t14+t15+t17-15.0/4.0;
  values[6] = -t35+t32-t36+t37+t42+t44-t50-t52+t59-t60;
  values[7] = t7-t63+t65-t72+t74;
  values[8] = t14-t79-t44-t50+t59;
  values[9] = t7-t63-t65+t72-t74;
  values[10] = t88;
  values[11] = -t83+t90+t86+t26+t65-t91+t92-t87-t72-t74;
  values[12] = -t83-t90+t86+t26-t65-t91+t92-t87+t72+t74;
  values[13] = t95;
  values[14] = t88;
  values[15] = -t95;
  values[16] = t14-t79+t44+t50-t59;
  values[17] = t35+t32-t36+t37+t42-t44+t50-t52-t59-t60;
  values[18] = t14-21.0/32.0+t98-t79+t100-t101;
  values[19] = -3.0/32.0-t103+t26-t91+t104+t105-t107;
  values[20] = -t32+t36-t109-3.0/32.0-t110-t100+t101;
  values[21] = -3.0/32.0-t103-t26+t91-t104+t105-t107;
  values[22] = 0.0;
  values[23] = -t7-21.0/32.0+t113+t63-t105+t107;
  values[24] = -t117+t118-t120-t122;
  values[25] = -t125+t126;
  values[26] = -t126-t129;
  values[27] = t125+t126;
  values[28] = t126-t129;
  values[29] = t117+t118-t120-t122;
  values[30] = t7-21.0/32.0+t113-t63-t105+t107;
  values[31] = 0.0;
  values[32] = 0.0;
  values[33] = 0.0;
  values[34] = t32-t36+t109-3.0/32.0-t110-t100+t101;
  values[35] = -t14-21.0/32.0+t98+t79+t100-t101;
  values[36] = t32-t44-t50+t59;
  values[37] = t7+t65-t72-t74;
  values[38] = t14+t44-t50+t59;
  values[39] = t7-t65+t72+t74;
  values[40] = 0.0;
  values[41] = t26+t65-t72+t74;
  values[42] = -t83+t86+t87-t129;
  values[43] = -t42+t52+t60-t122;
  values[44] = t83-t86+t87+t120;
  values[45] = t42-t52-t60-t122;
  values[46] = 0.0;
  values[47] = t125+t42-t52+t60;
  values[48] = -t125+t42-t52+t60;
  values[49] = 0.0;
  values[50] = 0.0;
  values[51] = 0.0;
  values[52] = t83-t86+t87-t120;
  values[53] = -t83+t86+t87+t129;
  values[54] = t26-t65+t72-t74;
  values[55] = 0.0;
  values[56] = 0.0;
  values[57] = 0.0;
  values[58] = t14-t44+t50-t59;
  values[59] = t32+t44+t50-t59;
  values[60] = -t24;
  values[61] = 15.0/2.0*t27-15.0/2.0*xi+3.0*t40;
  values[62] = 15.0/2.0*t19-15.0/2.0*eta+3.0*t84;
  values[63] = -15.0*zeta+15.0*t62+15.0*t78;
  values[64] = 21.0/16.0-63.0/8.0*t8-t163+t164;
  values[65] = -3.0*t115+3.0*t119+3.0*t121;
  values[66] = 15.0*t124-15.0*t34+15.0*t43;
  values[67] = 21.0/16.0-63.0/8.0*t1+t169-t170;
  values[68] = -15.0*t89+15.0*t128+15.0*t73;
  values[69] = 87.0/8.0+27.0/8.0*t1+27.0/8.0*t8-t23-t169+t170+t163-t164;
}

static int N_H_Q4_3D_ChangeU0[4] = {  6, 24, 36, 48 };
static int N_H_Q4_3D_ChangeU1[4] = {  7, 25, 37, 49 };
static int N_H_Q4_3D_ChangeU2[4] = {  8, 26, 38, 50 };
static int N_H_Q4_3D_ChangeU3[4] = {  9, 27, 39, 51 };
static int N_H_Q4_3D_ChangeU4[4] = { 10, 28, 40, 52 };
static int N_H_Q4_3D_ChangeU5[4] = { 11, 29, 41, 53 };

static int N_H_Q4_3D_ChangeV0[4] = { 12, 24, 42, 54 };
static int N_H_Q4_3D_ChangeV1[4] = { 13, 25, 43, 55 };
static int N_H_Q4_3D_ChangeV2[4] = { 14, 26, 44, 56 };
static int N_H_Q4_3D_ChangeV3[4] = { 15, 27, 45, 57 };
static int N_H_Q4_3D_ChangeV4[4] = { 16, 28, 46, 58 };
static int N_H_Q4_3D_ChangeV5[4] = { 17, 29, 47, 59 };

static int *N_H_Q4_3D_ChangeU[6] = { N_H_Q4_3D_ChangeU0, N_H_Q4_3D_ChangeU1,
                                     N_H_Q4_3D_ChangeU2, N_H_Q4_3D_ChangeU3,
                                     N_H_Q4_3D_ChangeU4, N_H_Q4_3D_ChangeU5 };

static int *N_H_Q4_3D_ChangeV[6] = { N_H_Q4_3D_ChangeV0, N_H_Q4_3D_ChangeV1,
                                     N_H_Q4_3D_ChangeV2, N_H_Q4_3D_ChangeV3,
                                     N_H_Q4_3D_ChangeV4, N_H_Q4_3D_ChangeV5 };

static int **N_H_Q4_3D_Change[2] = { N_H_Q4_3D_ChangeU, N_H_Q4_3D_ChangeV };

TBaseFunct3D *BF_N_H_Q4_3D_Obj = 
new TBaseFunct3D(70, BF_N_H_Q4_3D, BFUnitHexahedron, 
                 N_H_Q4_3D_Funct, N_H_Q4_3D_DeriveXi,
                 N_H_Q4_3D_DeriveEta, N_H_Q4_3D_DeriveZeta,
                 N_H_Q4_3D_DeriveXiXi, N_H_Q4_3D_DeriveXiEta,
                 N_H_Q4_3D_DeriveXiZeta, N_H_Q4_3D_DeriveEtaEta,
                 N_H_Q4_3D_DeriveEtaZeta, N_H_Q4_3D_DeriveZetaZeta,
                 5, 4,
                 4, N_H_Q4_3D_Change);
