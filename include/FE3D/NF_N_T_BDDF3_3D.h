/** ==========================================================================
#    This file is part of the finite element software ParMooN.
# 
#    ParMooN (cmg.cds.iisc.ac.in/parmoon) is a free finite element software  
#    developed by the research groups of Prof. Sashikumaar Ganesan (IISc, Bangalore),
#    Prof. Volker John (WIAS Berlin) and Prof. Gunar Matthies (TU-Dresden):
#
#    ParMooN is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    ParMooN is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with ParMooN.  If not, see <http://www.gnu.org/licenses/>.
#
#    If your company is selling a software using ParMooN, please consider 
#    the option to obtain a commercial license for a fee. Please send 
#    corresponding requests to sashi@iisc.ac.in

# =========================================================================*/ 
   
// ***********************************************************************
// Brezzi-Douglas-Duran-Fortin element of third order on tetrahedra, 3D
// ***********************************************************************

static double BDDF3T_tp = 0.16666666666666666667;

/* for all functionals */
static double NF_N_T_BDDF3_3D_Xi[]  = {
    BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,
    BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp,
    BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,
    0,0,0,0,0,0,0,0,0,0,
    //inner dof
    0.25,
    0.206829931610673204083980900024961,
    0.206829931610673204083980900024961,
    0.379510205167980387748057299925117,
    0.206829931610673204083980900024961,
    0.821035883105467230906058078714215e-1,
    0.821035883105467230906058078714215e-1,
    0.753689235068359830728182576385735,
    0.821035883105467230906058078714215e-1,
    0.578195050519799725317663886414270e-2,
    0.578195050519799725317663886414270e-2,
    0.982654148484406008240470083407572,
    0.578195050519799725317663886414270e-2,
    0.50532740018894224425624528557907e-1,
    0.449467259981105775574375471442092,
    0.50532740018894224425624528557907e-1,
    0.449467259981105775574375471442092,
    0.50532740018894224425624528557907e-1,
    0.449467259981105775574375471442092,
    0.229066536116811139600408854554753,
    0.356395827885340437169173969506114e-1,
    0.229066536116811139600408854554753,
    0.356395827885340437169173969506114e-1,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.356395827885340437169173969506114e-1,
    0.366077495531974236787738546327104e-1,
    0.190486041934633455699433285315099,
    0.366077495531974236787738546327104e-1,
    0.366077495531974236787738546327104e-1,
    0.366077495531974236787738546327104e-1,
    0.190486041934633455699433285315099,
    0.736298458958971696943019005419480,
    0.736298458958971696943019005419480,
    0.736298458958971696943019005419480,
    0.366077495531974236787738546327104e-1,
    0.366077495531974236787738546327104e-1,
    0.190486041934633455699433285315099
};
static double NF_N_T_BDDF3_3D_Eta[] = {
    BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp,
    0,0,0,0,0,0,0,0,0,0,
    4*BDDF3T_tp,0.5,2*BDDF3T_tp,BDDF3T_tp,0.5,2*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,
    BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,
    //inner dof
    0.25,
    0.206829931610673204083980900024961,
    0.379510205167980387748057299925117,
    0.206829931610673204083980900024961,
    0.206829931610673204083980900024961,
    0.821035883105467230906058078714215e-1,
    0.753689235068359830728182576385735,
    0.821035883105467230906058078714215e-1,
    0.821035883105467230906058078714215e-1,
    0.578195050519799725317663886414270e-2,
    0.982654148484406008240470083407572,
    0.578195050519799725317663886414270e-2,
    0.578195050519799725317663886414270e-2,
    0.449467259981105775574375471442092,
    0.50532740018894224425624528557907e-1,
    0.50532740018894224425624528557907e-1,
    0.449467259981105775574375471442092,
    0.449467259981105775574375471442092,
    0.50532740018894224425624528557907e-1,
    0.356395827885340437169173969506114e-1,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.229066536116811139600408854554753,
    0.356395827885340437169173969506114e-1,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.356395827885340437169173969506114e-1,
    0.229066536116811139600408854554753,
    0.190486041934633455699433285315099,
    0.366077495531974236787738546327104e-1,
    0.366077495531974236787738546327104e-1,
    0.736298458958971696943019005419480,
    0.736298458958971696943019005419480,
    0.736298458958971696943019005419480,
    0.366077495531974236787738546327104e-1,
    0.190486041934633455699433285315099,
    0.366077495531974236787738546327104e-1,
    0.190486041934633455699433285315099,
    0.366077495531974236787738546327104e-1,
    0.366077495531974236787738546327104e-1
};
static double NF_N_T_BDDF3_3D_Zeta[]= {
    0,0,0,0,0,0,0,0,0,0,
    BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,
    BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp,
    BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp,
    //inner dof
    0.25,
    0.379510205167980387748057299925117,
    0.206829931610673204083980900024961,
    0.206829931610673204083980900024961,
    0.206829931610673204083980900024961,
    0.753689235068359830728182576385737,
    0.82103588310546723090605807871423e-1,
    0.821035883105467230906058078714225e-1,
    0.821035883105467230906058078714225e-1,
    0.982654148484406008240470083407571,
    0.5781950505197997253176638864142e-2,
    0.578195050519799725317663886414230e-2,
    0.578195050519799725317663886414260e-2,
    0.449467259981105775574375471442094,
    0.449467259981105775574375471442094,
    0.449467259981105775574375471442094,
    0.50532740018894224425624528557909e-1,
    0.50532740018894224425624528557909e-1,
    0.50532740018894224425624528557909e-1,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.506227344977843677082264893939883,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.35639582788534043716917396950611e-1,
    0.35639582788534043716917396950611e-1,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.35639582788534043716917396950611e-1,
    0.229066536116811139600408854554753,
    0.229066536116811139600408854554753,
    0.736298458958971696943019005419481,
    0.736298458958971696943019005419481,
    0.736298458958971696943019005419481,
    0.190486041934633455699433285315100,
    0.36607749553197423678773854632711e-1,
    0.36607749553197423678773854632711e-1,
    0.190486041934633455699433285315100,
    0.36607749553197423678773854632711e-1,
    0.366077495531974236787738546327106e-1,
    0.36607749553197423678773854632711e-1,
    0.190486041934633455699433285315100,
    0.366077495531974236787738546327106e-1
};

//-1/7*x.*(7*x.*x+7*x.*(-1+y)+7*y.*y+(16-21*z).*z-2*y.*(1+14*z))
static double NF_N_T_BDDF3_3D_b1x[]= {
    -0.0000000000000000000000000000000000,
    0.0033499633936365843384086460332583,
    0.0040370605157155729780793507188719,
    0.0000000000000000120383133673631111,
    -0.0073870239093521443060619269260769,
    0.0258039475193421602439158846209466,
    -0.0212767892027715121994191349585890,
    -0.0000000000000000358612775222149238,
    -0.0045271583165706437076880597203399,
    0.0039364743402305838598786991155976,
    -0.0039038165730170275476151875437836,
    0.0000000000000000107148373837490740,
    -0.0000326577672135573422555754330432,
    0.0171031472998601045965028077944226,
    -0.0421699339123996139178096598243428,
    -0.0138020094358368271975079366598038,
    -0.0203012943964803599383728283100936,
    -0.0033011378640232713274627052157939,
    0.0624712283088799599783946803199797,
    -0.0317903106162273976775800576888287,
    0.0040888562262051354398439961812528,
    0.0487100738751073333854257896291529,
    0.0000844903513147737529566036474016,
    0.0106924435374782262481163641609783,
    -0.0129374180209807683461509242306420,
    0.0516258537132948877590443714780122,
    -0.0469165580880325366885941207328869,
    -0.0047092956252624343371770976318658,
    0.0210978670787491766336341214582717,
    -0.0357726558541265685087218173521251,
    -0.0041733465775199074174195423836409,
    0.0201668680618395726455993610670703,
    0.0395453496175394714207129709393485,
    0.0034521839514485151874378932035370,
    -0.0032571596534648572345005401729168,
    -0.0108098509521442637942856279664738,
    -0.0551753216372674049061686218919931,
    -0.0900645952579922498548725684486271,
    0.0149370641275787408713826565076488,
    0.0751275311304133996959109254021314,
    -0.0001950242979836509056232318748414,
    -0.0093570171096952984429728772397539,
    0.0156299720197279404243495548598730
};
//1/7*y.*(-2+7*y).*(x-z)
static double NF_N_T_BDDF3_3D_b1y[]= {
    -0.0000000000000000000000000000000000,
    0.0028173901393250553107372446959289,
    0.0000000000000000000000000000000000,
    -0.0028173901393250553107372446959289,
    -0.0000000000000000000000000000000000,
    0.0112270106710509933595210085854887,
    0.0000000000000000000000000000000000,
    -0.0112270106710509933595210085854887,
    -0.0000000000000000000000000000000000,
    0.0015811212895349455002935723513247,
    0.0000000000000000000000000000000000,
    -0.0015811212895349455002935723513247,
    -0.0000000000000000000000000000000000,
    -0.0293622192267358368689134096030102,
    -0.0000000000000000000000000000000000,
    0.0047410846055813285829239056567985,
    0.0293622192267358368689134096030102,
    0.0000000000000000000000000000000000,
    -0.0047410846055813285829239056567985,
    0.0024702118059860343583788999666240,
    0.0061063956393457288415738126730048,
    0.0035964674192817160103263773862636,
    -0.0215922006103704440527213392897465,
    0.0000000000000000000000000000000000,
    0.0215922006103704440527213392897465,
    -0.0061063956393457288415738126730048,
    -0.0024702118059860343583788999666240,
    -0.0035964674192817160103263773862636,
    -0.0025099282200640128312474352867412,
    -0.0000000000000000000000000000000000,
    0.0025099282200640128312474352867412,
    0.0126921454430701970139683254501506,
    0.0049773887973253126693062853291849,
    0.0063806402895257106205884056748801,
    -0.0510513443292795743300160893340944,
    0.0000000000000000000000000000000000,
    0.0510513443292795743300160893340944,
    -0.0049773887973253126693062853291849,
    -0.0126921454430701970139683254501506,
    -0.0063806402895257106205884056748801,
    -0.0000000000000000000000000000000000,
    0.0014032514922003981681225548427960,
    -0.0014032514922003981681225548427960
};
//-1/7*z.*(12*x-21*x.*x-7*y.*y+7*z.*(-1+z)+y.*(2+7*z))
static double NF_N_T_BDDF3_3D_b1z[]= {
    -0.0312500000000000000000000000000000,
    -0.0324698461690660841738598207939503,
    -0.0217328588660773876217735534055464,
    -0.0234851024967794065612114451369052,
    -0.0250828222597139528782239636939266,
    -0.0101612370815898269554855559704265,
    0.0201698687543229726593096984288422,
    0.0380967317798543078644080139838479,
    -0.0056340787650191936561383521109292,
    -0.0000657021266426290842955354465360,
    0.0039034299808015262937821443500752,
    0.0070330147926578609821057774809105,
    -0.0000330443594290583656956569735819,
    0.0180058131289208452063821397359789,
    0.0217526029843291453247378086643948,
    0.0601757470413204834103204632356210,
    -0.0033141836282103774406759821857804,
    0.0010056565964637936751863156459308,
    -0.0066153214922336474670960804189690,
    -0.0062084358701368280372689945068032,
    0.0322666697253416456803165601741057,
    -0.0578342895834317513581446235093608,
    0.0263378793309365158425983111101232,
    -0.0144325667036722810054882870645088,
    -0.0038246135175088367096074559725594,
    -0.0030575364830566771449926743997594,
    0.0138582352136402981584994975605696,
    0.0027780147555013776951293724692960,
    -0.0079134697437139699810471071828033,
    -0.0173523381040427866761621800151261,
    0.0123378874724270840707029961436092,
    -0.0169105314994513894477634607937944,
    -0.0438856890275970620840517710803397,
    0.0731540637585408048959578763970057,
    0.0546647705367168737500271902263194,
    0.0102992998515937274339737683703788,
    0.0044802438619602888078552460626724,
    0.0956790334425852290189951077081787,
    0.0137035633209498467627307505267709,
    0.0142399971586272631324243675976504,
    -0.0017784430738890188126999358786406,
    0.0151194209191774075334846472173922,
    -0.0070610652258450415028057101096692
};
//-0.5*x.*(2+7*x.*x+7*y.*y-2*z-2*y.*(2+7*z)+x.*(-9+7*y+14*z))
static double NF_N_T_BDDF3_3D_b2x[]= {
    0.0546875000000000000000000000000000,
    0.0568222307958655969972738830620074,
    0.0450973589181376602330608704960468,
    0.0568222307958656178139555947836925,
    0.0211067816254954243593289220370934,
    0.0177821648927822366370588014206078,
    -0.0725316514249153970750327857786033,
    0.0177821648927819694896435009923152,
    -0.0373574265638935074096416144584509,
    0.0001149787216245769840830201480308,
    -0.0136626814691824666203601168490422,
    0.0001149787216246264779121941113083,
    -0.0055332479769951824905005466348484,
    0.0523241252436579956652806799866084,
    -0.2146322068628507273579941738717025,
    -0.0125767039013055682145081348721760,
    -0.0670374381694520682373195086256601,
    -0.0241306864253870156922232581564458,
    0.1067848595118045113006033375313564,
    -0.0672973192347825488468515686690807,
    0.0211519285621592882662422852035888,
    0.1017534881970203891610182722615718,
    0.0068409317704413181299161195170200,
    0.0527535166922373580100646961454913,
    -0.0775165191360793343067214777875051,
    0.1094512741152147139445105494814925,
    -0.0712392138813175701539393003258738,
    0.0173960372904998217258309978205943,
    -0.0060424204266464288590188225214206,
    -0.0448231920301326303146538521104958,
    -0.0021005257801115042627648765716231,
    0.0336430243098969974924195014409634,
    -0.0538114376430843671661463645250478,
    -0.0014578123219242244273941011556417,
    -0.0086290759292926271645240987595571,
    -0.0418523941292429021987508974689263,
    -0.1922201613044724755052783393693971,
    -0.2594927910556701911026777906954521,
    0.0557332923473027389005274301325699,
    0.1821332730532555232993985327993869,
    -0.0195612581555055960180755647570550,
    -0.0214387765873765463731093205979050,
    -0.0435290446247822843117702973358973,
};
//0.5*y.*(-2+7*y).*(x-z)
static double NF_N_T_BDDF3_3D_b2y[]= {
    -0.0000000000000000000000000000000000,
    0.0098608654876376940212612254299529,
    0.0000000000000000000000000000000000,
    -0.0098608654876376940212612254299529,
    -0.0000000000000000000000000000000000,
    0.0392945373486784793604087440144212,
    0.0000000000000000000000000000000000,
    -0.0392945373486784793604087440144212,
    -0.0000000000000000000000000000000000,
    0.0055339245133723090341870687325354,
    0.0000000000000000000000000000000000,
    -0.0055339245133723090341870687325354,
    -0.0000000000000000000000000000000000,
    -0.1027677672935754515926021213090280,
    -0.0000000000000000000000000000000000,
    0.0165937961195346504739145387929966,
    0.1027677672935754515926021213090280,
    0.0000000000000000000000000000000000,
    -0.0165937961195346504739145387929966,
    0.0086457413209511217722091913628901,
    0.0213723847377100539812744273149292,
    0.0125876359674860060361423208519227,
    -0.0755727021362965628581420673981484,
    0.0000000000000000000000000000000000,
    0.0755727021362965628581420673981484,
    -0.0213723847377100539812744273149292,
    -0.0086457413209511217722091913628901,
    -0.0125876359674860060361423208519227,
    -0.0087847487702240462104086304861994,
    -0.0000000000000000000000000000000000,
    0.0087847487702240462104086304861994,
    0.0444225090507456912836126150523341,
    0.0174208607906385926078485226753401,
    0.0223322410133399845699742058968695,
    -0.1786797051524785240328441204837873,
    0.0000000000000000000000000000000000,
    0.1786797051524785240328441204837873,
    -0.0174208607906385926078485226753401,
    -0.0444225090507456912836126150523341,
    -0.0223322410133399845699742058968695,
    -0.0000000000000000000000000000000000,
    0.0049113802227013928294874212099330,
    -0.0049113802227013928294874212099330
};
//0.5*z.*(2+21*x.*x-4*y+7*y.*y-2*z+2*x.*(-8+7*z))
static double NF_N_T_BDDF3_3D_b2z[]= {
    -0.1093750000000000000000000000000000,
    -0.1136444615917312356279111895673850,
    -0.0760650060312708375942492011745344,
    -0.0920587242263655597396265761744871,
    -0.0779290124213611046233296519858413,
    -0.0355643297855644802130115067484439,
    0.0705945406401304043075839445009478,
    0.0940440238808116085733601607898891,
    0.0195752616711113019976053806203709,
    -0.0002299574432491455655992035334023,
    0.0136620049328053418113970707281624,
    0.0190816272609301978979701175376249,
    0.0054182692553706047339234785908957,
    0.0630203459512230917960451392900723,
    0.1789018777387274827805896393329022,
    0.1078473473510463409574811066704569,
    -0.0281934388182709799730574218301626,
    0.0201135942071579386369872821660465,
    -0.0231536252228177683032406264374004,
    -0.0217295255454789081051014676404520,
    0.0373606419023991762062841814895364,
    -0.1268473114057144801591903160442598,
    0.1009673264285018551289496713252447,
    -0.0592987322330770089129359234902950,
    -0.0133861473112809326035943513488746,
    -0.0193471190116494967670135451953684,
    0.0359161872802552517569552037457470,
    -0.0116493330934550418792605697149156,
    -0.0190514027820477792329878496957463,
    -0.0481455473966637473304253092010185,
    0.0645549908912048664433314115740359,
    -0.0591868602480799671505806713867059,
    0.0250797935558887165330421709086295,
    0.0773595180024143069807962547201896,
    0.1913266968785090615945421177457320,
    0.0409589297032794466546512524018908,
    0.0107694732941596219011337609572365,
    0.2904541079983026241606580697407480,
    0.0256302306099844869058390628424604,
    0.0324191292645568604480210694873676,
    0.0161076902547284128708326988999033,
    0.0973404822678666237223410462320317,
    -0.0072928674998190556877375456679147
};
//-0.5*x.*(x-2*z).*(-1+x+2*y+z)
static double NF_N_T_BDDF3_3D_b3x[]= {
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0036935119546760699846266184920296,
    0.0000000000000000000000000000000000,
    -0.0036935119546760699846266184920296,
    0.0000000000000000000000000000000000,
    0.0022635791582853222875248988543717,
    0.0000000000000000030828553718001583,
    -0.0022635791582853218538440298601699,
    0.0000000000000000000000000000000000,
    0.0000163288836067786711277877165216,
    -0.0000000000000000057937344346000517,
    -0.0000163288836067786677396559275044,
    0.0085515736499300505635279279204042,
    0.0000000000000000056072040842381744,
    -0.0085515736499300522982514038972113,
    -0.0312356141544399938669851479744466,
    -0.0000000000000000000885943337378526,
    0.0312356141544399834586442921136040,
    -0.0173550410082989464699565473893017,
    0.0000000000000000019325254108623356,
    0.0173550410082989603477443552037585,
    0.0020866732887599541423906401860222,
    0.0123462176979938272752823635869390,
    -0.0050088233103051322051002536284159,
    -0.0000000000000000030556482630422975,
    0.0023546478126311976529494440768531,
    -0.0023546478126311985203111820652566,
    0.0050088233103051304703767776516088,
    -0.0123462176979938220711119356565177,
    -0.0020866732887599524076671642092151,
    0.0040445625681784103805371799467139,
    0.0000000000000000000000000000000000,
    -0.0040445625681784103805371799467139,
    0.0044102916360089436387248440496478,
    0.0003657290678305329871371209815578,
    -0.0078149860098639754163452053603578,
    -0.0000000000000000036307937546224302,
    -0.0375637655652067414813188861444360,
    0.0375637655652067345424249822372076,
    -0.0003657290678305329329270123572826,
    -0.0044102916360089427713631060612443,
    0.0078149860098639736816217293835507
};
//0.5*y.*(-2*x+3*x.*x+2*x.*y-2*z.*(-1+x+y+z))
static double NF_N_T_BDDF3_3D_b3y[]= {
    -0.0078125000000000000000000000000000,
    -0.0044239495875904493241148607296509,
    -0.0081174615422665193087414792216805,
    -0.0087272967304617820455403531809679,
    -0.0044239495875904493241148607296509,
    -0.0002767301121121424744425665309677,
    -0.0025403092703974632440844239056332,
    0.0137115906665137912701091238432127,
    -0.0002767301121121390049956145773535,
    -0.0000000966480538757009361294978670,
    -0.0000164255316606539947504438820003,
    0.0027260433996153317533217563806147,
    -0.0000000966480538752596054941987748,
    -0.0005738703168898654557311678203746,
    -0.0051043327320176223524383907204083,
    0.0079777033330401831562328496261216,
    0.0261312814224223567693972114511780,
    -0.0005738703168898685999174680283375,
    -0.0051043327320176214850766527320047,
    -0.0009350307915485172672101499280473,
    0.0207051563357878859461536080743826,
    -0.0182900717998474814096621088310712,
    0.0186184830470279318037629678883604,
    -0.0132812484895423448677531652606376,
    -0.0132812484895423413983062133070234,
    0.0005258044596583726125807456419636,
    -0.0018288433529728372918532475210895,
    0.0005258044596583702273359661738539,
    -0.0182900717998474744707682049238429,
    -0.0009350307915485167251090636852950,
    0.0207051563357878894156005600279968,
    -0.0001276377751376455013058303089579,
    -0.0037387915160545549808635001909352,
    0.0039169247930407732546931320882777,
    -0.0004933668429681753713617053946905,
    -0.0004933668429681696250901912215170,
    0.0040761944938094299764608230418617,
    0.0040573162096884081775916008894001,
    0.0416210817748951314443139892773615,
    0.0040573162096884081775916008894001,
    -0.0001276377751376356079610063787300,
    0.0039169247930407749894166080650848,
    -0.0037387915160545532461400242141281
};
//-1/7*x.*(7*x.*x+7*x.*(-1+y)-14*y.*y+y.*(10-28*z)+4*z)
static double NF_N_T_BDDF3_3D_b4x[]= {
    -0.0000000000000000000000000000000000,
    0.0017522436307020334677470030371182,
    0.0056347802786501106214744893918578,
    0.0000000000000000180574700510446659,
    -0.0073870239093521408366149749724627,
    -0.0179268630255313490828861233694624,
    0.0224540213421019936579359210782059,
    -0.0000000000000000298843979351791073,
    -0.0045271583165706437076880597203399,
    -0.0031295848118563333872810261482300,
    0.0031622425790698901332254067142458,
    0.0000000000000000126629896353398142,
    -0.0000326577672135573354793118550088,
    0.0171031472998600976576089038871942,
    -0.0037467898554082879752913370907663,
    -0.0094821692111626571658478113135970,
    -0.0587244384534716667989329152987921,
    -0.0076209780886974413591228305620007,
    0.0624712283088799599783946803199797,
    -0.0222304378993017186239011806492272,
    -0.0007670770344521617330191265438089,
    0.0174995005574242190604650204477366,
    0.0049404236119720713188430138984586,
    0.0419030168551613388383536573655874,
    -0.0224972907379064369914889454094009,
    -0.0384751055954785162183107161126827,
    0.0431844012207408672887609668578079,
    -0.0047092956252624187246658138406019,
    -0.0196725789558596202144524767163603,
    0.0049977901804822326761734707645246,
    -0.0041733465775199056826960664068338,
    -0.0011341943226327406632480965242848,
    -0.0410142629058683483300740135746310,
    -0.0120298224433903529900780071670852,
    0.0180439027310074426302399785981834,
    0.0046721554426946013474641894447359,
    0.0253842908861403974973836028539154,
    0.0269751575281456067167962231678757,
    -0.1021026886585591347822443708537321,
    0.0751275311304134135736987332165882,
    -0.0060140802876170887728002334426947,
    -0.0035379611200618619852586999030564,
    0.0156299720197279438937965068134872
};
//1/7*y.*(28*x.*x-7*y.*y+x.*(-18+7*y)+y.*(7-14*z)+4*z)
static double NF_N_T_BDDF3_3D_b4y[]= {
    -0.0312500000000000000000000000000000,
    -0.0194480419810638231747912385571908,
    -0.0324698461690660911127537247011787,
    -0.0257699193817929328442772884955048,
    -0.0250828222597139320615422519722415,
    0.0168199425770827956649888790252589,
    -0.0101612370815898096082507962023556,
    0.0414466579570945056754105451091164,
    -0.0056340787650191936561383521109292,
    0.0031291982196408321334479829545216,
    -0.0000657021266424751817971511291816,
    0.0078072465538185521066738559170517,
    -0.0000330443594290583656956569735819,
    0.0014513085878488157440258099484254,
    -0.0033141836282103826448464101162017,
    0.0071866879436031797304118562408348,
    0.0383071075254012502475653434430569,
    0.0601757470413204972881082710500777,
    -0.0127963528393730402443750904240005,
    -0.0029730461317419029990127832263624,
    0.0356308992092574661203485675287084,
    -0.0212396237236183033081360349569877,
    0.0407081222178956592117060608870815,
    -0.0578342895834317721748263352310460,
    -0.0146498883626909118249592722804664,
    0.0045652153353193591564518349912305,
    -0.0039091038688236091208638711691492,
    0.0095850717754473908904788714835377,
    -0.0334524150023097557871132323725760,
    -0.0079134697437139699810471071828033,
    0.0284379643706940340996958127561811,
    0.0405037118053178032961447740945005,
    0.0023572785311281652977088985068121,
    0.0115192713428398148950426715941830,
    -0.0289486249000183888668846776681676,
    0.0731540637585407493848066451391787,
    -0.0318475956270301008288470256957226,
    0.0158265286517819646350258011580081,
    0.1098400921739842855950897160255408,
    0.0130200256673811687324615604666178,
    0.0151194209191774144723785511246206,
    0.0015644937481891912911535769126203,
    -0.0104040020479232546424253058603426
};
//1/7*z.*(4*x-7*x.*x+y.*(-4+7*y))
static double NF_N_T_BDDF3_3D_b4z[]= {
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0005325732543115158004048970141753,
    -0.0005325732543115125477983795576620,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0145769368482911703538418279890720,
    -0.0145769368482911703538418279890720,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0023553530506956392269468647526764,
    -0.0023553530506956392269468647526764,
    0.0000000000000000000000000000000000,
    -0.0128077146856637857225136301053681,
    0.0128077146856637839877901541285610,
    0.0000000000000000017821746458793026,
    -0.0000000000000000004007329390455245,
    -0.0014399467415580579059825039323073,
    0.0014399467415580576891420694352064,
    0.0300336531029244679924516958635650,
    -0.0300336531029244645230047439099508,
    0.0000000000000000000000000000000000,
    -0.0031866242389752253393042646933964,
    0.0104035244392277088226750336730220,
    0.0016186444202190993467416202378217,
    -0.0016186444202190993467416202378217,
    0.0031866242389752262066660026817999,
    -0.0104035244392277088226750336730220,
    0.0000000000000000000000000000000000,
    0.0135901486782029345956601673606201,
    -0.0135901486782029328609366913838130,
    -0.0390132509287126200137052478567057,
    0.0390132509287126269525991517639341,
    -0.0000000000000000029194839361866831,
    0.0268532041744692709372976935355837,
    0.0051606687982796222921577644626723,
    0.0071003541281574348784100259024399,
    -0.0268532041744692709372976935355837,
    -0.0071003541281574340110482879140363,
    -0.0051606687982796222921577644626723,
    -0.0019396853298778128030926959368685,
    -0.0000000000000000007552928200912255,
    0.0019396853298778130199331304339694
};
//-0.5*x.*(7*x.*x+7*y.*y+3*x.*(-3+7*y)+2*(1+z)-2*y.*(4+7*z))
static double NF_N_T_BDDF3_3D_b5x[]= {
    0.0546875000000000000000000000000000,
    0.0371004998205902783436904712743853,
    0.0648190898934130066422198979125824,
    0.0568222307958656594473190182270628,
    0.0211067816254954590537984415732353,
    -0.0608069098045747741254629659124475,
    0.0060574232724415833298281519603279,
    0.0177821648927818445895532306622044,
    -0.0373574265638935351652172300873644,
    -0.0109528703051200403117970694211181,
    -0.0025948324424378450825390274303572,
    0.0001149787216244014653038219009318,
    -0.0055332479769951816231388086464449,
    0.0523241252436579679097050643576949,
    -0.0090966722757000323396070484704978,
    -0.0457642961403748674276137364813621,
    -0.2725729727566029714225237512437161,
    0.0090569058136822887250527713831616,
    0.1067848595118044696672399140879861,
    -0.1100420887102026151760369998555689,
    0.0038604459202570455891856404662121,
    0.0765782162620484430082257176763960,
    0.0241324144123435772868457860340641,
    0.0779287886272095192685682718547469,
    -0.0347717496606592124663848153431900,
    -0.0416941301573783631995162579642056,
    0.0799061903912756527068594891716202,
    0.0173960372904998217258309978205943,
    0.0115270771138016835111184121842598,
    -0.0623926895705807296743650169901230,
    -0.0021005257801115112016587804788514,
    -0.0011986972713801966137353582908531,
    -0.1426564557445757774889472102586296,
    -0.0461222943486041953020659889261879,
    0.0262126456519845701942372784287727,
    0.0028120878974370916610070469943139,
    -0.1033751432029811206936287248936424,
    0.0978666192492871345187666065612575,
    -0.3016261179576543161040547147422330,
    0.1821332730532558563663059203463490,
    -0.0097384977101027982160363904995393,
    -0.0312615370327793268279137350873498,
    -0.0435290446247822218617251621708419
};
//0.5*y.*(2+28*x.*x-2*y+x.*(-22+21*y)+2*z-7*y.*z)
static double NF_N_T_BDDF3_3D_b5y[]= {
    -0.1093750000000000000000000000000000,
    -0.0680681469337234279493031863239594,
    -0.1136444615917312495056989973818418,
    -0.1000555833239129971401482066539756,
    -0.0779290124213611323789052676147548,
    0.0588697990197897952358019324492489,
    -0.0355643297855644177629663715833885,
    0.1057687655011522592785055962849583,
    0.0195752616711113054670523325739850,
    0.0109521937687429137681105473234311,
    -0.0002299574432491915899814255430655,
    0.0217914384249926172676392610583207,
    0.0054182692553706047339234785908957,
    0.0050795800574708060981521384746884,
    -0.0281934388182709695647165659693201,
    0.0417472039221457799640369046301203,
    0.2368426436324797546006948323338293,
    0.1078473473510462438129664519692597,
    -0.0447872349378056269775250086695451,
    -0.0104056614610966696038429901705058,
    0.1334928960026252053872042324655922,
    -0.0831234318028880869722030411139713,
    0.0669057256263382305050413378921803,
    -0.1268473114057147022037952410755679,
    -0.0512746092694181324067592697701912,
    0.0033906177061317479756730186579716,
    -0.0223276048618337406848066706288591,
    0.0121753664763557950534433871325746,
    -0.1044958165405981270756896606144437,
    -0.0190514027820477931107756575102030,
    0.1209052600351391421051872043790354,
    0.1417629913186123080670597573771374,
    0.0033390946362471950366324069392476,
    0.0452288299226407397579663438591524,
    -0.1013201871500642448076234813925112,
    0.0773595180024142931030084469057329,
    0.0672131204578731850096673383632151,
    0.0330606092678968760401048143648950,
    0.3400178135581993221769891988515155,
    0.0281492290451954840779791311433655,
    0.0973404822678666098445532384175749,
    0.0278079691320021540890117250910407,
    -0.0189931463770927899670226679518237
};
//0.5*z.*(4*x-7*x.*x+y.*(-4+7*y))
static double NF_N_T_BDDF3_3D_b5z[]= {
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0018640063900903054098373567981639,
    -0.0018640063900902939172943284518169,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0510192789690191023099785638805770,
    -0.0510192789690191023099785638805770,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0082437356774347370774735921372667,
    -0.0082437356774347370774735921372667,
    0.0000000000000000000000000000000000,
    -0.0448270013998232561003298712876131,
    0.0448270013998232491614359673803847,
    0.0000000000000000062376112605775602,
    -0.0000000000000000014025652866593359,
    -0.0050398135954532029961994155087268,
    0.0050398135954532021288376775203233,
    0.1051177858602356379735809355224774,
    -0.1051177858602356240957931277080206,
    0.0000000000000000000000000000000000,
    -0.0111531848364132893380862299181899,
    0.0364123355372969817467243558439804,
    0.0056652554707668483641169743236787,
    -0.0056652554707668483641169743236787,
    0.0111531848364132928075331818718041,
    -0.0364123355372969817467243558439804,
    0.0000000000000000000000000000000000,
    0.0475655203737102780237044896693988,
    -0.0475655203737102710848105857621704,
    -0.1365463782504941769868622714056983,
    0.1365463782504942047424378870346118,
    -0.0000000000000000102181937766533910,
    0.0939862146106424517499888793281571,
    0.0180623407939786775888713066251512,
    0.0248512394485510233754776976411449,
    -0.0939862146106424517499888793281571,
    -0.0248512394485510199060307456875307,
    -0.0180623407939786775888713066251512,
    -0.0067888986545723449192446530275902,
    -0.0000000000000000026435248703192894,
    0.0067888986545723457866063910159937
};
//1/14*x.*(-7*y.*y-2*z+2*y.*(1+7*z))
static double NF_N_T_BDDF3_3D_b6x[]= {
    0.0078125000000000000000000000000000,
    0.0067087664726039946891389398331285,
    0.0064424798454482384152397500542975,
    0.0081174615422665227781884311752947,
    0.0044239495875904519262000746948615,
    -0.0030731960651280386398465083175324,
    -0.0103616644892736194799587323700507,
    0.0025403092703974597746374719520190,
    0.0002767301121121374329024644733721,
    -0.0007741351131068188468759005971265,
    -0.0019518116384546384603493329734647,
    0.0000164255316606538592251723213122,
    0.0000000966480538752545894709642532,
    0.0051043327320176197503531767551976,
    -0.0159806342241821906779986051105880,
    -0.0017966719859007949326029640602087,
    -0.0095767768813503004188270040231146,
    -0.0010766986151217663048723638397064,
    0.0005738703168898694672792060167410,
    -0.0114121364574669339336798756789904,
    0.0017865981773154530377889503967026,
    0.0114830147799014885973134525443129,
    0.0009772759672059022802159677922873,
    0.0062812525602876263797202938121700,
    -0.0098188243379793219145490468235948,
    0.0048397959969883165912141187448015,
    -0.0101770305544739165376499911985775,
    0.0132812484895423448677531652606376,
    0.0021899949015805222733710433402621,
    -0.0046050794375209445907781713458462,
    0.0009350307915485163998484119396437,
    0.0016158261852224299528341111553686,
    -0.0140334209562614393995705341922076,
    -0.0026969533017946879620285738354823,
    -0.0019343508788562870526900328016495,
    -0.0052772877009344982407457180784149,
    -0.0274600230434960713987724290063852,
    -0.0115447265575987813301939155508080,
    0.0079618989067575286766587083775448,
    0.0004933668429681668061645427592055,
    0.0003958546939763419496641216888122,
    -0.0005739879709625643434620090310716,
    0.0001276377751376343611285080203999
};
//1/14*y.*(-2+7*y).*(x-z)
static double NF_N_T_BDDF3_3D_b6y[]= {
    -0.0000000000000000000000000000000000,
    0.0014086950696625276553686223479644,
    0.0000000000000000000000000000000000,
    -0.0014086950696625276553686223479644,
    -0.0000000000000000000000000000000000,
    0.0056135053355254966797605042927444,
    0.0000000000000000000000000000000000,
    -0.0056135053355254966797605042927444,
    -0.0000000000000000000000000000000000,
    0.0007905606447674727501467861756623,
    0.0000000000000000000000000000000000,
    -0.0007905606447674727501467861756623,
    -0.0000000000000000000000000000000000,
    -0.0146811096133679184344567048015051,
    -0.0000000000000000000000000000000000,
    0.0023705423027906642914619528283993,
    0.0146811096133679184344567048015051,
    0.0000000000000000000000000000000000,
    -0.0023705423027906642914619528283993,
    0.0012351059029930171791894499833120,
    0.0030531978196728644207869063365024,
    0.0017982337096408580051631886931318,
    -0.0107961003051852220263606696448733,
    0.0000000000000000000000000000000000,
    0.0107961003051852220263606696448733,
    -0.0030531978196728644207869063365024,
    -0.0012351059029930171791894499833120,
    -0.0017982337096408580051631886931318,
    -0.0012549641100320064156237176433706,
    -0.0000000000000000000000000000000000,
    0.0012549641100320064156237176433706,
    0.0063460727215350985069841627250753,
    0.0024886943986626563346531426645925,
    0.0031903201447628553102942028374400,
    -0.0255256721646397871650080446670472,
    0.0000000000000000000000000000000000,
    0.0255256721646397871650080446670472,
    -0.0024886943986626563346531426645925,
    -0.0063460727215350985069841627250753,
    -0.0031903201447628553102942028374400,
    -0.0000000000000000000000000000000000,
    0.0007016257461001990840612774213980,
    -0.0007016257461001990840612774213980
};
//1/14*z.*(x.*(2-14*y)+y.*(-2+7*y))
static double NF_N_T_BDDF3_3D_b6z[]= {
    -0.0078125000000000000000000000000000,
    -0.0081174615422665227781884311752947,
    -0.0064424798454482366805162740774904,
    -0.0067087664726039946891389398331285,
    -0.0044239495875904519262000746948615,
    -0.0025403092703974580399139959752119,
    0.0103616644892736212146822083468578,
    0.0030731960651280386398465083175324,
    -0.0002767301121121372702721386005464,
    -0.0000164255316606539811979167259315,
    0.0019518116384546384603493329734647,
    0.0007741351131068187384556833485760,
    -0.0000000966480538752553041550134990,
    0.0095767768813503004188270040231146,
    0.0159806342241821941474455570642021,
    -0.0005738703168898690335983370225392,
    -0.0051043327320176197503531767551976,
    0.0010766986151217663048723638397064,
    0.0017966719859007953662838330544105,
    0.0101770305544739165376499911985775,
    -0.0048397959969883165912141187448015,
    -0.0132812484895423396635827373302163,
    0.0098188243379793201798255708467877,
    -0.0062812525602876307165289837541877,
    -0.0009772759672059027138968367864891,
    -0.0017865981773154519535867779111982,
    0.0114121364574669339336798756789904,
    -0.0114830147799014816584195486370845,
    -0.0009350307915485161830079774425428,
    0.0046050794375209445907781713458462,
    -0.0021899949015805222733710433402621,
    -0.0079618989067575286766587083775448,
    0.0115447265575987813301939155508080,
    -0.0004933668429681675651060634990586,
    0.0274600230434960783376663329136136,
    0.0052772877009344991081074560668185,
    0.0019343508788562883537326397842548,
    0.0140334209562614393995705341922076,
    -0.0016158261852224297359936766582678,
    0.0026969533017946879620285738354823,
    -0.0003958546939763419496641216888122,
    -0.0001276377751376345508638882053631,
    0.0005739879709625643434620090310716
};
//1/14*x.*(-7*y.*y+z.*(-4+7*x)+y.*(4-7*x+14*z))
static double NF_N_T_BDDF3_3D_b7x[]= {
    0.0078125000000000000000000000000000,
    0.0053000714029414683348129244677693,
    0.0078511749151107639022040274312531,
    0.0081174615422665227781884311752947,
    0.0044239495875904484567531227412474,
    -0.0086867014006535327175217986450662,
    -0.0047481591537481236675599660657099,
    0.0025403092703974593409566029578173,
    0.0002767301121121374329024644733721,
    -0.0015646957578742913801822522756879,
    -0.0011612509936871652765216778036006,
    0.0000164255316606541031706611305507,
    0.0000000966480538752560188390627448,
    0.0051043327320176197503531767551976,
    -0.0012995246108142741951058107829908,
    -0.0041672142886914594409053513857089,
    -0.0242578864947182205880071848014268,
    0.0012938436876688982034300234857938,
    0.0005738703168898690335983370225392,
    -0.0144653342771398005228711269865016,
    0.0005514922743224349912377624249871,
    0.0096847810702606167143624560367243,
    0.0022123818701989201099267212669020,
    0.0080794862699284913237773864125302,
    -0.0067656265183064544579960575276800,
    -0.0059563043081969054351465509000718,
    0.0006190697507113062476521991861489,
    0.0132812484895423396635827373302163,
    0.0034449590116125286889947609836327,
    -0.0058600435475529497053592820066115,
    0.0009350307915485163998484119396437,
    -0.0008728682134402254060370762722698,
    -0.0203794936777965361718312209404758,
    -0.0058872734465575437060036456671241,
    0.0005543435198063681977609373774385,
    -0.0020869675561716433641323842351767,
    -0.0211139503219609746265117422581170,
    0.0139809456070410023653671771626250,
    -0.0175637732578822550189023843358882,
    0.0004933668429681675651060634990586,
    0.0010974804400765412505658336073111,
    -0.0012756137170627636443637209495705,
    0.0001276377751376343611285080203999
};
//1/14*y.*(7*x.*x+x.*(-4+7*y-14*z)+z.*(4-7*y))
static double NF_N_T_BDDF3_3D_b7y[]= {
    -0.0078125000000000000000000000000000,
    -0.0053000714029414666000894484909622,
    -0.0081174615422665227781884311752947,
    -0.0078511749151107639022040274312531,
    -0.0044239495875904484567531227412474,
    0.0086867014006535344522452746218732,
    -0.0025403092703974593409566029578173,
    0.0047481591537481236675599660657099,
    -0.0002767301121121374329024644733721,
    0.0015646957578742913801822522756879,
    -0.0000164255316606541031706611305507,
    0.0011612509936871654933621123007015,
    -0.0000000966480538752560188390627448,
    0.0012995246108142741951058107829908,
    -0.0051043327320176188829914387667941,
    0.0041672142886914594409053513857089,
    0.0242578864947182205880071848014268,
    -0.0005738703168898690335983370225392,
    -0.0012938436876688982034300234857938,
    -0.0005514922743224349912377624249871,
    0.0144653342771398005228711269865016,
    -0.0096847810702606167143624560367243,
    -0.0006190697507113062476521991861489,
    -0.0132812484895423396635827373302163,
    0.0059563043081969063025082888884754,
    0.0067656265183064535906343195392765,
    -0.0022123818701989201099267212669020,
    -0.0080794862699284913237773864125302,
    -0.0034449590116125286889947609836327,
    -0.0009350307915485161830079774425428,
    0.0058600435475529505727210199950150,
    0.0203794936777965327023842689868616,
    0.0008728682134402254060370762722698,
    0.0058872734465575419712801696903171,
    -0.0139809456070410041000906531394321,
    -0.0004933668429681675651060634990586,
    0.0175637732578822550189023843358882,
    -0.0005543435198063693903833271114934,
    0.0211139503219609746265117422581170,
    0.0020869675561716433641323842351767,
    -0.0001276377751376343611285080203999,
    0.0012756137170627636443637209495705,
    -0.0010974804400765412505658336073111
};
//1/14*z.*(4*x-7*x.*x+y.*(-4+7*y))
static double NF_N_T_BDDF3_3D_b7z[]= {
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0002662866271557579002024485070876,
    -0.0002662866271557562738991897788310,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0072884684241455851769209139945360,
    -0.0072884684241455851769209139945360,
    0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0011776765253478196134734323763382,
    -0.0011776765253478196134734323763382,
    0.0000000000000000000000000000000000,
    -0.0064038573428318928612568150526840,
    0.0064038573428318919938950770642805,
    0.0000000000000000008910873229396513,
    -0.0000000000000000002003664695227623,
    -0.0007199733707790289529912519661536,
    0.0007199733707790288445710347176032,
    0.0150168265514622339962258479317825,
    -0.0150168265514622322615023719549754,
    0.0000000000000000000000000000000000,
    -0.0015933121194876126696521323466982,
    0.0052017622196138544113375168365110,
    0.0008093222101095496733708101189109,
    -0.0008093222101095496733708101189109,
    0.0015933121194876131033330013409000,
    -0.0052017622196138544113375168365110,
    0.0000000000000000000000000000000000,
    0.0067950743391014672978300836803101,
    -0.0067950743391014664304683456919065,
    -0.0195066254643563100068526239283528,
    0.0195066254643563134762995758819670,
    -0.0000000000000000014597419680933416,
    0.0134266020872346354686488467677918,
    0.0025803343991398111460788822313361,
    0.0035501770640787174392050129512199,
    -0.0134266020872346354686488467677918,
    -0.0035501770640787170055241439570182,
    -0.0025803343991398111460788822313361,
    -0.0009698426649389064015463479684342,
    -0.0000000000000000003776464100456128,
    0.0009698426649389065099665652169847
};
//1/7*x.*(y-z).*(-6+7*x+7*y+7*z)
static double NF_N_T_BDDF3_3D_b8x[]= {
    -0.0000000000000000000000000000000000,
    0.0022848168850135392934919131846527,
    -0.0022848168850135401608536511730563,
    -0.0000000000000000000000000000000000,
    -0.0000000000000000000000000000000000,
    -0.0033499261772401748259164744325744,
    0.0033499261772401739585547364441709,
    0.0000000000000000000000000000000000,
    -0.0000000000000000000000000000000000,
    -0.0007742317611606944855948131412049,
    0.0007742317611606941603341613955536,
    0.0000000000000000000000000000000000,
    -0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    -0.0165545045410720563505702074280634,
    0.0061810313471393849710233681093996,
    0.0165545045410720528811232554744493,
    -0.0061810313471393849710233681093996,
    -0.0000000000000000000000000000000000,
    0.0092930198783209520124737323953923,
    0.0008515673857669363126798867114076,
    -0.0068070570199459945470721322635654,
    -0.0008515673857669357705788004686553,
    0.0068070570199459945470721322635654,
    -0.0092930198783209485430267804417781,
    -0.0084414524925540204702834046202042,
    0.0084414524925540170008364526665900,
    0.0000000000000000000000000000000000,
    -0.0161000768982669448248223886821506,
    0.0161000768982669448248223886821506,
    -0.0000000000000000000000000000000000,
    -0.0021229653308321243775080855442638,
    -0.0141610587313990825969467479694686,
    0.0012199714912460852926645582527954,
    0.0021229653308321239438272165500621,
    -0.0012199714912460863768667307382998,
    0.0141610587313990773927763200390473,
    -0.0120380934005669491121404135469675,
    0.0120380934005669491121404135469675,
    -0.0000000000000000000000000000000000,
    -0.0033429368220782096701726437970592,
    0.0033429368220782096701726437970592,
    -0.0000000000000000000000000000000000
};
//-1/7*y.*(x-z).*(-6+7*x+7*y+7*z)
static double NF_N_T_BDDF3_3D_b8y[]= {
    0.0000000000000000000000000000000000,
    -0.0022848168850135392934919131846527,
    0.0000000000000000000000000000000000,
    0.0022848168850135414618962581556616,
    0.0000000000000000000000000000000000,
    0.0033499261772401748259164744325744,
    -0.0000000000000000000000000000000000,
    -0.0033499261772401730911929984557673,
    0.0000000000000000000000000000000000,
    0.0007742317611606944855948131412049,
    -0.0000000000000000000000000000000000,
    -0.0007742317611606939434937268984527,
    0.0000000000000000000000000000000000,
    0.0165545045410720563505702074280634,
    -0.0000000000000000000000000000000000,
    -0.0061810313471393849710233681093996,
    -0.0165545045410720528811232554744493,
    0.0000000000000000000000000000000000,
    0.0061810313471393849710233681093996,
    -0.0008515673857669351200574969773527,
    -0.0092930198783209641555380642330420,
    0.0068070570199459945470721322635654,
    -0.0084414524925540239397303565738184,
    -0.0000000000000000000000000000000000,
    0.0084414524925540152661129766897830,
    0.0092930198783209554819206843490065,
    0.0008515673857669351200574969773527,
    -0.0068070570199459902102634423215477,
    0.0161000768982669448248223886821506,
    0.0000000000000000000000000000000000,
    -0.0161000768982669517637162925893790,
    0.0141610587313990825969467479694686,
    0.0021229653308321243775080855442638,
    -0.0012199714912460852926645582527954,
    0.0120380934005669543163108414773887,
    0.0000000000000000000000000000000000,
    -0.0120380934005669525815873655005817,
    -0.0021229653308321226427846095674568,
    -0.0141610587313990721886058921086260,
    0.0012199714912460876779093377209051,
    0.0000000000000000000000000000000000,
    -0.0033429368220782096701726437970592,
    0.0033429368220782096701726437970592
};
//1/7*z.*(x-y).*(-6+7*x+7*y+7*z)
static double NF_N_T_BDDF3_3D_b8z[]= {
    -0.0000000000000000000000000000000000,
    -0.0000000000000000000000000000000000,
    0.0022848168850135401608536511730563,
    -0.0022848168850135414618962581556616,
    -0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    -0.0033499261772401739585547364441709,
    0.0033499261772401730911929984557673,
    -0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    -0.0007742317611606941603341613955536,
    0.0007742317611606939434937268984527,
    -0.0000000000000000000000000000000000,
    -0.0165545045410720563505702074280634,
    0.0165545045410720563505702074280634,
    -0.0000000000000000000000000000000000,
    0.0000000000000000000000000000000000,
    0.0061810313471393849710233681093996,
    -0.0061810313471393849710233681093996,
    -0.0084414524925540170008364526665900,
    0.0084414524925540308786242604810468,
    0.0000000000000000000000000000000000,
    0.0092930198783209589513676363026207,
    -0.0068070570199459945470721322635654,
    0.0008515673857669347947968452317014,
    -0.0008515673857669354453181487230040,
    -0.0092930198783209520124737323953923,
    0.0068070570199459902102634423215477,
    -0.0000000000000000000000000000000000,
    -0.0161000768982669448248223886821506,
    0.0161000768982669517637162925893790,
    -0.0120380934005669577857577934310029,
    0.0120380934005669577857577934310029,
    -0.0000000000000000000000000000000000,
    -0.0141610587313990791274997960158544,
    0.0012199714912460863768667307382998,
    -0.0021229653308321235101463475558603,
    0.0141610587313990721886058921086260,
    0.0021229653308321226427846095674568,
    -0.0012199714912460876779093377209051,
    0.0033429368220782096701726437970592,
    -0.0000000000000000000000000000000000,
    -0.0033429368220782096701726437970592
};

static double NF_N_T_BDDF3_3D_Weights[]= {
    -0.205001886586399158405865177642941e-1,
     0.142503058228669012484397415358704e-1,
     0.142503058228669012484397415358704e-1,
     0.142503058228669012484397415358704e-1,
     0.142503058228669012484397415358704e-1,
     0.196703331313390098756280342445466e-2,
     0.196703331313390098756280342445466e-2,
     0.196703331313390098756280342445466e-2,
     0.196703331313390098756280342445466e-2,
     0.169834109092887379837744566704016e-3,
     0.169834109092887379837744566704016e-3,
     0.169834109092887379837744566704016e-3,
     0.169834109092887379837744566704016e-3,
     0.457968382446728180074351446297276e-2,
     0.457968382446728180074351446297276e-2,
     0.457968382446728180074351446297276e-2,
     0.457968382446728180074351446297276e-2,
     0.457968382446728180074351446297276e-2,
     0.457968382446728180074351446297276e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.570448580868191850680255862783040e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2,
     0.214051914116209259648335300092023e-2
};

/* face 0                               0 */
static double NF_N_T_BDDF3_3D_F0_Xi[]   = {BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F0_Eta[]  = {BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F0_Zeta[] = {0,0,0,0,0,0,0,0,0,0};

/* face 1                               1 */
static double NF_N_T_BDDF3_3D_F1_Xi[]   = {BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F1_Eta[]  = {0,0,0,0,0,0,0,0,0,0};
static double NF_N_T_BDDF3_3D_F1_Zeta[] = {BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp};

/* face 2                               2 */
static double NF_N_T_BDDF3_3D_F2_Xi[]   = {BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F2_Eta[]  = {4*BDDF3T_tp,0.5,2*BDDF3T_tp,BDDF3T_tp,0.5,2*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp,BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F2_Zeta[] = {BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp};

/* face 3                               3 */
static double NF_N_T_BDDF3_3D_F3_Xi[]   = {0,0,0,0,0,0,0,0,0,0};
static double NF_N_T_BDDF3_3D_F3_Eta[]  = {BDDF3T_tp,2*BDDF3T_tp,0.5,4*BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,0.5,BDDF3T_tp,2*BDDF3T_tp,BDDF3T_tp};
static double NF_N_T_BDDF3_3D_F3_Zeta[] = {BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,2*BDDF3T_tp,0.5,0.5,4*BDDF3T_tp};

static double *NF_N_T_BDDF3_3D_XiArray[4] = {
                        NF_N_T_BDDF3_3D_F0_Xi,
                        NF_N_T_BDDF3_3D_F1_Xi,
                        NF_N_T_BDDF3_3D_F2_Xi,
                        NF_N_T_BDDF3_3D_F3_Xi };

static double *NF_N_T_BDDF3_3D_EtaArray[4] = {
                        NF_N_T_BDDF3_3D_F0_Eta,
                        NF_N_T_BDDF3_3D_F1_Eta,
                        NF_N_T_BDDF3_3D_F2_Eta,
                        NF_N_T_BDDF3_3D_F3_Eta };

static double *NF_N_T_BDDF3_3D_ZetaArray[4] = {
                        NF_N_T_BDDF3_3D_F0_Zeta,
                        NF_N_T_BDDF3_3D_F1_Zeta,
                        NF_N_T_BDDF3_3D_F2_Zeta,
                        NF_N_T_BDDF3_3D_F3_Zeta };

static double NF_N_T_BDDF3_3D_T[1] = {};// ???
static double NF_N_T_BDDF3_3D_S[1] = {};// ???

void NF_N_T_BDDF3_3D_EvalAll(TCollection *Coll, TBaseCell *Cell,
                          double *PointValues, double *Functionals)
{
  // PointValues[4*i + j] means i-th component (i=0 for x, i=1 for y, i=2 for z)
  // at j-th evaluation point (see NF_N_T_BDDF3_3D_Xi, ...Eta, ...Zeta)
  //face 0
  Functionals[0]  = -PointValues[166];
  Functionals[1]  = -PointValues[167];
  Functionals[2]  = -PointValues[168];
  Functionals[3]  = -PointValues[169];
  Functionals[4]  = -PointValues[170];
  Functionals[5]  = -PointValues[171];
  Functionals[6]  = -PointValues[172];
  Functionals[7]  = -PointValues[173];
  Functionals[8]  = -PointValues[174];
  Functionals[9]  = -PointValues[175];
  //face 1
  Functionals[10] = -PointValues[93];
  Functionals[11] = -PointValues[94];
  Functionals[12] = -PointValues[95];
  Functionals[13] = -PointValues[96];
  Functionals[14] = -PointValues[97];
  Functionals[15] = -PointValues[98];
  Functionals[16] = -PointValues[99];
  Functionals[17] = -PointValues[100];
  Functionals[18] = -PointValues[101];
  Functionals[19] = -PointValues[102];
  //face 2
  Functionals[20] =  PointValues[20]+PointValues[103]+PointValues[186];
  Functionals[21] =  PointValues[21]+PointValues[104]+PointValues[187];
  Functionals[22] =  PointValues[22]+PointValues[105]+PointValues[188];
  Functionals[23] =  PointValues[23]+PointValues[106]+PointValues[189];
  Functionals[24] =  PointValues[24]+PointValues[107]+PointValues[190];
  Functionals[25] =  PointValues[25]+PointValues[108]+PointValues[191];
  Functionals[26] =  PointValues[26]+PointValues[109]+PointValues[192];
  Functionals[27] =  PointValues[27]+PointValues[110]+PointValues[193];
  Functionals[28] =  PointValues[28]+PointValues[111]+PointValues[194];
  Functionals[29] =  PointValues[29]+PointValues[112]+PointValues[195];
  //face 3
  Functionals[30] = -PointValues[30];
  Functionals[31] = -PointValues[31];
  Functionals[32] = -PointValues[32];
  Functionals[33] = -PointValues[33];
  Functionals[34] = -PointValues[34];
  Functionals[35] = -PointValues[35];
  Functionals[36] = -PointValues[36];
  Functionals[37] = -PointValues[37];
  Functionals[38] = -PointValues[38];
  Functionals[39] = -PointValues[39];

  //inner dofs
  int i;
  double s;

  //x-component
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[40] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+40] * NF_N_T_BDDF3_3D_Xi[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[41] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+40] * NF_N_T_BDDF3_3D_Eta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[42] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+40] * NF_N_T_BDDF3_3D_Zeta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[43] = s;

  //y-component
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+123] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[44] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+123] * NF_N_T_BDDF3_3D_Xi[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[45] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+123] * NF_N_T_BDDF3_3D_Eta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[46] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+123] * NF_N_T_BDDF3_3D_Zeta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[47] = s;

  //z-component
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+206] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[48] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+206] * NF_N_T_BDDF3_3D_Xi[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[49] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+206] * NF_N_T_BDDF3_3D_Eta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[50] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += PointValues[i+206] * NF_N_T_BDDF3_3D_Zeta[i+40] * NF_N_T_BDDF3_3D_Weights[i];
  Functionals[51] = s;

  //x+y+z component
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b1x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b1y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b1z[i] )* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[52] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b2x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b2y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b2z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[53] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b3x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b3y[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[54] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b4x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b4y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b4z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[55] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b5x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b5y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b5z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[56] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b6x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b6y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b6z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[57] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b7x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b7y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b7z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[58] = s;
  s = 0;
  for(i=0;i<43;i++)
    s += (PointValues[i+40] * NF_N_T_BDDF3_3D_b8x[i] + PointValues[i+123] * NF_N_T_BDDF3_3D_b8y[i] + PointValues[i+206] * NF_N_T_BDDF3_3D_b8z[i])* NF_N_T_BDDF3_3D_Weights[i];
  Functionals[59] = s;
}

void NF_N_T_BDDF3_3D_EvalFace(TCollection *Coll, TBaseCell *Cell, int face,
                           double *PointValues, double *Functionals)
{
  double s; // size of face
  double x0,x1,x2,y0,y1,y2,z0,z1,z2;
  #ifdef __3D__
  // find vertices of this face, then their coordinates
  const int *faceVertex, *length;
  int MaxLen;
  Cell->GetShapeDesc()->GetFaceVertex(faceVertex, length, MaxLen);
  // now MaxLen == 3, length == {3,3,3,3}
  Cell->GetVertex(faceVertex[3*face    ])->GetCoords(x0,y0,z0);
  Cell->GetVertex(faceVertex[3*face + 1])->GetCoords(x1,y1,z1);
  Cell->GetVertex(faceVertex[3*face + 2])->GetCoords(x2,y2,z2);
  #endif
  // compute measure of this face
  s = sqrt( POW((y1-y0)*(z2-z0) - (z1-z0)*(y2-y0),2)
          + POW((z1-z0)*(x2-x0) - (x1-x0)*(z2-z0),2)
          + POW((x1-x0)*(y2-y0) - (x2-x0)*(y1-y0),2) );
  for(int i=0; i<10; i++)
    Functionals[i] = PointValues[i]*s;
}

static int NF_N_T_BDDF3_3D_N_AllFunctionals = 60;
static int NF_N_T_BDDF3_3D_N_PointsAll = 83;
static int NF_N_T_BDDF3_3D_N_FaceFunctionals[] = {10,10,10,10};
static int NF_N_T_BDDF3_3D_N_PointsFace[] = {10,10,10,10};

TNodalFunctional3D *NF_N_T_BDDF3_3D_Obj = new TNodalFunctional3D
        (NF_N_T_BDDF3_3D, NF_N_T_BDDF3_3D_N_AllFunctionals,
         NF_N_T_BDDF3_3D_N_FaceFunctionals, NF_N_T_BDDF3_3D_N_PointsAll,
         NF_N_T_BDDF3_3D_N_PointsFace,
         NF_N_T_BDDF3_3D_Xi, NF_N_T_BDDF3_3D_Eta, NF_N_T_BDDF3_3D_Zeta,
         NF_N_T_BDDF3_3D_XiArray, NF_N_T_BDDF3_3D_EtaArray,
         NF_N_T_BDDF3_3D_ZetaArray,
         NF_N_T_BDDF3_3D_T, NF_N_T_BDDF3_3D_S,
         NF_N_T_BDDF3_3D_EvalAll, NF_N_T_BDDF3_3D_EvalFace);
